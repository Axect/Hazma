(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    324927,       8937]
NotebookOptionsPosition[    311955,       8722]
NotebookOutlinePosition[    312392,       8739]
CellTagsIndexPosition[    312349,       8736]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData["Quit"], "Input",
 CellChangeTimes->{{3.792441609987021*^9, 3.792441610484632*^9}, {
  3.792714995912264*^9, 3.792714997948762*^9}},
 CellLabel->"In[48]:=",ExpressionUUID->"42e4ba0b-1819-4c9c-83a8-dddd2a2955bf"],

Cell[CellGroupData[{

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{
   SuperscriptBox["\[Chi]e", "-"], "\[Rule]", 
   SuperscriptBox["\[Chi]e", "-"]}], TraditionalForm]],
 FormatType->
  "TraditionalForm",ExpressionUUID->"2d924b3b-3b37-479c-be62-243f089bb85a"]], \
"Title",
 CellChangeTimes->{{3.792843162720735*^9, 
  3.7928431763374577`*^9}},ExpressionUUID->"c92b7a39-599a-4a7c-acdb-\
d8b41fd2c845"],

Cell[CellGroupData[{

Cell["Load Tools", "Section",
 CellChangeTimes->{{3.78968487375793*^9, 3.7896848754570637`*^9}, {
  3.7925272504458027`*^9, 
  3.792527251207727*^9}},ExpressionUUID->"73d91e81-e7e1-4fc6-a8cf-\
b673abb31180"],

Cell[CellGroupData[{

Cell["Load FeynCalc", "Subsection",
 CellChangeTimes->{{3.7925278218127728`*^9, 3.79252782505313*^9}, {
  3.792845650225637*^9, 
  3.7928456518328648`*^9}},ExpressionUUID->"2483c665-b412-4efa-8e46-\
eeaf53b2ba00"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"$LoadAddOns", "=", 
   RowBox[{"{", 
    RowBox[{"\"\<FeynHelpers\>\"", ",", "\"\<FeynArts\>\""}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"<<", "FeynCalc`"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"$FAVerbose", "=", "False"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"FAPatch", "[", 
  RowBox[{"PatchModelsOnly", "\[Rule]", "True"}], "]"}]}], "Input",
 CellChangeTimes->{{3.7925275837736073`*^9, 3.79252765200809*^9}, 
   3.7928456659446163`*^9},
 CellLabel->"In[1]:=",ExpressionUUID->"86657822-18c8-44a0-97a9-e0b6947a2385"],

Cell[CellGroupData[{

Cell[BoxData[
 FormBox[
  InterpretationBox[
   RowBox[{
    StyleBox["\<\"FeynCalc \"\>", "Text",
     StripOnInput->False,
     FontWeight->Bold], "\[InvisibleSpace]", 
    StyleBox["\<\"9.3.0 (stable version). For help, use the \"\>", "Text",
     StripOnInput->False], "\[InvisibleSpace]", 
    StyleBox[
     TagBox[
      ButtonBox[
       RowBox[{"documentation", " ", "center"}],
       BaseStyle->"Link",
       ButtonData:>"paclet:FeynCalc/",
       ButtonNote->"paclet:FeynCalc/"],
      DisplayForm], "Text",
     StripOnInput->False], "\[InvisibleSpace]", 
    StyleBox["\<\", check out the \"\>", "Text",
     StripOnInput->False], "\[InvisibleSpace]", 
    StyleBox[
     TagBox[
      ButtonBox["wiki",
       BaseStyle->"Hyperlink",
       ButtonData:>{
         URL["https://github.com/FeynCalc/feyncalc/wiki"], None},
       ButtonNote->"https://github.com/FeynCalc/feyncalc/wiki"],
      DisplayForm], "Text",
     StripOnInput->False], "\[InvisibleSpace]", 
    StyleBox["\<\" or write to the \"\>", "Text",
     StripOnInput->False], "\[InvisibleSpace]", 
    StyleBox[
     TagBox[
      ButtonBox[
       RowBox[{"mailing", " ", 
        RowBox[{"list", "."}]}],
       BaseStyle->"Hyperlink",
       ButtonData:>{
         URL["http://www.feyncalc.org/forum/"], None},
       ButtonNote->"http://www.feyncalc.org/forum/"],
      DisplayForm], "Text",
     StripOnInput->False]}],
   SequenceForm[
    Style["FeynCalc ", "Text", Bold], 
    Style["9.3.0 (stable version). For help, use the ", "Text"], 
    Style[
     DisplayForm[
      ButtonBox[
      "documentation center", BaseStyle -> "Link", ButtonData :> 
       "paclet:FeynCalc/", ButtonNote -> "paclet:FeynCalc/"]], "Text"], 
    Style[", check out the ", "Text"], 
    Style[
     DisplayForm[
      ButtonBox["wiki", ButtonData :> {
         URL["https://github.com/FeynCalc/feyncalc/wiki"], None}, BaseStyle -> 
       "Hyperlink", ButtonNote -> 
       "https://github.com/FeynCalc/feyncalc/wiki"]], "Text"], 
    Style[" or write to the ", "Text"], 
    Style[
     DisplayForm[
      ButtonBox["mailing list.", ButtonData :> {
         URL["http://www.feyncalc.org/forum/"], None}, BaseStyle -> 
       "Hyperlink", ButtonNote -> "http://www.feyncalc.org/forum/"]], "Text"]],
   Editable->False], TraditionalForm]], "Print",
 CellChangeTimes->{3.792845541932304*^9, 3.792845683184525*^9, 
  3.792845717197946*^9, 3.79284585246637*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"10ee9f5b-7d69-4eeb-864d-3d1607b43f9a"],

Cell[BoxData[
 FormBox[
  InterpretationBox[
   RowBox[{
    StyleBox["\<\"To save your and our time, please check our \"\>", "Text",
     StripOnInput->False], "\[InvisibleSpace]", 
    StyleBox[
     TagBox[
      ButtonBox["FAQ",
       BaseStyle->"Hyperlink",
       ButtonData:>{
         URL["https://github.com/FeynCalc/feyncalc/wiki/FAQ"], None},
       ButtonNote->"https://github.com/FeynCalc/feyncalc/wiki"],
      DisplayForm], "Text",
     StripOnInput->False], "\[InvisibleSpace]", 
    StyleBox["\<\" for answers to some common FeynCalc questions.\"\>", "Text",
     StripOnInput->False]}],
   SequenceForm[
    Style["To save your and our time, please check our ", "Text"], 
    Style[
     DisplayForm[
      ButtonBox["FAQ", ButtonData :> {
         URL["https://github.com/FeynCalc/feyncalc/wiki/FAQ"], None}, 
       BaseStyle -> "Hyperlink", ButtonNote -> 
       "https://github.com/FeynCalc/feyncalc/wiki"]], "Text"], 
    Style[" for answers to some common FeynCalc questions.", "Text"]],
   Editable->False], TraditionalForm]], "Print",
 CellChangeTimes->{3.792845541932304*^9, 3.792845683184525*^9, 
  3.792845717197946*^9, 3.792845852469236*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"b7ce3597-11ff-4425-869d-42a2970f152c"],

Cell[BoxData[
 FormBox[
  InterpretationBox[
   RowBox[{
    StyleBox["\<\"See also the supplied \"\>", "Text",
     StripOnInput->False], "\[InvisibleSpace]", 
    StyleBox[
     TagBox[
      ButtonBox[
       RowBox[{"examples", "."}],
       BaseStyle->"Hyperlink",
       ButtonFunction:>SystemOpen[
         FileNameJoin[{FeynCalc`$FeynCalcDirectory, "Examples"}]],
       Evaluator->Automatic,
       Method->"Preemptive"],
      DisplayForm], "Text",
     StripOnInput->False], "\[InvisibleSpace]", 
    StyleBox["\<\" If you use FeynCalc in your research, please cite\"\>", 
     "Text",
     StripOnInput->False]}],
   SequenceForm[
    Style["See also the supplied ", "Text"], 
    Style[
     DisplayForm[
      ButtonBox[
      "examples.", BaseStyle -> "Hyperlink", ButtonFunction :> SystemOpen[
         FileNameJoin[{FeynCalc`$FeynCalcDirectory, "Examples"}]], Evaluator -> 
       Automatic, Method -> "Preemptive"]], "Text"], 
    Style[" If you use FeynCalc in your research, please cite", "Text"]],
   Editable->False], TraditionalForm]], "Print",
 CellChangeTimes->{3.792845541932304*^9, 3.792845683184525*^9, 
  3.792845717197946*^9, 3.792845852470458*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"a2d80220-6749-4f8c-968c-c832024ad6d8"],

Cell[BoxData[
 FormBox[
  StyleBox["\<\" \[Bullet] V. Shtabovenko, R. Mertig and F. Orellana, \
P3H-20-002, TTP19-020, TUM-EFT 130/19, arXiv:2001.04407\"\>", "Text",
   StripOnInput->False], TraditionalForm]], "Print",
 CellChangeTimes->{3.792845541932304*^9, 3.792845683184525*^9, 
  3.792845717197946*^9, 3.792845852471493*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"54457f41-e89b-49dc-a31f-9ce9741eb437"],

Cell[BoxData[
 FormBox[
  StyleBox["\<\" \[Bullet] V. Shtabovenko, R. Mertig and F. Orellana, Comput. \
Phys. Commun., 207, 432-444, 2016, arXiv:1601.01167\"\>", "Text",
   StripOnInput->False], TraditionalForm]], "Print",
 CellChangeTimes->{3.792845541932304*^9, 3.792845683184525*^9, 
  3.792845717197946*^9, 3.792845852472514*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"2563ff40-4eeb-4079-bc10-0656a8561d57"],

Cell[BoxData[
 FormBox[
  StyleBox["\<\" \[Bullet] R. Mertig, M. B\[ODoubleDot]hm, and A. Denner, \
Comput. Phys. Commun., 64, 345-359, 1991.\"\>", "Text",
   StripOnInput->False], TraditionalForm]], "Print",
 CellChangeTimes->{3.792845541932304*^9, 3.792845683184525*^9, 
  3.792845717197946*^9, 3.79284585247351*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"e46ae6be-e545-46ba-b6c9-85d62a74b52e"],

Cell[BoxData[
 FormBox[
  InterpretationBox[
   RowBox[{
    StyleBox["\<\"FeynHelpers \"\>", "Text",
     StripOnInput->False,
     FontWeight->Bold], "\[InvisibleSpace]", 
    StyleBox["\<\"1.2.0, for more information see the accompanying \"\>", 
     "Text",
     StripOnInput->False], "\[InvisibleSpace]", 
    StyleBox[
     TagBox[
      ButtonBox[
       RowBox[{"publication", "."}],
       BaseStyle->"Hyperlink",
       ButtonFunction:>SystemOpen[
         FileNameJoin[{
          FeynCalc`$FeynHelpersDirectory, "Documentation", "1611.06793.pdf"}]],
       Evaluator->Automatic,
       Method->"Preemptive"],
      DisplayForm], "Text",
     StripOnInput->False]}],
   SequenceForm[
    Style["FeynHelpers ", "Text", Bold], 
    Style["1.2.0, for more information see the accompanying ", "Text"], 
    Style[
     DisplayForm[
      ButtonBox[
      "publication.", BaseStyle -> "Hyperlink", ButtonFunction :> SystemOpen[
         FileNameJoin[{
          FeynCalc`$FeynHelpersDirectory, "Documentation", 
           "1611.06793.pdf"}]], Evaluator -> Automatic, Method -> 
       "Preemptive"]], "Text"]],
   Editable->False], TraditionalForm]], "Print",
 CellChangeTimes->{3.792845541932304*^9, 3.792845683184525*^9, 
  3.792845717197946*^9, 3.7928458524746513`*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"db0d56a3-2100-4d13-b38b-ad9ff55e456a"],

Cell[BoxData[
 FormBox[
  InterpretationBox[
   RowBox[{
    StyleBox["\<\"Have a look at the supplied \"\>", "Text",
     StripOnInput->False], "\[InvisibleSpace]", 
    StyleBox[
     TagBox[
      ButtonBox[
       RowBox[{"examples", "."}],
       BaseStyle->"Hyperlink",
       ButtonFunction:>SystemOpen[
         FileNameJoin[{FeynCalc`$FeynHelpersDirectory, "Examples"}]],
       Evaluator->Automatic,
       Method->"Preemptive"],
      DisplayForm], "Text",
     StripOnInput->False], "\[InvisibleSpace]", 
    StyleBox["\<\" If you use FeynHelpers in your research, please cite\"\>", 
     "Text",
     StripOnInput->False]}],
   SequenceForm[
    Style["Have a look at the supplied ", "Text"], 
    Style[
     DisplayForm[
      ButtonBox[
      "examples.", BaseStyle -> "Hyperlink", ButtonFunction :> SystemOpen[
         FileNameJoin[{FeynCalc`$FeynHelpersDirectory, "Examples"}]], 
       Evaluator -> Automatic, Method -> "Preemptive"]], "Text"], 
    Style[" If you use FeynHelpers in your research, please cite", "Text"]],
   Editable->False], TraditionalForm]], "Print",
 CellChangeTimes->{3.792845541932304*^9, 3.792845683184525*^9, 
  3.792845717197946*^9, 3.792845852475813*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"781667f2-cd2e-447d-8b82-f3d4cde31266"],

Cell[BoxData[
 FormBox[
  StyleBox["\<\" \[Bullet] V. Shtabovenko, \\\"FeynHelpers: Connecting \
FeynCalc to FIRE and Package-X\\\", Comput. Phys. Commun., 218, 48-65, 2017, \
arXiv:1611.06793\"\>", "Text",
   StripOnInput->False], TraditionalForm]], "Print",
 CellChangeTimes->{3.792845541932304*^9, 3.792845683184525*^9, 
  3.792845717197946*^9, 3.792845852476843*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"3fa79829-acbf-4f97-8429-66cccc23f6ef"],

Cell[BoxData[
 FormBox[
  StyleBox["\<\"Furthermore, remember to cite the authors of the tools that \
you are calling from FeynHelpers, which are\"\>", "Text",
   StripOnInput->False], TraditionalForm]], "Print",
 CellChangeTimes->{3.792845541932304*^9, 3.792845683184525*^9, 
  3.792845717197946*^9, 3.792845852477848*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"a8d7c128-c15f-4415-b7ed-d0669dc7fd65"],

Cell[BoxData[
 FormBox[
  InterpretationBox[
   RowBox[{"\<\" \[Bullet] \"\>", "\[InvisibleSpace]", 
    StyleBox[
     TagBox[
      ButtonBox["FIRE",
       BaseStyle->"Hyperlink",
       ButtonData:>{
         URL["http://science.sander.su/FIRE.htm"], None},
       ButtonNote->"http://science.sander.su/FIRE.htm"],
      DisplayForm], "Text",
     StripOnInput->False], "\[InvisibleSpace]", 
    StyleBox["\<\" by A. Smirnov, if you are using the function \
FIREBurn.\"\>", "Text",
     StripOnInput->False]}],
   SequenceForm[
    Style[" \[Bullet] "], 
    Style[
     DisplayForm[
      ButtonBox["FIRE", ButtonData :> {
         URL["http://science.sander.su/FIRE.htm"], None}, BaseStyle -> 
       "Hyperlink", ButtonNote -> "http://science.sander.su/FIRE.htm"]], 
     "Text"], 
    Style[" by A. Smirnov, if you are using the function FIREBurn.", "Text"]],
   
   Editable->False], TraditionalForm]], "Print",
 CellChangeTimes->{3.792845541932304*^9, 3.792845683184525*^9, 
  3.792845717197946*^9, 3.7928458524789457`*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"5ac60e9b-bb3d-47e5-b21b-37326e609ba8"],

Cell[BoxData[
 FormBox[
  InterpretationBox[
   RowBox[{"\<\" \[Bullet] \"\>", "\[InvisibleSpace]", 
    StyleBox[
     TagBox[
      ButtonBox[
       RowBox[{"Package", "-", "X"}],
       BaseStyle->"Hyperlink",
       ButtonData:>{
         URL["https://packagex.hepforge.org"], None},
       ButtonNote->"https://packagex.hepforge.org"],
      DisplayForm], "Text",
     StripOnInput->False], "\[InvisibleSpace]", 
    StyleBox["\<\" by H. Patel, if you are using the function \
PaXEvaluate.\"\>", "Text",
     StripOnInput->False]}],
   SequenceForm[
    Style[" \[Bullet] "], 
    Style[
     DisplayForm[
      ButtonBox["Package-X", ButtonData :> {
         URL["https://packagex.hepforge.org"], None}, BaseStyle -> 
       "Hyperlink", ButtonNote -> "https://packagex.hepforge.org"]], "Text"], 
    
    Style[" by H. Patel, if you are using the function PaXEvaluate.", "Text"]],
   Editable->False], TraditionalForm]], "Print",
 CellChangeTimes->{3.792845541932304*^9, 3.792845683184525*^9, 
  3.792845717197946*^9, 3.7928458524800377`*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"7f00dffe-0c5f-4383-894c-43aad57d6ef8"],

Cell[BoxData[
 FormBox[
  InterpretationBox[
   RowBox[{
    StyleBox["\<\"FeynArts \"\>", "Text",
     StripOnInput->False,
     FontWeight->Bold], "\[InvisibleSpace]", 
    StyleBox["\<\"3.11 (2 Sep 2019) patched for use with FeynCalc, for \
documentation see the \"\>", "Text",
     StripOnInput->False], "\[InvisibleSpace]", 
    StyleBox[
     TagBox[
      ButtonBox["manual",
       BaseStyle->"Hyperlink",
       ButtonFunction:>SystemOpen[
         First[
          FileNames[{"*.pdf", "*.PDF"}, 
           FileNameJoin[{FeynCalc`$FeynArtsDirectory, "manual"}]]]],
       Evaluator->Automatic,
       Method->"Preemptive"],
      DisplayForm], "Text",
     StripOnInput->False], "\[InvisibleSpace]", 
    StyleBox["\<\" or visit \"\>", "Text",
     StripOnInput->False], "\[InvisibleSpace]", 
    StyleBox[
     TagBox[
      ButtonBox[
       RowBox[{"www", ".", "feynarts", ".", "de", "."}],
       BaseStyle->"Hyperlink",
       ButtonData:>{
         URL["http://www.feynarts.de/"], None},
       ButtonNote->"www.feynarts.de/"],
      DisplayForm], "Text",
     StripOnInput->False]}],
   SequenceForm[
    Style["FeynArts ", "Text", Bold], 
    Style[
    "3.11 (2 Sep 2019) patched for use with FeynCalc, for documentation see \
the ", "Text"], 
    Style[
     DisplayForm[
      ButtonBox[
      "manual", BaseStyle -> "Hyperlink", ButtonFunction :> SystemOpen[
         First[
          FileNames[{"*.pdf", "*.PDF"}, 
           FileNameJoin[{FeynCalc`$FeynArtsDirectory, "manual"}]]]], 
       Evaluator -> Automatic, Method -> "Preemptive"]], "Text"], 
    Style[" or visit ", "Text"], 
    Style[
     DisplayForm[
      ButtonBox["www.feynarts.de.", ButtonData :> {
         URL["http://www.feynarts.de/"], None}, BaseStyle -> "Hyperlink", 
       ButtonNote -> "www.feynarts.de/"]], "Text"]],
   Editable->False], TraditionalForm]], "Print",
 CellChangeTimes->{3.792845541932304*^9, 3.792845683184525*^9, 
  3.792845717197946*^9, 3.792845852532825*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"95f5ea30-4f14-4ce0-bcfe-4975887ade62"],

Cell[BoxData[
 FormBox[
  StyleBox["\<\"If you use FeynArts in your research, please cite\"\>", "Text",
   StripOnInput->False], TraditionalForm]], "Print",
 CellChangeTimes->{3.792845541932304*^9, 3.792845683184525*^9, 
  3.792845717197946*^9, 3.792845852534025*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"a92ad80b-c672-4121-9309-0b2abf0efccf"],

Cell[BoxData[
 FormBox[
  StyleBox["\<\" \[Bullet] T. Hahn, Comput. Phys. Commun., 140, 418-431, \
2001, arXiv:hep-ph/0012260\"\>", "Text",
   StripOnInput->False], TraditionalForm]], "Print",
 CellChangeTimes->{3.792845541932304*^9, 3.792845683184525*^9, 
  3.792845717197946*^9, 3.7928458525349483`*^9},
 CellLabel->
  "During evaluation of \
In[1]:=",ExpressionUUID->"dc70cc38-3d84-4cff-9d29-9a8424bb3aeb"]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Set Model", "Subsection",
 CellChangeTimes->{{3.792845669013047*^9, 3.792845674684402*^9}, {
  3.792845707429357*^9, 
  3.792845708269414*^9}},ExpressionUUID->"9ae17e2a-f31e-4460-9dad-\
79c0fd5114d5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"model", "=", 
   RowBox[{"FileNameJoin", "[", 
    RowBox[{"{", 
     RowBox[{"\"\<HazmaVector\>\"", ",", "\"\<HazmaVector\>\""}], "}"}], 
    "]"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"genericModel", "=", 
   RowBox[{"{", 
    RowBox[{"\"\<Lorentz\>\"", ",", "model"}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.79270176411616*^9, 3.792701776182949*^9}, {
  3.792802455365045*^9, 3.792802456848913*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"894109e0-4414-4e15-9056-7622402ca770"]
}, Closed]],

Cell[CellGroupData[{

Cell["Substitute Unstable Propagator", "Subsection",
 CellChangeTimes->{{3.792512471437359*^9, 
  3.792512481041593*^9}},ExpressionUUID->"004e0aee-d23a-41e2-a732-\
14e653885b6d"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"GetWidth", "[", 
    RowBox[{
     RowBox[{"SMP", "[", "\"\<m_H\>\"", "]"}], "|", "MH"}], "]"}], "=", 
   "\[CapitalGamma]H"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GetWidth", "[", 
    RowBox[{
     RowBox[{"SMP", "[", "\"\<m_Z\>\"", "]"}], "|", "MZ"}], "]"}], "=", 
   "\[CapitalGamma]Z"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GetWidth", "[", 
    RowBox[{
     RowBox[{"SMP", "[", "\"\<m_W\>\"", "]"}], "|", "MW"}], "]"}], "=", 
   "\[CapitalGamma]W"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GetWidth", "[", "MSM", "]"}], "=", "\[CapitalGamma]SM"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GetWidth", "[", "mv", "]"}], "=", "widthv"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SubstituteUnstablePropagator", "[", "expr_", "]"}], ":=", 
  RowBox[{"expr", "/.", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"FeynAmpDenominator", "[", 
      RowBox[{"PropagatorDenominator", "[", 
       RowBox[{
        RowBox[{"Momentum", "[", "a__", "]"}], ",", 
        RowBox[{"m", ":", 
         RowBox[{
          RowBox[{"SMP", "[", "\"\<m_H\>\"", "]"}], "|", "MH", "|", 
          RowBox[{"SMP", "[", "\"\<m_Z\>\"", "]"}], "|", "MZ", "|", 
          RowBox[{"SMP", "[", "\"\<m_W\>\"", "]"}], "|", "MW", "|", "MSM", 
          "|", "mv"}]}]}], "]"}], "]"}], "\[RuleDelayed]", 
     RowBox[{"Den", "[", 
      RowBox[{
       RowBox[{"ScalarProductExpand", "[", 
        RowBox[{"SP", "[", 
         RowBox[{"a", ",", "a"}], "]"}], "]"}], "-", 
       SuperscriptBox["m", "2"], "+", 
       RowBox[{"I", "*", 
        RowBox[{"GetWidth", "[", "m", "]"}], "*", "m"}]}], "]"}]}], 
    "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"Den", "/:", 
  RowBox[{"Times", "[", 
   RowBox[{
    RowBox[{"Den", "[", "a__", "]"}], ",", 
    RowBox[{"Den", "[", "b__", "]"}]}], "]"}], ":=", 
  RowBox[{"Den", "[", 
   RowBox[{"a", "*", "b"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.792845807015852*^9, 3.792845817906522*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"7c3c8027-f6c3-43e8-96b5-c750e3b3675e"]
}, Closed]],

Cell[CellGroupData[{

Cell["Particles Names and Utilities", "Subsection",
 CellChangeTimes->{{3.792527811074379*^9, 3.792527818013311*^9}, {
  3.792845839115364*^9, 
  3.7928458416174183`*^9}},ExpressionUUID->"e57f47f7-3121-47e2-a891-\
13515311ea23"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "determine", " ", "if", " ", "state", " ", "is", " ", "a", " ", 
    "fermion"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"IsFermion", "[", "state_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "head", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"if", " ", "state", " ", "looks", " ", 
          RowBox[{"like", ":", " ", 
           RowBox[{"-", 
            RowBox[{"F", "[", "1", "]"}]}]}]}], ",", " ", 
         RowBox[{
         "need", " ", "to", " ", "strip", " ", "off", " ", "the", " ", 
          "`Times`", " ", "head"}]}], " ", "*)"}], 
       RowBox[{
        RowBox[{"head", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Head", "[", "state", "]"}], "===", "Times"}], ",", 
           RowBox[{"Head", "[", 
            RowBox[{"ReplaceAll", "[", 
             RowBox[{"state", ",", 
              RowBox[{
               RowBox[{"Times", "[", 
                RowBox[{"a_", ",", "b__"}], "]"}], "\[RuleDelayed]", "b"}]}], 
             "]"}], "]"}], ",", 
           RowBox[{"Head", "[", "state", "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"head", "===", "FeynArts`F"}], "||", 
         RowBox[{"head", "===", "FeynArts`U"}]}]}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "determine", " ", "if", " ", "state", " ", "is", " ", "a", " ", 
     "vector"}], "*)"}], "\n", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"IsVector", "[", "state_", "]"}], ":=", 
     RowBox[{"Module", "[", 
      RowBox[{
       RowBox[{"{", "head", "}"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"if", " ", "state", " ", "looks", " ", 
          RowBox[{"like", ":", " ", 
           RowBox[{"-", 
            RowBox[{"V", "[", "1", "]"}]}]}]}], ",", " ", 
         RowBox[{
         "need", " ", "to", " ", "strip", " ", "off", " ", "the", " ", 
          "`Times`", " ", "head"}]}], "*)"}], 
       RowBox[{
        RowBox[{"head", "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Head", "[", "state", "]"}], "===", "Times"}], ",", 
           RowBox[{"Head", "[", 
            RowBox[{"ReplaceAll", "[", 
             RowBox[{"state", ",", 
              RowBox[{
               RowBox[{"Times", "[", 
                RowBox[{"a_", ",", "b__"}], "]"}], "\[RuleDelayed]", "b"}]}], 
             "]"}], "]"}], ",", 
           RowBox[{"Head", "[", "state", "]"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"head", "===", "FeynArts`V"}]}]}], "\[IndentingNewLine]", 
      "]"}]}], ";"}]}]}]], "Input",
 CellLabel->"In[14]:=",ExpressionUUID->"020a2eac-da1c-4e59-aefe-827774b36f30"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"SM", " ", "Mesons"}], " ", "*)"}], "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"NeutralPion", " ", "=", " ", 
     RowBox[{"FeynArts`S", "[", "1", "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"ChargedPionM", " ", "=", " ", 
     RowBox[{"FeynArts`S", "[", "2", "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"ChargedPionP", " ", "=", " ", 
     RowBox[{"-", 
      RowBox[{"FeynArts`S", "[", "2", "]"}]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"NeutralKaon", " ", "=", " ", 
     RowBox[{"FeynArts`S", "[", "3", "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"AntiNeutralKaon", " ", "=", " ", 
     RowBox[{"-", 
      RowBox[{"FeynArts`S", "[", "3", "]"}]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"ChargedKaonM", " ", "=", " ", 
     RowBox[{"FeynArts`S", "[", "4", "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"ChargedKaonP", " ", "=", " ", 
     RowBox[{"-", 
      RowBox[{"FeynArts`S", "[", "4", "]"}]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Eta", " ", "=", " ", 
     RowBox[{"FeynArts`S", "[", "5", "]"}]}], ";"}], "\n", "\n", 
   RowBox[{"(*", " ", 
    RowBox[{"SM", " ", "vectors"}], " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"Photon", " ", "=", " ", 
     RowBox[{"FeynArts`V", "[", "1", "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Rho", " ", "=", " ", 
     RowBox[{"FeynArts`V", "[", "2", "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Omega", " ", "=", " ", 
     RowBox[{"FeynArts`V", "[", "1", "]"}]}], ";"}], "\n", "\n", 
   RowBox[{"(*", " ", "Leptons", " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"Neutrino", " ", "=", " ", 
     RowBox[{"FeynArts`F", "[", "1", "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"AntiNeutrino", " ", "=", " ", 
     RowBox[{"-", 
      RowBox[{"FeynArts`F", "[", "1", "]"}]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Lepton", " ", "=", " ", 
     RowBox[{"FeynArts`F", "[", "2", "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"AntiLepton", " ", "=", " ", 
     RowBox[{"-", 
      RowBox[{"FeynArts`F", "[", "2", "]"}]}]}], ";"}], "\n", "\n", 
   RowBox[{"(*", " ", "DM", " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"DarkMatter", " ", "=", " ", 
     RowBox[{"FeynArts`F", "[", "3", "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"AntiDarkMatter", " ", "=", " ", 
     RowBox[{"-", 
      RowBox[{"FeynArts`F", "[", "3", "]"}]}]}], ";"}], "\n", "\n", 
   RowBox[{"(*", " ", "mediators", " ", "*)"}], "\n", 
   RowBox[{
    RowBox[{"ScalarMediator", " ", "=", " ", 
     RowBox[{"FeynArts`S", "[", "7", "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"PseudoScalarMediator", " ", "=", " ", 
     RowBox[{"FeynArts`S", "[", "7", "]"}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"VectorMediator", " ", "=", " ", 
     RowBox[{"FeynArts`V", "[", "4", "]"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.7927017869243917`*^9, 3.7927017912816973`*^9}, {
   3.792701861376624*^9, 3.7927018620529757`*^9}, 3.792802540647171*^9, {
   3.792802594334922*^9, 3.792802630460883*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"14fb62e1-2176-4306-a9f5-39c89a782700"]
}, Closed]],

Cell[CellGroupData[{

Cell["Correction Final Expression", "Subsection",
 CellChangeTimes->{{3.792528077506795*^9, 
  3.792528086988639*^9}},ExpressionUUID->"f815779a-59b6-4d03-bb00-\
c5753d023a7e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"CorrectParameters", "[", "expr_", "]"}], ":=", 
  RowBox[{"expr", "/.", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"SMP", "[", "\"\<m_H\>\"", "]"}], "\[Rule]", "MH"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"SMP", "[", "\"\<m_W\>\"", "]"}], "\[Rule]", "MW"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"SMP", "[", "\"\<m_Z\>\"", "]"}], "\[Rule]", "MZ"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"SMP", "[", "\"\<m_t\>\"", "]"}], "\[Rule]", "MTOP"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"SMP", "[", "\"\<m_b\>\"", "]"}], "\[Rule]", "MB"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"SMP", "[", "\"\<e\>\"", "]"}], "\[Rule]", 
      SqrtBox[
       RowBox[{"4", "\[Pi]", " ", "alphaEM"}]]}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"FCGV", "[", "\"\<MH\>\"", "]"}], "\[Rule]", "MH"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"FCGV", "[", "\"\<MZ\>\"", "]"}], "\[Rule]", "MZ"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"FCGV", "[", "\"\<MW\>\"", "]"}], "\[Rule]", "MW"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"FCGV", "[", "\"\<MT\>\"", "]"}], "\[Rule]", "MTOP"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"FCGV", "[", "\"\<MB\>\"", "]"}], "\[Rule]", "MB"}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"FCGV", "[", "\"\<EL\>\"", "]"}], "\[Rule]", 
      SqrtBox[
       RowBox[{"4", "\[Pi]", " ", "alphaEM"}]]}], ",", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{"Plus", "[", 
       RowBox[{
        SuperscriptBox["cw", "2"], ",", 
        SuperscriptBox["sw", "2"]}], "]"}], "\[RuleDelayed]", "1"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"SUNFDelta", "[", 
        RowBox[{
         RowBox[{"SUNFIndex", "[", "a_", "]"}], ",", 
         RowBox[{"SUNFIndex", "[", "b_", "]"}]}], "]"}], "^", "2"}], 
      "\[RuleDelayed]", "Ncol"}]}], "\[IndentingNewLine]", "}"}]}]}]], "Input",\

 CellLabel->"In[36]:=",ExpressionUUID->"eb26c15a-ab2c-431c-9fac-5f6e8b8ea7c7"]
}, Closed]],

Cell[CellGroupData[{

Cell["Generating Diagrams", "Subsection",
 CellChangeTimes->{{3.7925102980421133`*^9, 
  3.792510301206249*^9}},ExpressionUUID->"38c336f3-e6e7-4de4-aacc-\
a1956ea49427"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "GenerateDiagrams", "]"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"CreateTopologies", " ", "Options"}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"LoopNumber", "\[Rule]", "0"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Adjacencies", "->", 
      RowBox[{"OptionValue", "[", 
       RowBox[{"CreateTopologies", ",", "Adjacencies"}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"ExcludeTopologies", "->", 
      RowBox[{"OptionValue", "[", 
       RowBox[{"CreateTopologies", ",", "ExcludeTopologies"}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"InsertFields", " ", "Options"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"ExcludeParticles", "\[Rule]", 
      RowBox[{"OptionValue", "[", 
       RowBox[{"InsertFields", ",", "ExcludeParticles"}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"InsertionLevel", "\[Rule]", 
      RowBox[{"{", "Particles", "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"Model", "->", 
      RowBox[{"OptionValue", "[", 
       RowBox[{"InsertFields", ",", "Model"}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"GenericModel", "->", 
      RowBox[{"OptionValue", "[", 
       RowBox[{"InsertFields", ",", "GenericModel"}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Painting", " ", "Options"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"Paint", "\[Rule]", "False"}], ",", "\[IndentingNewLine]", 
     RowBox[{"ColumnsXRows", "\[Rule]", 
      RowBox[{"OptionValue", "[", 
       RowBox[{"Paint", ",", "ColumnsXRows"}], "]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Custom", " ", "options"}], " ", "*)"}], "\[IndentingNewLine]", 
     
     RowBox[{"DiagramExtract", "\[Rule]", "None"}]}], "\[IndentingNewLine]", 
    "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7925103182228117`*^9, 3.792510332011416*^9}, {
  3.792510405749351*^9, 3.792510487782724*^9}, {3.792510734663341*^9, 
  3.792510844118018*^9}, {3.792526772233161*^9, 3.792526804384036*^9}},
 CellLabel->"In[37]:=",ExpressionUUID->"02d465e2-3565-49ca-a215-c56367deea2b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GenerateDiagrams", "[", 
   RowBox[{
    RowBox[{"inStates_List", "\[Rule]", "outStates_List"}], ",", 
    RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"topologies", ",", "diagrams"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{"Create", " ", "the", " ", "topologies"}], " ", "*)"}], 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"topologies", "=", 
      RowBox[{"CreateTopologies", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"OptionValue", "[", "LoopNumber", "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Length", "[", "inStates", "]"}], "\[Rule]", 
         RowBox[{"Length", "[", "outStates", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"ExcludeTopologies", "\[Rule]", 
         RowBox[{"OptionValue", "[", "ExcludeTopologies", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Adjacencies", "\[Rule]", 
         RowBox[{"OptionValue", "[", "Adjacencies", "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Generate", " ", "the", " ", "diagrams"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"diagrams", "=", 
      RowBox[{"InsertFields", "[", "\[IndentingNewLine]", 
       RowBox[{"topologies", ",", "\[IndentingNewLine]", 
        RowBox[{"inStates", "\[Rule]", "outStates"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"InsertionLevel", "\[Rule]", 
         RowBox[{"OptionValue", "[", "InsertionLevel", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"ExcludeParticles", "\[Rule]", 
         RowBox[{"OptionValue", "[", "ExcludeParticles", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Model", "->", 
         RowBox[{"OptionValue", "[", "Model", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"GenericModel", "->", 
         RowBox[{"OptionValue", "[", "GenericModel", "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"Not", "[", 
        RowBox[{"SameQ", "[", 
         RowBox[{
          RowBox[{"OptionValue", "[", "DiagramExtract", "]"}], ",", "None"}], 
         "]"}], "]"}], ",", 
       RowBox[{"diagrams", "=", 
        RowBox[{"DiagramExtract", "[", 
         RowBox[{"diagrams", ",", 
          RowBox[{"OptionValue", "[", "DiagramExtract", "]"}]}], "]"}]}]}], 
      "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Paint", " ", "if", " ", "requested"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"OptionValue", "[", "Paint", "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Paint", "[", 
         RowBox[{"diagrams", ",", 
          RowBox[{"ColumnsXRows", "\[Rule]", 
           RowBox[{"OptionValue", "[", "ColumnsXRows", "]"}]}]}], "]"}], 
        ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "diagrams"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.7925105107992268`*^9, 3.7925107316885*^9}, {
  3.7925108529001093`*^9, 3.792510959393908*^9}, {3.7925268102994823`*^9, 
  3.792526818126642*^9}, {3.792526924994321*^9, 3.792526955340814*^9}},
 CellLabel->"In[38]:=",ExpressionUUID->"bbc4b536-3da9-4a55-8583-e8bdb07b9eff"]
}, Closed]],

Cell[CellGroupData[{

Cell["Creating Amplitudes", "Subsection",
 CellChangeTimes->{{3.792511169941691*^9, 
  3.792511181623899*^9}},ExpressionUUID->"36d8ac8b-75c5-497d-b996-\
8fae3cc9f7c6"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Options", "[", "ComputeAmplitude", "]"}], "=", 
    RowBox[{"Join", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Options", "[", "GenerateDiagrams", "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Options", "[", "CreateFeynAmp", "]"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Options", "[", "FCFAConvert", "]"}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ComputeAmplitude", "[", 
   RowBox[{
    RowBox[{"inStates_List", "\[Rule]", "outStates_List"}], ",", 
    RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"diagrams", ",", "ampFA", ",", "ampFC"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ClearScalarProducts", "[", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"diagrams", "=", 
      RowBox[{"GenerateDiagrams", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"inStates", "->", "outStates"}], ",", "\[IndentingNewLine]", 
        RowBox[{"LoopNumber", "\[Rule]", 
         RowBox[{"OptionValue", "[", "LoopNumber", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Adjacencies", "\[Rule]", 
         RowBox[{"OptionValue", "[", "Adjacencies", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"ExcludeTopologies", "\[Rule]", 
         RowBox[{"OptionValue", "[", "ExcludeTopologies", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"ExcludeParticles", "\[Rule]", 
         RowBox[{"OptionValue", "[", "ExcludeParticles", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"InsertionLevel", "\[Rule]", 
         RowBox[{"OptionValue", "[", "InsertionLevel", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Model", "\[Rule]", 
         RowBox[{"OptionValue", "[", "Model", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"GenericModel", "\[Rule]", 
         RowBox[{"OptionValue", "[", "GenericModel", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Paint", "\[Rule]", 
         RowBox[{"OptionValue", "[", "Paint", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"ColumnsXRows", "\[Rule]", 
         RowBox[{"OptionValue", "[", "ColumnsXRows", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"DiagramExtract", "\[Rule]", 
         RowBox[{"OptionValue", "[", "DiagramExtract", "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"ampFA", "=", 
      RowBox[{"CreateFeynAmp", "[", "\[IndentingNewLine]", 
       RowBox[{"diagrams", ",", "\[IndentingNewLine]", 
        RowBox[{"AmplitudeLevel", "\[Rule]", 
         RowBox[{"OptionValue", "[", "AmplitudeLevel", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"GaugeRules", "\[Rule]", 
         RowBox[{"OptionValue", "[", "GaugeRules", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"PreFactor", "\[Rule]", 
         RowBox[{"OptionValue", "[", "PreFactor", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Truncated", "\[Rule]", 
         RowBox[{"OptionValue", "[", "Truncated", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"MomentumConservation", "\[Rule]", 
         RowBox[{"OptionValue", "[", "MomentumConservation", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"GraphInfoFunction", "\[Rule]", 
         RowBox[{"OptionValue", "[", "GraphInfoFunction", "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"ampFC", "=", 
      RowBox[{"FCFAConvert", "[", "\[IndentingNewLine]", 
       RowBox[{"ampFA", ",", "\[IndentingNewLine]", 
        RowBox[{"ChangeDimension", "\[Rule]", 
         RowBox[{"OptionValue", "[", "ChangeDimension", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Contract", "\[Rule]", 
         RowBox[{"OptionValue", "[", "Contract", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"DropSumOver", "\[Rule]", 
         RowBox[{"OptionValue", "[", "DropSumOver", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"FCFADiracChainJoin", "\[Rule]", 
         RowBox[{"OptionValue", "[", "FCFADiracChainJoin", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"FeynAmpDenominatorCombine", "\[Rule]", 
         RowBox[{"OptionValue", "[", "FeynAmpDenominatorCombine", "]"}]}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"FinalSubstitutions", "\[Rule]", 
         RowBox[{"OptionValue", "[", "FinalSubstitutions", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"IncomingMomenta", "\[Rule]", 
         RowBox[{"OptionValue", "[", "IncomingMomenta", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"List", "\[Rule]", 
         RowBox[{"OptionValue", "[", "List", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"LoopMomenta", "\[Rule]", 
         RowBox[{"OptionValue", "[", "LoopMomenta", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"LorentzIndexNames", "\[Rule]", 
         RowBox[{"OptionValue", "[", "LorentzIndexNames", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"OutgoingMomenta", "\[Rule]", 
         RowBox[{"OptionValue", "[", "OutgoingMomenta", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Prefactor", "\[Rule]", 
         RowBox[{"OptionValue", "[", "Prefactor", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"SMP", "\[Rule]", 
         RowBox[{"OptionValue", "[", "SMP", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"SUNFIndexNames", "\[Rule]", 
         RowBox[{"OptionValue", "[", "SUNFIndexNames", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"SUNIndexNames", "\[Rule]", 
         RowBox[{"OptionValue", "[", "SUNIndexNames", "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"TransversePolarizationVectors", "\[Rule]", 
         RowBox[{"OptionValue", "[", "TransversePolarizationVectors", "]"}]}],
         ",", "\[IndentingNewLine]", 
        RowBox[{"UndoChiralSplittings", "\[Rule]", 
         RowBox[{"OptionValue", "[", "UndoChiralSplittings", "]"}]}]}], 
       "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"ampFC", "=", 
      RowBox[{"Map", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Simplify", "[", "\[IndentingNewLine]", 
          RowBox[{"ExpandScalarProduct", "[", "\[IndentingNewLine]", 
           RowBox[{"DiracSimplify", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"Contract", "[", "\[IndentingNewLine]", 
              RowBox[{
              "SubstituteUnstablePropagator", "[", "\[IndentingNewLine]", 
               RowBox[{"ReplaceAll", "[", 
                RowBox[{"#", ",", "\[IndentingNewLine]", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"FALeviCivita", "\[Rule]", "Eps"}], ",", 
                   RowBox[{"FAFourVector", "\[Rule]", "Momentum"}]}], "}"}]}],
                 "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "]"}], 
              "\[IndentingNewLine]", "]"}], ",", 
             RowBox[{"DiracSubstitute67", "\[Rule]", "True"}]}], "]"}], 
           "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", "]"}], "&"}], 
        ",", "ampFC"}], "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}]}], "Input",\

 CellChangeTimes->{{3.79251120160042*^9, 3.792511710628454*^9}, {
   3.792511765030355*^9, 3.792512443267514*^9}, {3.792512564985021*^9, 
   3.792512570243196*^9}, 3.792512622117272*^9, {3.792512827865035*^9, 
   3.7925128312804527`*^9}, {3.7925152684138308`*^9, 3.792515271224979*^9}, {
   3.7925270933467903`*^9, 3.792527104917358*^9}},
 CellLabel->"In[39]:=",ExpressionUUID->"783d3b96-1e10-4f3c-9f0b-b0e8f8635243"]
}, Closed]],

Cell[CellGroupData[{

Cell["Creating Squared Amplitudes", "Subsection",
 CellChangeTimes->{{3.792512728166559*^9, 
  3.7925127339465313`*^9}},ExpressionUUID->"aa2616d4-8cff-4b88-a2b6-\
5dc0f0a6ad00"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "ComputeAmplitudeSquared", "]"}], "=", 
   RowBox[{"Options", "[", "ComputeAmplitude", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.792692639406909*^9, 3.792692660845166*^9}, {
  3.7926930800477448`*^9, 3.792693082307104*^9}, {3.7926933810884123`*^9, 
  3.792693382635934*^9}},
 CellLabel->"In[41]:=",ExpressionUUID->"c4f84656-5018-47c6-bb57-04371901c4d2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ComputeAmplitudeSquared", "[", 
   RowBox[{
    RowBox[{"inStates_List", "\[Rule]", "outStates_List"}], ",", 
    RowBox[{"opts", ":", 
     RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "iAmp", ",", "iIncomingMomenta", ",", "iOutgoingMomenta", ",", "iIter", 
      ",", "iMsqrd", ",", "iDoFermionSpinSum", ",", 
      "iFermionSpinSumPreFactor", ",", "\[IndentingNewLine]", 
      "iDoPolarizationSum", ",", "iPolarizationSumPreFactor", ",", 
      "iPolarizationSumStateMomenta"}], "\[IndentingNewLine]", "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"iAmp", "=", 
      RowBox[{"ComputeAmplitude", "[", 
       RowBox[{
        RowBox[{"inStates", "\[Rule]", "outStates"}], ",", "opts"}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"ClearScalarProducts", "[", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Determine", " ", 
       RowBox[{"incoming", "/", "outogoing"}], " ", "momenta"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"iIncomingMomenta", "=", 
      RowBox[{"OptionValue", "[", "IncomingMomenta", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"iOutgoingMomenta", "=", 
      RowBox[{"OptionValue", "[", "OutgoingMomenta", "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", " ", "user", " ", 
        RowBox[{"didn", "'"}], "t", " ", "specify", " ", "momenta"}], ",", 
       " ", 
       RowBox[{
       "populate", " ", "them", "\[IndentingNewLine]", "based", " ", "on", 
        " ", "what", " ", "FeynCalc", " ", "does"}]}], "\[IndentingNewLine]", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"iIter", "=", 
        RowBox[{
         RowBox[{"Length", "[", "iIncomingMomenta", "]"}], "+", "1"}]}], ",", 
       
       RowBox[{"iIter", "\[LessEqual]", 
        RowBox[{"Length", "[", "inStates", "]"}]}], ",", 
       RowBox[{"iIter", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"AppendTo", "[", 
         RowBox[{"iIncomingMomenta", ",", 
          RowBox[{"ToExpression", "[", 
           RowBox[{"\"\<InMom\>\"", "<>", 
            RowBox[{"ToString", "[", "iIter", "]"}]}], "]"}]}], "]"}], 
        ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"iIter", "=", 
        RowBox[{
         RowBox[{"Length", "[", "iOutgoingMomenta", "]"}], "+", "1"}]}], ",", 
       
       RowBox[{"iIter", "\[LessEqual]", 
        RowBox[{"Length", "[", "outStates", "]"}]}], ",", 
       RowBox[{"iIter", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"AppendTo", "[", 
         RowBox[{"iOutgoingMomenta", ",", 
          RowBox[{"ToExpression", "[", 
           RowBox[{"\"\<OutMom\>\"", "<>", 
            RowBox[{"ToString", "[", "iIter", "]"}]}], "]"}]}], "]"}], 
        ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Set", " ", "the", " ", "masses"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"iIter", "=", "1"}], ",", 
       RowBox[{"iIter", "\[LessEqual]", 
        RowBox[{"Length", "[", "iIncomingMomenta", "]"}]}], ",", 
       RowBox[{"iIter", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"SP", "[", 
          RowBox[{"iIncomingMomenta", "[", 
           RowBox[{"[", "iIter", "]"}], "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{"TheMass", "[", 
           RowBox[{"inStates", "[", 
            RowBox[{"[", "iIter", "]"}], "]"}], "]"}], "^", "2"}]}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"iIter", "=", "1"}], ",", 
       RowBox[{"iIter", "\[LessEqual]", 
        RowBox[{"Length", "[", "iOutgoingMomenta", "]"}]}], ",", 
       RowBox[{"iIter", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"SP", "[", 
          RowBox[{"iOutgoingMomenta", "[", 
           RowBox[{"[", "iIter", "]"}], "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{"TheMass", "[", 
           RowBox[{"outStates", "[", 
            RowBox[{"[", "iIter", "]"}], "]"}], "]"}], "^", "2"}]}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Square", " ", "Amplitude"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"OptionValue", "[", "List", "]"}], "\[Equal]", "True"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", "Diagonal", " ", "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"iMsqrd", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
            "iAmp", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
            "*", 
            RowBox[{"ComplexConjugate", "[", 
             RowBox[{
             "iAmp", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
             "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", 
             RowBox[{"Length", "[", "iAmp", "]"}]}], "}"}]}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{"Off", " ", "diagonals"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"iMsqrd", "=", 
         RowBox[{"Join", "[", 
          RowBox[{"iMsqrd", ",", 
           RowBox[{"Flatten", "[", 
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
               "iAmp", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}],
                "*", 
               RowBox[{"ComplexConjugate", "[", 
                RowBox[{
                "iAmp", "\[LeftDoubleBracket]", "j", 
                 "\[RightDoubleBracket]"}], "]"}]}], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", 
                RowBox[{
                 RowBox[{"Length", "[", "iAmp", "]"}], "-", "1"}]}], "}"}], 
              ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", 
                RowBox[{"i", "+", "1"}], ",", 
                RowBox[{"Length", "[", "iAmp", "]"}]}], "}"}]}], "]"}], 
            "]"}]}], "]"}]}], ";"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"iMsqrd", " ", "=", " ", 
         RowBox[{"iAmp", "*", 
          RowBox[{"ComplexConjugate", "[", "iAmp", "]"}]}]}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "If", " ", "any", " ", "of", " ", "the", " ", "states", " ", "are", 
        " ", "fermionic"}], ",", " ", 
       RowBox[{"average", " ", "their", " ", "spins"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"iFermionSpinSumPreFactor", "=", 
      RowBox[{"Times", "@@", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"IsFermion", "[", "#", "]"}], ",", 
            RowBox[{"1", "/", "2"}], ",", "1"}], "]"}], "&"}], ",", 
         "inStates"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"iDoFermionSpinSum", "=", 
      RowBox[{"AnyTrue", "[", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{"inStates", ",", "outStates"}], "]"}], ",", "IsFermion"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"If", "[", "\[IndentingNewLine]", 
      RowBox[{"iDoFermionSpinSum", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"OptionValue", "[", "List", "]"}], "\[Equal]", "True"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"iMsqrd", "=", 
            RowBox[{"Map", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"ReplaceAll", "[", 
                RowBox[{
                 RowBox[{"FermionSpinSum", "[", 
                  RowBox[{"#", ",", 
                   RowBox[{
                   "ExtraFactor", "->", "iFermionSpinSumPreFactor"}]}], "]"}],
                  ",", 
                 RowBox[{"DiracTrace", "\[Rule]", "TR"}]}], "]"}], "&"}], ",",
               "iMsqrd"}], "]"}]}], ";"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"iMsqrd", "=", 
            RowBox[{
             RowBox[{"FermionSpinSum", "[", 
              RowBox[{"iMsqrd", ",", 
               RowBox[{"ExtraFactor", "->", "iFermionSpinSumPreFactor"}]}], 
              "]"}], "/.", 
             RowBox[{"DiracTrace", "\[Rule]", "TR"}]}]}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
     ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "If", " ", "any", " ", "of", " ", "the", " ", "states", " ", "are", 
        " ", "vectors"}], ",", " ", 
       RowBox[{"average", " ", "polarizations"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Determine", " ", "if", " ", "polarization", " ", "sum", " ", "needs", 
       " ", "to", " ", "be", " ", "performed"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"iDoPolarizationSum", "=", 
      RowBox[{"AnyTrue", "[", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{"inStates", ",", "outStates"}], "]"}], ",", "IsVector"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"Determine", " ", "the", " ", "prefactor"}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"iPolarizationSumPreFactor", "=", 
      RowBox[{"Times", "@@", 
       RowBox[{"Map", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"IsVector", "[", "#", "]"}], ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"TheMass", "[", "#", "]"}], "===", "0"}], ",", 
              RowBox[{"1", "/", "2"}], ",", 
              RowBox[{"1", "/", "3"}]}], "]"}], ",", "1"}], "]"}], "&"}], ",",
          "inStates"}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "Determine", " ", "the", " ", "momenta", " ", "we", " ", "need", " ", 
       "to", " ", "do", " ", "polarization", " ", "sums", " ", "over"}], " ", 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"iPolarizationSumStateMomenta", "=", 
      RowBox[{"Cases", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"MapThread", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"List", "[", 
            RowBox[{"#1", ",", "#2"}], "]"}], "&"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Join", "[", 
             RowBox[{"inStates", ",", "outStates"}], "]"}], ",", 
            RowBox[{"Join", "[", 
             RowBox[{"iIncomingMomenta", ",", "iOutgoingMomenta"}], "]"}]}], 
           "}"}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"c_.", 
           RowBox[{"V", "[", "_", "]"}]}], ",", "_"}], "}"}]}], 
       "\[IndentingNewLine]", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"iMsqrd", "=", 
      RowBox[{"iPolarizationSumPreFactor", "*", "iMsqrd"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{"iDoPolarizationSum", ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"iIter", "=", "1"}], ",", 
          RowBox[{"iIter", "\[LessEqual]", 
           RowBox[{"Length", "[", "iPolarizationSumStateMomenta", "]"}]}], 
          ",", 
          RowBox[{"iIter", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"TheMass", "[", 
               RowBox[{"iPolarizationSumStateMomenta", "[", 
                RowBox[{"[", 
                 RowBox[{"iIter", ",", "1"}], "]"}], "]"}], "]"}], "===", 
              "0"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"iMsqrd", "=", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"OptionValue", "[", "List", "]"}], "\[Equal]", 
                  "True"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Map", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"DoPolarizationSums", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"iPolarizationSumStateMomenta", "[", 
                    RowBox[{"[", 
                    RowBox[{"iIter", ",", "2"}], "]"}], "]"}], ",", "0"}], 
                    "]"}], "&"}], ",", "iMsqrd"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"DoPolarizationSums", "[", 
                  RowBox[{"iMsqrd", ",", 
                   RowBox[{"iPolarizationSumStateMomenta", "[", 
                    RowBox[{"[", 
                    RowBox[{"iIter", ",", "2"}], "]"}], "]"}], ",", "0"}], 
                  "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"iMsqrd", "=", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"OptionValue", "[", "List", "]"}], "\[Equal]", 
                  "True"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"Map", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"DoPolarizationSums", "[", 
                    RowBox[{"#", ",", 
                    RowBox[{"iPolarizationSumStateMomenta", "[", 
                    RowBox[{"[", 
                    RowBox[{"iIter", ",", "2"}], "]"}], "]"}]}], "]"}], "&"}],
                    ",", "iMsqrd"}], "]"}], ",", "\[IndentingNewLine]", 
                 RowBox[{"DoPolarizationSums", "[", 
                  RowBox[{"iMsqrd", ",", 
                   RowBox[{"iPolarizationSumStateMomenta", "[", 
                    RowBox[{"[", 
                    RowBox[{"iIter", ",", "2"}], "]"}], "]"}]}], "]"}]}], 
                "\[IndentingNewLine]", "]"}]}], ";"}]}], 
            "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
         "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"OptionValue", "[", "List", "]"}], "\[Equal]", "True"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"iMsqrd", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"ReplaceAll", "[", 
             RowBox[{"#", ",", 
              RowBox[{
               RowBox[{"Den", "[", "a_", "]"}], "\[RuleDelayed]", 
               RowBox[{"1", "/", "a"}]}]}], "]"}], "&"}], ",", "iMsqrd"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"iMsqrd", "=", 
         RowBox[{"Map", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Simplify", "[", 
             RowBox[{"Contract", "[", "#", "]"}], "]"}], "&"}], ",", 
           "iMsqrd"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ClearScalarProducts", "[", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"Map", "[", 
          RowBox[{"CorrectParameters", ",", "iMsqrd"}], "]"}], "]"}], ";"}], 
       ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"iMsqrd", "=", 
         RowBox[{"Collect", "[", 
          RowBox[{
           RowBox[{"Contract", "[", "iMsqrd", "]"}], ",", 
           RowBox[{"Den", "[", "__", "]"}], ",", "Simplify"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"ClearScalarProducts", "[", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Return", "[", 
         RowBox[{"CorrectParameters", "[", "iMsqrd", "]"}], "]"}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.792512786711568*^9, 3.7925131160369177`*^9}, {
   3.792513158952623*^9, 3.7925133588165617`*^9}, {3.792513483604002*^9, 
   3.792513544653118*^9}, {3.792513588472753*^9, 3.792513781498431*^9}, {
   3.792513911153555*^9, 3.792514092561934*^9}, {3.7925144070738707`*^9, 
   3.7925144322378607`*^9}, {3.792514904950111*^9, 3.7925150424554043`*^9}, {
   3.792515074521001*^9, 3.792515250812908*^9}, 3.792515318467462*^9, {
   3.792515384920682*^9, 3.792515386875313*^9}, {3.792515421353636*^9, 
   3.792515440606113*^9}, {3.7925154836665783`*^9, 3.792515548003491*^9}, {
   3.792515609720984*^9, 3.792515618385775*^9}, {3.7925156744474688`*^9, 
   3.7925156971700087`*^9}, {3.792515728237021*^9, 3.7925157514685087`*^9}, {
   3.79251579350567*^9, 3.792515812780736*^9}, {3.792528121238415*^9, 
   3.792528122135248*^9}, {3.792691838638692*^9, 3.792692101811944*^9}, {
   3.792692140173452*^9, 3.792692316072113*^9}, {3.792692369330106*^9, 
   3.792692373051811*^9}, {3.792692417404215*^9, 3.792692432203064*^9}, {
   3.79269256244943*^9, 3.792692566079957*^9}, {3.792692673150278*^9, 
   3.792692715976215*^9}, {3.792692750652006*^9, 3.792692752595051*^9}, {
   3.79269308888475*^9, 3.792693354301895*^9}, {3.792694123413084*^9, 
   3.792694153371338*^9}, {3.7927019900033827`*^9, 3.792701993761426*^9}, {
   3.792702028101427*^9, 3.792702035560665*^9}, {3.7927021080974913`*^9, 
   3.79270214786108*^9}, {3.792702192733631*^9, 3.792702193880796*^9}, {
   3.792702235311535*^9, 3.792702236162875*^9}, 3.7927024368402243`*^9, {
   3.792702648541812*^9, 3.7927027013465967`*^9}},
 CellLabel->"In[42]:=",ExpressionUUID->"c1602ffd-0935-4fcd-917a-288958b812ef"]
}, Closed]],

Cell[CellGroupData[{

Cell["2->2 Cross Sections", "Subsection",
 CellChangeTimes->{{3.792516537667152*^9, 
  3.792516545471236*^9}},ExpressionUUID->"2cf03f8e-78ee-4b27-92aa-\
6e1fc8d87fa0"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "ComputeCrossSection22", "]"}], "=", 
   RowBox[{"DeleteCases", "[", 
    RowBox[{
     RowBox[{"Options", "[", "ComputeAmplitudeSquared", "]"}], ",", 
     RowBox[{
      RowBox[{"IncomingMomenta", "|", "OutgoingMomenta"}], "\[Rule]", 
      "__"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.792516556382388*^9, 3.79251656892701*^9}, {
  3.792517933305632*^9, 3.7925180100421658`*^9}},
 CellLabel->"In[43]:=",ExpressionUUID->"36824016-5c92-4a1f-81ce-a9e1ce4f580e"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ComputeCrossSection22", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"in1_", ",", "in2_"}], "}"}], "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"out1_", ",", "out2_"}], "}"}]}], ",", "Q_", ",", 
     RowBox[{"opt", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "iMsqrd", ",", "opts", ",", "iP1", ",", "iP2", ",", "iP3", ",", "iP4", 
       ",", "iM1", ",", "iM2", ",", "iM3", ",", "iM4", ",", "iS", ",", "iT", 
       ",", "iU", ",", "iE1", ",", "iE3", ",", "iPi", ",", "iPf", ",", 
       "iPreFactor", ",", "iTMin", ",", "iTMax"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ClearScalarProducts", "[", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"opts", "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{"List", "[", "opt", "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"IncomingMomenta", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"iP1", ",", "iP2"}], "}"}]}], ",", 
           RowBox[{"OutgoingMomenta", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"iP3", ",", "iP4"}], "}"}]}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"iMsqrd", "=", 
       RowBox[{"ComputeAmplitudeSquared", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"in1", ",", "in2"}], "}"}], "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"out1", ",", "out2"}], "}"}]}], ",", "opts"}], "]"}]}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"OptionValue", "[", "List", "]"}], "\[Equal]", "True"}], ",",
         "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"iMsqrd", "=", 
          RowBox[{"ParallelMap", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"ReplaceAll", "[", 
              RowBox[{
               RowBox[{"PropagatorDenominatorExplicit", "[", "#", "]"}], ",", 
               
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Den", "[", "a_", "]"}], "\[RuleDelayed]", 
                 RowBox[{"1", "/", "a"}]}], "}"}]}], "]"}], "&"}], ",", 
            "iMsqrd"}], "]"}]}], ";"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"iMsqrd", "=", 
          RowBox[{
           RowBox[{"PropagatorDenominatorExplicit", "[", "iMsqrd", "]"}], "/.", 
           RowBox[{
            RowBox[{"Den", "[", "a__", "]"}], "\[RuleDelayed]", 
            RowBox[{"1", "/", "a"}]}]}]}], ";"}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Extract", " ", "masses"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"iM1", " ", "=", " ", 
       RowBox[{"FeynArts`TheMass", "[", "in1", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"iM2", " ", "=", " ", 
       RowBox[{"FeynArts`TheMass", "[", "in2", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"iM3", " ", "=", " ", 
       RowBox[{"FeynArts`TheMass", "[", "out1", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"iM4", " ", "=", " ", 
       RowBox[{"FeynArts`TheMass", "[", "out2", "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Set", " ", "the", " ", "Mandelstam", " ", "variables"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"SetMandelstam", "[", 
       RowBox[{"iS", ",", "iT", ",", "iU", ",", "iP1", ",", "iP2", ",", 
        RowBox[{"-", "iP3"}], ",", 
        RowBox[{"-", "iP4"}], ",", "iM1", ",", "iM2", ",", "iM3", ",", 
        "iM4"}], "]"}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Remove", " ", "u"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"OptionValue", "[", "List", "]"}], "\[Equal]", "True"}], ",",
         "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"iMsqrd", "=", 
          RowBox[{"Map", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Simplify", "[", 
              RowBox[{"ReplaceAll", "[", 
               RowBox[{"#", ",", 
                RowBox[{"{", 
                 RowBox[{"iU", "\[Rule]", 
                  RowBox[{
                   SuperscriptBox["iM1", "2"], "+", 
                   SuperscriptBox["iM2", "2"], "+", 
                   SuperscriptBox["iM3", "2"], "+", 
                   SuperscriptBox["iM4", "2"], "-", "iS", "-", "iT"}]}], 
                 "}"}]}], "]"}], "]"}], "&"}], ",", "iMsqrd"}], "]"}]}], 
         ";"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"iMsqrd", "=", 
          RowBox[{
           RowBox[{"Simplify", "[", "iMsqrd", "]"}], "/.", 
           RowBox[{"{", 
            RowBox[{"iU", "\[Rule]", 
             RowBox[{
              SuperscriptBox["iM1", "2"], "+", 
              SuperscriptBox["iM2", "2"], "+", 
              SuperscriptBox["iM3", "2"], "+", 
              SuperscriptBox["iM4", "2"], "-", "iS", "-", "iT"}]}], "}"}]}]}],
          ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Compute", " ", "energies"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"iE1", "=", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"iS", "+", " ", 
          SuperscriptBox["iM1", "2"], " ", "-", 
          SuperscriptBox["iM2", "2"]}], ")"}], " ", "/", " ", 
        RowBox[{"(", 
         RowBox[{"2", " ", "*", " ", 
          RowBox[{"Sqrt", "[", "iS", "]"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"iE3", "=", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"iS", "+", " ", 
          SuperscriptBox["iM3", "2"], " ", "-", 
          SuperscriptBox["iM4", "2"]}], ")"}], " ", "/", " ", 
        RowBox[{"(", 
         RowBox[{"2", " ", "*", " ", 
          RowBox[{"Sqrt", "[", "iS", "]"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Compute", " ", "momenta"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"iPi", " ", "=", " ", 
       RowBox[{"Sqrt", "[", 
        RowBox[{
         SuperscriptBox["iE1", "2"], "-", 
         SuperscriptBox["iM1", "2"]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"iPf", " ", "=", " ", 
       RowBox[{"Sqrt", "[", 
        RowBox[{
         SuperscriptBox["iE3", "2"], "-", 
         SuperscriptBox["iM3", "2"]}], "]"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Compute", " ", "cross", " ", "section", " ", "prefactor"}], 
       " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"iPreFactor", "=", 
       RowBox[{"Simplify", "[", 
        RowBox[{
         FractionBox[
          RowBox[{"(", 
           RowBox[{"2", "\[Pi]"}], ")"}], 
          RowBox[{"64", 
           SuperscriptBox["\[Pi]", "2"], 
           SuperscriptBox["Q", "2"]}]], 
         RowBox[{"(", 
          FractionBox["iPf", "iPi"], ")"}], "*", 
         FractionBox["1", 
          RowBox[{"2", "*", "iPi", "*", "iPf"}]]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "if", " ", "final", " ", "states", " ", "are", " ", "identical"}], 
        ",", " ", 
        RowBox[{"divide", " ", "by", " ", "2"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"out1", "===", "out2"}], ",", 
        RowBox[{"iPreFactor", "=", 
         RowBox[{"iPreFactor", "/", "2"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Compute", " ", "bounds", " ", "on", " ", "t"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"iTMax", " ", "=", " ", 
       RowBox[{"Simplify", "[", 
        RowBox[{
         RowBox[{"iM1", "^", "2"}], " ", "+", " ", 
         RowBox[{"iM3", "^", "2"}], " ", "-", " ", 
         RowBox[{"2", "iE1", " ", "*", " ", "iE3"}], " ", "+", " ", 
         RowBox[{"2", " ", "*", " ", "iPi", " ", "*", " ", "iPf"}]}], "]"}]}],
       ";", "\[IndentingNewLine]", 
      RowBox[{"iTMin", " ", "=", " ", 
       RowBox[{"Simplify", "[", 
        RowBox[{
         RowBox[{"iM1", "^", "2"}], " ", "+", " ", 
         RowBox[{"iM3", "^", "2"}], " ", "-", " ", 
         RowBox[{"2", "iE1", " ", "*", " ", "iE3"}], " ", "-", " ", 
         RowBox[{"2", " ", "*", " ", "iPi", " ", "*", " ", "iPf"}]}], "]"}]}],
       ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Perform", " ", "integration"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"OptionValue", "[", "List", "]"}], "\[Equal]", "True"}], ",",
         "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Return", "[", 
          RowBox[{"ParallelMap", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"ReplaceAll", "[", 
              RowBox[{
               RowBox[{"iPreFactor", "*", 
                RowBox[{"Integrate", "[", 
                 RowBox[{
                  RowBox[{"CorrectParameters", "[", "#", "]"}], ",", 
                  RowBox[{"{", 
                   RowBox[{"iT", ",", "iTMin", ",", "iTMax"}], "}"}], ",", 
                  RowBox[{"GenerateConditions", "\[Rule]", "False"}]}], 
                 "]"}]}], ",", 
               RowBox[{"iS", "\[Rule]", 
                SuperscriptBox["Q", "2"]}]}], "]"}], "&"}], ",", "iMsqrd"}], 
           "]"}], "]"}], ";"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Return", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"iPreFactor", "*", 
             RowBox[{"Integrate", "[", 
              RowBox[{
               RowBox[{"CorrectParameters", "[", "iMsqrd", "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"iT", ",", "iTMin", ",", "iTMax"}], "}"}], ",", 
               RowBox[{"GenerateConditions", "\[Rule]", "False"}]}], "]"}]}], 
            ")"}], "/.", 
           RowBox[{"{", 
            RowBox[{"iS", "\[Rule]", 
             SuperscriptBox["Q", "2"]}], "}"}]}], "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.792516580664431*^9, 3.792516635937389*^9}, {
   3.792516683993243*^9, 3.7925166889273767`*^9}, {3.792516752776196*^9, 
   3.7925173217851963`*^9}, {3.792517361235256*^9, 3.792517520633472*^9}, {
   3.7925175678807783`*^9, 3.79251756807152*^9}, {3.792517634967306*^9, 
   3.792517640768825*^9}, {3.79251768692409*^9, 3.792517722237978*^9}, {
   3.7925177746555157`*^9, 3.792517857290509*^9}, {3.7925180265896072`*^9, 
   3.792518098646984*^9}, {3.792518137949156*^9, 3.792518146908785*^9}, {
   3.7925182261742563`*^9, 3.792518253480616*^9}, {3.792518312646138*^9, 
   3.792518356012765*^9}, {3.792518393255679*^9, 3.792518397366006*^9}, {
   3.79251847308144*^9, 3.792518473408928*^9}, {3.7925249372117367`*^9, 
   3.792525002295293*^9}, {3.792525046014892*^9, 3.792525151803855*^9}, {
   3.792525189816386*^9, 3.792525241747096*^9}, {3.792525336249102*^9, 
   3.792525378726364*^9}, {3.7925255474915752`*^9, 3.792525561800684*^9}, {
   3.792526508515414*^9, 3.792526568118655*^9}, 3.79252660177677*^9, {
   3.7925270556653357`*^9, 3.79252705908736*^9}, {3.792527191242199*^9, 
   3.792527194105151*^9}, {3.792528130782352*^9, 3.792528133015085*^9}, {
   3.792528199336226*^9, 3.792528219018108*^9}, {3.7926934498228617`*^9, 
   3.792693718862529*^9}, {3.7926937847811813`*^9, 3.7926938141238537`*^9}, {
   3.792693888404759*^9, 3.792693947300928*^9}, {3.792694036780757*^9, 
   3.792694058812722*^9}, {3.792694088825246*^9, 3.792694091015826*^9}, 
   3.7926941632884493`*^9, {3.792802746922565*^9, 3.792802747100197*^9}},
 CellLabel->"In[44]:=",ExpressionUUID->"d9dfd925-4898-4923-afa5-82e44ecc3b81"],

Cell[BoxData[
 RowBox[{"(*", "\[IndentingNewLine]", 
  RowBox[{"\[Sigma]", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"ComputeCrossSection22", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"F", "[", 
           RowBox[{"1", ",", 
            RowBox[{"{", "1", "}"}]}], "]"}], ",", 
          RowBox[{"-", 
           RowBox[{"F", "[", 
            RowBox[{"1", ",", 
             RowBox[{"{", "1", "}"}]}], "]"}]}]}], "}"}], "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"V", "[", "1", "]"}], ",", 
          RowBox[{"V", "[", "1", "]"}]}], "}"}]}], ",", "Q", ",", 
       RowBox[{"Model", "\[Rule]", "\"\<QED\>\""}], ",", 
       RowBox[{"Paint", "\[Rule]", "True"}], ",", 
       RowBox[{"DiagramExtract", "\[Rule]", 
        RowBox[{"{", "2", "}"}]}]}], "]"}], "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"FCGV", "[", "\"\<ME\>\"", "]"}], "\[Rule]", 
        RowBox[{"SMP", "[", "\"\<m_e\>\"", "]"}]}], ",", 
       RowBox[{
        RowBox[{"FCGV", "[", "\"\<EL\>\"", "]"}], "\[Rule]", 
        SqrtBox[
         RowBox[{"4", "\[Pi]", " ", "\[Alpha]"}]]}]}], "}"}]}], "//", 
    "Simplify"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  "*)"}]], "Input",
 CellChangeTimes->{{3.7925175315876827`*^9, 3.792517554798664*^9}, {
   3.792517744466482*^9, 3.792517747303361*^9}, {3.792518114042234*^9, 
   3.7925181176244497`*^9}, {3.792518194416857*^9, 3.7925181972577877`*^9}, 
   3.792518408294273*^9, {3.792525418539394*^9, 3.792525422461116*^9}, 
   3.792526611451775*^9, {3.792526984506339*^9, 3.792526995072385*^9}, {
   3.792527212023127*^9, 3.7925272121418743`*^9}, {3.7925276859739*^9, 
   3.792527690155422*^9}},
 CellLabel->"In[45]:=",ExpressionUUID->"44fc091c-7853-4374-bc25-e114baebaa7b"]
}, Closed]],

Cell[CellGroupData[{

Cell["Widths", "Subsection",
 CellChangeTimes->{{3.7925466173236647`*^9, 
  3.792546618205076*^9}},ExpressionUUID->"ea7a6196-a87e-4041-a207-\
761fa94a2c0c"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "ComputeWidth", "]"}], "=", 
   RowBox[{"DeleteCases", "[", 
    RowBox[{
     RowBox[{"Options", "[", "ComputeAmplitudeSquared", "]"}], ",", 
     RowBox[{
      RowBox[{"IncomingMomenta", "|", "OutgoingMomenta"}], "\[Rule]", 
      "__"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.792546823124967*^9, 3.792546824995138*^9}, {
  3.7925468582824593`*^9, 3.79254686003141*^9}},
 CellLabel->"In[46]:=",ExpressionUUID->"832d8b8a-ff7e-4c6f-9358-066dfba5e31a"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ComputeWidth", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", "inState_", "}"}], "->", 
      RowBox[{"{", 
       RowBox[{"outState1_", ",", "outState2_"}], "}"}]}], ",", " ", 
     RowBox[{"opt", ":", 
      RowBox[{"OptionsPattern", "[", "]"}]}]}], "]"}], " ", ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "msqrd", ",", " ", "P", ",", " ", "p1", ",", " ", "p2", ",", " ", "M", 
       ",", " ", "m1", ",", " ", "m2", ",", " ", "pf", ",", " ", "preFactor", 
       ",", " ", "E1", ",", " ", "E2", ",", "opts"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"ClearScalarProducts", "[", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"opts", "=", 
       RowBox[{"Join", "[", 
        RowBox[{
         RowBox[{"Flatten", "[", 
          RowBox[{"List", "[", "opt", "]"}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"IncomingMomenta", "\[Rule]", 
            RowBox[{"{", "P", "}"}]}], ",", 
           RowBox[{"OutgoingMomenta", "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"p1", ",", "p2"}], "}"}]}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"msqrd", "=", 
       RowBox[{
        RowBox[{"PropagatorDenominatorExplicit", "[", 
         RowBox[{"ComputeAmplitudeSquared", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"{", "inState", "}"}], "\[Rule]", 
            RowBox[{"{", 
             RowBox[{"outState1", ",", "outState2"}], "}"}]}], ",", "opts"}], 
          "]"}], "]"}], "/.", 
        RowBox[{
         RowBox[{"Den", "[", "a__", "]"}], "\[RuleDelayed]", 
         RowBox[{"1", "/", "a"}]}]}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"M", " ", "=", " ", 
       RowBox[{"FeynArts`TheMass", "[", "inState", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"m1", " ", "=", " ", 
       RowBox[{"FeynArts`TheMass", "[", "outState1", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"m2", " ", "=", " ", 
       RowBox[{"FeynArts`TheMass", "[", "outState2", "]"}]}], ";", "\n", 
      "\[IndentingNewLine]", 
      RowBox[{"E1", " ", "=", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"M", "^", "2"}], " ", "+", " ", 
          RowBox[{"m1", "^", "2"}], " ", "-", " ", 
          RowBox[{"m2", "^", "2"}]}], ")"}], " ", "/", " ", 
        RowBox[{"(", 
         RowBox[{"2", " ", "*", " ", "M"}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"E2", " ", "=", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"M", "^", "2"}], " ", "-", " ", 
          RowBox[{"m1", "^", "2"}], " ", "+", " ", 
          RowBox[{"m2", "^", "2"}]}], ")"}], " ", "/", " ", 
        RowBox[{"(", 
         RowBox[{"2", " ", "*", " ", "M"}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"FeynCalc`SP", "[", 
        RowBox[{"P", ",", " ", "P"}], "]"}], " ", "=", " ", 
       RowBox[{"M", "^", "2"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"FeynCalc`SP", "[", 
        RowBox[{"p1", ",", " ", "p1"}], "]"}], " ", "=", " ", 
       RowBox[{"m1", "^", "2"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"FeynCalc`SP", "[", 
        RowBox[{"p2", ",", " ", "p2"}], "]"}], " ", "=", " ", 
       RowBox[{"m2", "^", "2"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"FeynCalc`SP", "[", 
        RowBox[{"P", ",", " ", "p1"}], "]"}], " ", "=", " ", 
       RowBox[{"M", " ", "*", " ", "E1"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"FeynCalc`SP", "[", 
        RowBox[{"P", ",", " ", "p2"}], "]"}], " ", "=", " ", 
       RowBox[{"M", " ", "*", " ", "E2"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"FeynCalc`SP", "[", 
        RowBox[{"p1", ",", " ", "p2"}], "]"}], " ", "=", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"M", "^", "2"}], " ", "-", " ", 
          RowBox[{"m1", "^", "2"}], " ", "-", " ", 
          RowBox[{"m2", "^", "2"}]}], ")"}], " ", "/", " ", "2"}]}], ";", 
      "\n", "\[IndentingNewLine]", 
      RowBox[{"msqrd", " ", "=", " ", 
       RowBox[{"Simplify", "[", "msqrd", "]"}]}], ";", "\n", 
      "\[IndentingNewLine]", 
      RowBox[{"pf", " ", "=", " ", 
       RowBox[{"Sqrt", "[", 
        RowBox[{
         RowBox[{"E1", "^", "2"}], " ", "-", " ", 
         RowBox[{"m1", "^", "2"}]}], "]"}]}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"mag", ".", " ", "of"}], " ", "final", " ", "state", " ", 
         "3"}], "-", "momentum"}], " ", "*)"}], "\n", "\[IndentingNewLine]", 
      RowBox[{"preFactor", " ", "=", " ", 
       RowBox[{"Simplify", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"4", " ", "*", " ", "\[Pi]"}], ")"}], " ", "/", " ", 
          RowBox[{"(", 
           RowBox[{"2", " ", "*", " ", "M"}], ")"}]}], " ", "*", " ", 
         RowBox[{"pf", " ", "/", " ", 
          RowBox[{"(", 
           RowBox[{"16", " ", "*", " ", 
            RowBox[{"Pi", "^", "2"}], " ", "*", " ", "M"}], ")"}]}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{
        "If", " ", "final", " ", "state", " ", "particles", " ", "are", " ", 
         "identical"}], ",", " ", 
        RowBox[{"divide", " ", "by", " ", "2"}]}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"preFactor", " ", "*=", " ", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"outState1", " ", "===", "outState2"}], ",", " ", 
         RowBox[{"1", " ", "/", " ", "2"}], ",", " ", "1"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"preFactor", " ", "*", " ", "msqrd"}]}]}], "\n", "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.79254665940403*^9, 3.792546818595477*^9}, {
  3.7925469008644*^9, 3.7925469410021877`*^9}, {3.792702299061926*^9, 
  3.792702300074703*^9}},
 CellLabel->"In[47]:=",ExpressionUUID->"97e68c27-0d9a-4c6f-9bfd-91befc47936c"]
}, Closed]],

Cell[CellGroupData[{

Cell["Set default options", "Subsection",
 CellChangeTimes->{{3.792845698465539*^9, 
  3.792845703174765*^9}},ExpressionUUID->"1fc64e9b-314d-4af4-971d-\
cf636371d9c8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"GenerateDiagrams", ",", 
    RowBox[{"Model", "\[Rule]", "model"}], ",", 
    RowBox[{"GenericModel", "->", "genericModel"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"ComputeAmplitude", ",", 
    RowBox[{"Model", "\[Rule]", "model"}], ",", 
    RowBox[{"GenericModel", "->", "genericModel"}], ",", 
    RowBox[{"FinalSubstitutions", "\[Rule]", 
     RowBox[{"{", "}"}]}], ",", 
    RowBox[{"DropSumOver", "\[Rule]", "True"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"ComputeAmplitudeSquared", ",", 
    RowBox[{"Model", "\[Rule]", "model"}], ",", 
    RowBox[{"GenericModel", "->", "genericModel"}], ",", 
    RowBox[{"FinalSubstitutions", "\[Rule]", 
     RowBox[{"{", "}"}]}], ",", 
    RowBox[{"DropSumOver", "\[Rule]", "True"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"ComputeCrossSection22", ",", 
    RowBox[{"Model", "\[Rule]", "model"}], ",", 
    RowBox[{"GenericModel", "->", "genericModel"}], ",", 
    RowBox[{"FinalSubstitutions", "\[Rule]", 
     RowBox[{"{", "}"}]}], ",", 
    RowBox[{"DropSumOver", "\[Rule]", "True"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"ComputeWidth", ",", 
    RowBox[{"Model", "\[Rule]", "model"}], ",", 
    RowBox[{"GenericModel", "->", "genericModel"}], ",", 
    RowBox[{"FinalSubstitutions", "\[Rule]", 
     RowBox[{"{", "}"}]}], ",", 
    RowBox[{"DropSumOver", "\[Rule]", "True"}]}], "]"}], ";"}]}], "Input",
 CellLabel->"In[48]:=",ExpressionUUID->"e06a410e-2882-40c0-92e9-7d4b9501b69b"]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Cross Section", "Section",
 CellChangeTimes->{{3.792444533397756*^9, 3.79244453867057*^9}, {
  3.792843184198594*^9, 
  3.79284318751257*^9}},ExpressionUUID->"1258ea4a-ffa0-415d-b090-\
bb39ceb96fc1"],

Cell[BoxData[
 RowBox[{"CrossSectionXLtoXL2", "=", 
  RowBox[{
   RowBox[{"CrossSectionXLtoXL", "//.", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"c1_.", 
         RowBox[{"Log", "[", "a_", "]"}]}], "+", 
        RowBox[{"c1_.", 
         RowBox[{"Log", "[", "b_", "]"}]}]}], ":>", 
       RowBox[{"c1", "*", 
        RowBox[{"Log", "[", 
         RowBox[{"a", "*", "b"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"c1_.", 
         RowBox[{"Log", "[", "a_", "]"}]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"-", "c1_."}], ")"}], 
         RowBox[{"Log", "[", "b_", "]"}]}]}], ":>", 
       RowBox[{"c1", "*", 
        RowBox[{"Log", "[", 
         RowBox[{"a", "/", "b"}], "]"}]}]}]}], "\[IndentingNewLine]", "}"}]}],
    "//", 
   RowBox[{
    RowBox[{"FullSimplify", "[", 
     RowBox[{"#", ",", 
      RowBox[{"Assumptions", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"Q", ">", 
         RowBox[{"mx", "+", "ml"}], ">", "0"}], "}"}]}]}], "]"}], 
    "&"}]}]}]], "Input",ExpressionUUID->"99e28112-5c23-4a4a-b711-\
cd5fccffbe9c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearScalarProducts", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"p1", ",", "p2", ",", "p3", ",", "p4"}], "]"}], ";"}]}], "Input",
 CellLabel->"In[53]:=",ExpressionUUID->"6f157b0e-436d-44d1-ad5a-1d7eefcfae0e"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"AmpSquared", "=", 
   RowBox[{"ComputeAmplitudeSquared", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"DarkMatter", ",", "Lepton"}], "}"}], "->", 
      RowBox[{"{", 
       RowBox[{"DarkMatter", ",", "Lepton"}], "}"}]}], ",", 
     RowBox[{"IncomingMomenta", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"p1", ",", "p2"}], "}"}]}], ",", 
     RowBox[{"OutgoingMomenta", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"p3", ",", "p4"}], "}"}]}], ",", 
     RowBox[{"List", "\[Rule]", "False"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetMandelstam", "[", 
   RowBox[{"s", ",", "t", ",", "u", ",", "p1", ",", "p2", ",", 
    RowBox[{"-", "p3"}], ",", 
    RowBox[{"-", "p4"}], ",", "mx", ",", "ml", ",", "mx", ",", "ml"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AmpSquared", "=", 
   RowBox[{"AmpSquared", "/.", 
    RowBox[{
     RowBox[{"Den", "[", "a_", "]"}], "\[RuleDelayed]", 
     RowBox[{"1", "/", 
      RowBox[{"Collect", "[", 
       RowBox[{"a", ",", "t", ",", "Simplify"}], "]"}]}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AmpSquared", "=", 
   RowBox[{"(", 
    RowBox[{"AmpSquared", "/.", 
     RowBox[{"u", "\[Rule]", 
      RowBox[{
       RowBox[{"2", 
        SuperscriptBox["mx", "2"]}], "+", 
       RowBox[{"2", 
        SuperscriptBox["ml", "2"]}], "-", "s", "-", "t"}]}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"AmpSquared", "=", 
  RowBox[{
   RowBox[{"Collect", "[", 
    RowBox[{
     RowBox[{"Numerator", "[", "AmpSquared", "]"}], ",", "t", ",", 
     "Simplify"}], "]"}], "/", 
   RowBox[{"Denominator", "[", "AmpSquared", "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.792843190579608*^9, 3.792843500335122*^9}, {
  3.792845587114358*^9, 3.792845588466024*^9}},
 CellLabel->"In[56]:=",ExpressionUUID->"04e9bbf6-083c-4bdd-a1ef-1463ce51c0b7"],

Cell[BoxData[
 FormBox[
  FractionBox[
   RowBox[{
    RowBox[{"4", " ", 
     SuperscriptBox["gvll", "2"], " ", 
     SuperscriptBox["gvxx", "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["ml", "2"], "+", 
        SuperscriptBox["mx", "2"], "-", "s"}], ")"}], "2"]}], "+", 
    RowBox[{"4", " ", 
     SuperscriptBox["gvll", "2"], " ", 
     SuperscriptBox["gvxx", "2"], " ", "s", " ", "t"}], "+", 
    RowBox[{"2", " ", 
     SuperscriptBox["gvll", "2"], " ", 
     SuperscriptBox["gvxx", "2"], " ", 
     SuperscriptBox["t", "2"]}]}], 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"2", " ", 
      SuperscriptBox["mv", "2"], " ", "t"}]}], "+", 
    RowBox[{
     SuperscriptBox["mv", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["mv", "2"], "+", 
       SuperscriptBox["widthv", "2"]}], ")"}]}], "+", 
    SuperscriptBox["t", "2"]}]], TraditionalForm]], "Output",
 CellChangeTimes->{3.792845868454577*^9},
 CellLabel->"Out[60]=",ExpressionUUID->"767f8798-027f-4e5d-943d-46ae16111b2f"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Metric", "=", 
   RowBox[{"DiagonalMatrix", "[", 
    RowBox[{"{", 
     RowBox[{"1", ",", 
      RowBox[{"-", "1"}], ",", 
      RowBox[{"-", "1"}], ",", 
      RowBox[{"-", "1"}]}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"P1", "=", 
   RowBox[{"{", 
    RowBox[{"Ei", ",", "0", ",", "0", ",", "p"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"P2", "=", 
   RowBox[{"{", 
    RowBox[{"ml", ",", "0", ",", "0", ",", "0"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"P3", "=", 
   RowBox[{"{", 
    RowBox[{"E3", ",", 
     RowBox[{
      RowBox[{"-", "pf"}], "*", 
      SqrtBox[
       RowBox[{"1", "-", 
        SuperscriptBox["z", "2"]}]]}], ",", "0", ",", 
     RowBox[{"p", "-", 
      RowBox[{"pf", "*", "z"}]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"P4", "=", 
   RowBox[{"{", 
    RowBox[{"Ef", ",", 
     RowBox[{"pf", "*", 
      SqrtBox[
       RowBox[{"1", "-", 
        SuperscriptBox["z", "2"]}]]}], ",", "0", ",", 
     RowBox[{"pf", "*", "z"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"P1", "=", 
   RowBox[{"P1", "/.", 
    RowBox[{"{", 
     RowBox[{"p", "\[Rule]", 
      SqrtBox[
       RowBox[{
        SuperscriptBox["Ei", "2"], "-", 
        SuperscriptBox["mx", "2"]}]]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"P3", "=", 
   RowBox[{"P3", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"pf", "\[Rule]", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["Ef", "2"], "-", 
         SuperscriptBox["ml", "2"]}]]}], ",", 
      RowBox[{"p", "\[Rule]", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["Ei", "2"], "-", 
         SuperscriptBox["mx", "2"]}]]}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"P4", "=", 
   RowBox[{"P4", "/.", 
    RowBox[{"{", 
     RowBox[{"pf", "\[Rule]", 
      SqrtBox[
       RowBox[{
        SuperscriptBox["Ef", "2"], "-", 
        SuperscriptBox["ml", "2"]}]]}], "}"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7928435478981647`*^9, 3.7928436399965477`*^9}, {
  3.7928436817830267`*^9, 3.792843698476881*^9}, {3.792843790998815*^9, 
  3.7928438351757107`*^9}, {3.792844170514224*^9, 3.792844170830888*^9}, {
  3.7928444882012243`*^9, 3.792844488511537*^9}},
 CellLabel->"In[61]:=",ExpressionUUID->"5fd23a3b-c9fe-44e7-908f-783120e6d00d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AmpSquaredElectronRF", "=", 
  RowBox[{"AmpSquared", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"t", "\[Rule]", 
      RowBox[{"Dot", "[", 
       RowBox[{
        RowBox[{"P2", "-", "P4"}], ",", "Metric", ",", 
        RowBox[{"P2", "-", "P4"}]}], "]"}]}], ",", 
     RowBox[{"s", "\[Rule]", 
      RowBox[{"Dot", "[", 
       RowBox[{
        RowBox[{"P1", "+", "P2"}], ",", "Metric", ",", 
        RowBox[{"P1", "+", "P2"}]}], "]"}]}]}], "}"}]}]}]], "Input",
 CellChangeTimes->{{3.792843670004365*^9, 3.792843753197481*^9}},
 CellLabel->"In[69]:=",ExpressionUUID->"17d1be74-4aa7-45b6-abe4-ad83ba86239b"],

Cell[BoxData[
 FormBox[
  FractionBox[
   RowBox[{
    RowBox[{"4", " ", 
     SuperscriptBox["gvll", "2"], " ", 
     SuperscriptBox["gvxx", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{
         SuperscriptBox["z", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["Ef", "2"], "-", 
           SuperscriptBox["ml", "2"]}], ")"}]}]}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", 
          SuperscriptBox["z", "2"]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["Ef", "2"], "-", 
          SuperscriptBox["ml", "2"]}], ")"}]}], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"ml", "-", "Ef"}], ")"}], "2"]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["Ei", "2"]}], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"Ei", "+", "ml"}], ")"}], "2"], "+", 
       SuperscriptBox["mx", "2"]}], ")"}]}], "+", 
    RowBox[{"2", " ", 
     SuperscriptBox["gvll", "2"], " ", 
     SuperscriptBox["gvxx", "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{
          SuperscriptBox["z", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["Ef", "2"], "-", 
            SuperscriptBox["ml", "2"]}], ")"}]}]}], "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           SuperscriptBox["z", "2"]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["Ef", "2"], "-", 
           SuperscriptBox["ml", "2"]}], ")"}]}], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"ml", "-", "Ef"}], ")"}], "2"]}], ")"}], "2"]}], "+", 
    RowBox[{"4", " ", 
     SuperscriptBox["gvll", "2"], " ", 
     SuperscriptBox["gvxx", "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["Ei", "2"], "-", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"Ei", "+", "ml"}], ")"}], "2"], "+", 
        SuperscriptBox["ml", "2"]}], ")"}], "2"]}]}], 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"2", " ", 
      SuperscriptBox["mv", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{
          SuperscriptBox["z", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["Ef", "2"], "-", 
            SuperscriptBox["ml", "2"]}], ")"}]}]}], "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           SuperscriptBox["z", "2"]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["Ef", "2"], "-", 
           SuperscriptBox["ml", "2"]}], ")"}]}], "+", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"ml", "-", "Ef"}], ")"}], "2"]}], ")"}]}]}], "+", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{
         SuperscriptBox["z", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["Ef", "2"], "-", 
           SuperscriptBox["ml", "2"]}], ")"}]}]}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", 
          SuperscriptBox["z", "2"]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["Ef", "2"], "-", 
          SuperscriptBox["ml", "2"]}], ")"}]}], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"ml", "-", "Ef"}], ")"}], "2"]}], ")"}], "2"], "+", 
    RowBox[{
     SuperscriptBox["mv", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["mv", "2"], "+", 
       SuperscriptBox["widthv", "2"]}], ")"}]}]}]], 
  TraditionalForm]], "Output",
 CellChangeTimes->{{3.792843729086507*^9, 3.792843753681982*^9}, {
   3.7928438191357403`*^9, 3.792843842611362*^9}, 3.792844174424506*^9, 
   3.792844492490308*^9, 3.792845011654068*^9, 3.7928453303836203`*^9, 
   3.792845877299797*^9},
 CellLabel->"Out[69]=",ExpressionUUID->"b632b787-f451-45f8-8ac1-0dbe8630673d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"AmpSquaredElectronRF", "=", 
  RowBox[{
   RowBox[{"Collect", "[", 
    RowBox[{
     RowBox[{"Numerator", "[", "AmpSquaredElectronRF", "]"}], ",", "Ef", ",", 
     "Simplify"}], "]"}], "/", 
   RowBox[{"Collect", "[", 
    RowBox[{
     RowBox[{"Denominator", "[", "AmpSquaredElectronRF", "]"}], ",", "Ef", 
     ",", "Simplify"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.7928437644263687`*^9, 3.792843781875658*^9}, {
  3.792843840713876*^9, 3.792843868922278*^9}},
 CellLabel->"In[70]:=",ExpressionUUID->"d939965d-a821-481c-b0df-059df1cd11f7"],

Cell[BoxData[
 FormBox[
  FractionBox[
   RowBox[{
    RowBox[{"8", " ", 
     SuperscriptBox["Ef", "2"], " ", 
     SuperscriptBox["gvll", "2"], " ", 
     SuperscriptBox["gvxx", "2"], " ", 
     SuperscriptBox["ml", "2"]}], "-", 
    RowBox[{"8", " ", "Ef", " ", 
     SuperscriptBox["gvll", "2"], " ", 
     SuperscriptBox["gvxx", "2"], " ", "ml", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "Ei", " ", "ml"}], "+", 
       RowBox[{"3", " ", 
        SuperscriptBox["ml", "2"]}], "+", 
       SuperscriptBox["mx", "2"]}], ")"}]}], "+", 
    RowBox[{"8", " ", 
     SuperscriptBox["gvll", "2"], " ", 
     SuperscriptBox["gvxx", "2"], " ", 
     SuperscriptBox["ml", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", 
        SuperscriptBox["Ei", "2"]}], "+", 
       RowBox[{"2", " ", "Ei", " ", "ml"}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["ml", "2"]}], "+", 
       SuperscriptBox["mx", "2"]}], ")"}]}]}], 
   RowBox[{
    RowBox[{"4", " ", 
     SuperscriptBox["Ef", "2"], " ", 
     SuperscriptBox["ml", "2"]}], "+", 
    RowBox[{"Ef", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"4", " ", "ml", " ", 
        SuperscriptBox["mv", "2"]}], "-", 
       RowBox[{"8", " ", 
        SuperscriptBox["ml", "3"]}]}], ")"}]}], "+", 
    RowBox[{"4", " ", 
     SuperscriptBox["ml", "4"]}], "-", 
    RowBox[{"4", " ", 
     SuperscriptBox["ml", "2"], " ", 
     SuperscriptBox["mv", "2"]}], "+", 
    SuperscriptBox["mv", "4"], "+", 
    RowBox[{
     SuperscriptBox["mv", "2"], " ", 
     SuperscriptBox["widthv", "2"]}]}]], TraditionalForm]], "Output",
 CellChangeTimes->{{3.792843777753881*^9, 3.792843782603879*^9}, {
   3.7928438443672247`*^9, 3.792843869461224*^9}, 3.792844184884575*^9, 
   3.792844493329273*^9, 3.7928450133080263`*^9, 3.792845331402027*^9, 
   3.792845879507259*^9},
 CellLabel->"Out[70]=",ExpressionUUID->"a0623dba-5572-4aab-aff2-ac27d48f29c9"]
}, Open  ]],

Cell[BoxData[
 FormBox[
  RowBox[{
   FractionBox[
    RowBox[{
     SuperscriptBox["\[DifferentialD]", "3"], 
     SubscriptBox["p", "3"]}], 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"2", "\[Pi]"}], ")"}], "3"], "2", 
     SubscriptBox["E", "3"]}]], 
   FractionBox[
    RowBox[{
     SuperscriptBox["\[DifferentialD]", "3"], 
     SubscriptBox["p", "4"]}], 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"2", "\[Pi]"}], ")"}], "3"], "2", 
     SubscriptBox["E", "f"]}]], 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"2", "\[Pi]"}], ")"}], "4"], 
   RowBox[{
    SuperscriptBox["\[Delta]", "4"], "(", 
    RowBox[{"P", "-", 
     SubscriptBox["p", "3"], "-", 
     SubscriptBox["p", "4"]}], ")"}], 
   RowBox[{"F", "[", 
    SubscriptBox["E", "f"], "]"}]}], TraditionalForm]], "DisplayFormula",
 CellChangeTimes->{{3.79284404116891*^9, 
  3.792844111387329*^9}},ExpressionUUID->"ec2410f0-cec7-4a26-bc98-\
3f1b714f51db"],

Cell[BoxData[
 FormBox[
  RowBox[{
   FractionBox["1", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"2", "\[Pi]"}], ")"}], "3"], "2", 
     SubscriptBox["E", "3"]}]], 
   FractionBox[
    RowBox[{
     RowBox[{"\[DifferentialD]", "\[CapitalOmega]"}], " ", 
     SuperscriptBox[
      SubscriptBox["p", "4"], "2"], 
     RowBox[{"\[DifferentialD]", 
      SubscriptBox["p", "4"]}]}], 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"2", "\[Pi]"}], ")"}], "3"], "2", 
     SubscriptBox["E", "f"]}]], 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"2", "\[Pi]"}], ")"}], "4"], 
   RowBox[{"\[Delta]", "(", 
    RowBox[{
     SubscriptBox["E", "i"], "+", 
     SubscriptBox["m", "e"], "-", 
     SubscriptBox["E", "3"], "-", 
     SubscriptBox["E", "f"]}], ")"}], 
   RowBox[{"F", "[", 
    SubscriptBox["E", "f"], "]"}]}], TraditionalForm]], "DisplayFormula",
 CellChangeTimes->{{3.79284404116891*^9, 3.792844147175596*^9}, {
  3.792844216197455*^9, 
  3.7928442307479258`*^9}},ExpressionUUID->"2f18903f-2d18-4153-af17-\
66cab83105a7"],

Cell[BoxData[
 FormBox[
  RowBox[{
   FractionBox["1", 
    RowBox[{"4", 
     SuperscriptBox[
      RowBox[{
       SubscriptBox["E", "3"], "(", 
       RowBox[{"2", "\[Pi]"}], ")"}], "2"]}]], 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"\[DifferentialD]", "\[CapitalOmega]"}], " ", 
     SqrtBox[
      RowBox[{
       SubscriptBox["E", "f"], "-", 
       SuperscriptBox[
        SubscriptBox["m", "e"], "2"]}]], 
     RowBox[{"\[DifferentialD]", 
      SubscriptBox["E", "f"]}]}], ")"}], 
   RowBox[{"\[Delta]", "(", 
    RowBox[{
     SubscriptBox["E", "i"], "+", 
     SubscriptBox["m", "e"], "-", 
     RowBox[{
      SubscriptBox["E", "3"], "[", 
      RowBox[{
       SubscriptBox["E", "f"], ",", "z"}], "]"}], "-", 
     SubscriptBox["E", "f"]}], ")"}], 
   RowBox[{"F", "[", 
    SubscriptBox["E", "f"], "]"}]}], TraditionalForm]], "DisplayFormula",
 CellChangeTimes->{{3.79284404116891*^9, 3.792844147175596*^9}, {
  3.792844216197455*^9, 3.7928442307479258`*^9}, {3.792844312932617*^9, 
  3.792844360629485*^9}, {3.792844633423099*^9, 
  3.7928446375949097`*^9}},ExpressionUUID->"5080b822-7ef9-4e5f-990c-\
4263d4dbf111"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"E3", "=", 
  RowBox[{"Sqrt", "[", 
   RowBox[{
    RowBox[{"Collect", "[", 
     RowBox[{
      RowBox[{"Dot", "[", 
       RowBox[{
        RowBox[{"P3", "\[LeftDoubleBracket]", 
         RowBox[{"2", ";;"}], "\[RightDoubleBracket]"}], ",", 
        RowBox[{"P3", "\[LeftDoubleBracket]", 
         RowBox[{"2", ";;"}], "\[RightDoubleBracket]"}]}], "]"}], ",", "Ef", 
      ",", "Simplify"}], "]"}], "+", 
    SuperscriptBox["mx", "2"]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.792844520854303*^9, 3.7928446196103*^9}},
 CellLabel->"In[71]:=",ExpressionUUID->"2328cd10-20c6-440f-9307-308a555f0465"],

Cell[BoxData[
 FormBox[
  SqrtBox[
   RowBox[{
    RowBox[{"-", 
     RowBox[{"2", " ", "z", " ", 
      SqrtBox[
       RowBox[{
        SuperscriptBox["Ef", "2"], "-", 
        SuperscriptBox["ml", "2"]}]], " ", 
      SqrtBox[
       RowBox[{
        SuperscriptBox["Ei", "2"], "-", 
        SuperscriptBox["mx", "2"]}]]}]}], "+", 
    SuperscriptBox["Ef", "2"], "+", 
    SuperscriptBox["Ei", "2"], "-", 
    SuperscriptBox["ml", "2"]}]], TraditionalForm]], "Output",
 CellChangeTimes->{{3.7928445266674843`*^9, 3.792844620070915*^9}, 
   3.79284501702101*^9, 3.792845333918812*^9, 3.79284588273667*^9},
 CellLabel->"Out[71]=",ExpressionUUID->"53067eff-b160-49b2-b7b0-d0199d77909e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"intDiracDelta", "=", 
  RowBox[{"Integrate", "[", 
   RowBox[{
    RowBox[{
     FractionBox["1", "E3"], 
     RowBox[{"DiracDelta", "[", 
      RowBox[{"Ei", "+", "ml", "-", "E3", "-", "Ef"}], "]"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"z", ",", 
      RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
    RowBox[{"GenerateConditions", "\[Rule]", "False"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.792848675949141*^9, 3.7928487548646107`*^9}, {
  3.79284882924212*^9, 3.7928488321386347`*^9}, {3.792848994890851*^9, 
  3.792848995072713*^9}},
 CellLabel->
  "In[122]:=",ExpressionUUID->"297a87c3-273a-4861-bcc5-d805d05d8d5f"],

Cell[BoxData[
 FormBox[
  FractionBox[
   RowBox[{
    TemplateBox[{RowBox[{
        RowBox[{"Ef", "-", "Ei", "-", "ml", "+", 
          SqrtBox[
           RowBox[{
             SuperscriptBox["Ef", "2"], "+", 
             SuperscriptBox["Ei", "2"], "-", 
             SuperscriptBox["ml", "2"], "+", 
             RowBox[{"2", " ", 
               SqrtBox[
                RowBox[{
                  SuperscriptBox["Ef", "2"], "-", 
                  SuperscriptBox["ml", "2"]}]], " ", 
               SqrtBox[
                RowBox[{
                  SuperscriptBox["Ei", "2"], "-", 
                  SuperscriptBox["mx", "2"]}]]}]}]]}]}]},
     "HeavisideThetaSeq"], "-", 
    TemplateBox[{RowBox[{
        RowBox[{"Ef", "-", "Ei", "-", "ml", "+", 
          SqrtBox[
           RowBox[{
             SuperscriptBox["Ef", "2"], "+", 
             SuperscriptBox["Ei", "2"], "-", 
             SuperscriptBox["ml", "2"], "-", 
             RowBox[{"2", " ", 
               SqrtBox[
                RowBox[{
                  SuperscriptBox["Ef", "2"], "-", 
                  SuperscriptBox["ml", "2"]}]], " ", 
               SqrtBox[
                RowBox[{
                  SuperscriptBox["Ei", "2"], "-", 
                  SuperscriptBox["mx", "2"]}]]}]}]]}]}]},
     "HeavisideThetaSeq"]}], 
   RowBox[{
    SqrtBox[
     RowBox[{
      SuperscriptBox["Ef", "2"], "-", 
      SuperscriptBox["ml", "2"]}]], " ", 
    SqrtBox[
     RowBox[{
      SuperscriptBox["Ei", "2"], "-", 
      SuperscriptBox["mx", "2"]}]]}]], TraditionalForm]], "Output",
 CellChangeTimes->{3.7928486966538563`*^9, 3.792848726915585*^9, 
  3.792848827810562*^9, 3.792848881450367*^9, 3.7928490273559647`*^9},
 CellLabel->
  "Out[122]=",ExpressionUUID->"d31c9b58-26ea-4147-a73b-de445148d3db"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"f", "[", "z", "]"}], "=", 
   RowBox[{"Ei", "+", "ml", "-", "E3", "-", "Ef"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"roots", "=", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"f", "[", "Ef", "]"}], "\[Equal]", "0"}], ",", "z"}], "]"}], "//",
    "Simplify"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"df", "[", "z", "]"}], "=", 
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"f", "[", "z", "]"}], ",", "z"}], "]"}], "//", 
   "Simplify"}]}]}], "Input",
 CellChangeTimes->{{3.792844656674769*^9, 3.792844808893796*^9}, {
  3.7928450217344513`*^9, 3.792845043577471*^9}, {3.792845089365306*^9, 
  3.792845121177552*^9}, {3.792845377732006*^9, 3.792845414006544*^9}, {
  3.7928460151851254`*^9, 3.792846024588085*^9}},
 CellLabel->"In[85]:=",ExpressionUUID->"ca2aff85-02af-4a15-a972-613c38d516ea"],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{"{", 
    RowBox[{"z", "\[Rule]", 
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{"Ef", "-", "ml"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"Ei", "+", "ml"}], ")"}]}], 
      RowBox[{
       SqrtBox[
        RowBox[{
         SuperscriptBox["Ef", "2"], "-", 
         SuperscriptBox["ml", "2"]}]], " ", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["Ei", "2"], "-", 
         SuperscriptBox["mx", "2"]}]]}]]}], "}"}], "}"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{{3.792844664176792*^9, 3.7928448104671383`*^9}, {
   3.792845038875319*^9, 3.792845043992505*^9}, {3.792845109720009*^9, 
   3.792845121634259*^9}, 3.792845335819079*^9, {3.792845398889574*^9, 
   3.792845423507761*^9}, 3.792845885058133*^9, 3.792846025223784*^9},
 CellLabel->"Out[86]=",ExpressionUUID->"75c14b84-d148-42f5-93cc-9393f4a010d2"],

Cell[BoxData[
 FormBox[
  FractionBox[
   RowBox[{
    SqrtBox[
     RowBox[{
      SuperscriptBox["Ef", "2"], "-", 
      SuperscriptBox["ml", "2"]}]], " ", 
    SqrtBox[
     RowBox[{
      SuperscriptBox["Ei", "2"], "-", 
      SuperscriptBox["mx", "2"]}]]}], 
   SqrtBox[
    RowBox[{
     RowBox[{"-", 
      RowBox[{"2", " ", "z", " ", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["Ef", "2"], "-", 
         SuperscriptBox["ml", "2"]}]], " ", 
       SqrtBox[
        RowBox[{
         SuperscriptBox["Ei", "2"], "-", 
         SuperscriptBox["mx", "2"]}]]}]}], "+", 
     SuperscriptBox["Ef", "2"], "+", 
     SuperscriptBox["Ei", "2"], "-", 
     SuperscriptBox["ml", "2"]}]]], TraditionalForm]], "Output",
 CellChangeTimes->{{3.792844664176792*^9, 3.7928448104671383`*^9}, {
   3.792845038875319*^9, 3.792845043992505*^9}, {3.792845109720009*^9, 
   3.792845121634259*^9}, 3.792845335819079*^9, {3.792845398889574*^9, 
   3.792845423507761*^9}, 3.792845885058133*^9, 3.792846025275516*^9},
 CellLabel->"Out[87]=",ExpressionUUID->"b9de3020-f832-4f78-8af9-f981180fec9b"]
}, Open  ]],

Cell[BoxData[
 FormBox[
  RowBox[{
   FractionBox[
    RowBox[{"\[DifferentialD]", 
     SubscriptBox["E", "f"]}], 
    RowBox[{"8", "\[Pi]"}]], " ", 
   SqrtBox[
    RowBox[{
     SubscriptBox["E", "f"], "-", 
     SuperscriptBox[
      SubscriptBox["m", "e"], "2"]}]], 
   RowBox[{"F", "[", 
    SubscriptBox["E", "f"], "]"}], 
   RowBox[{"\[Integral]", 
    RowBox[{
     RowBox[{"\[DifferentialD]", "z"}], " ", 
     FractionBox[
      RowBox[{"\[Delta]", "(", 
       RowBox[{
        SubscriptBox["E", "i"], "+", 
        SubscriptBox["m", "e"], "-", 
        RowBox[{
         SubscriptBox["E", "3"], "[", 
         RowBox[{
          SubscriptBox["E", "f"], ",", "z"}], "]"}], "-", 
        SubscriptBox["E", "f"]}], ")"}], 
      RowBox[{
       SubscriptBox["E", "3"], "[", "z", "]"}]]}]}]}], 
  TraditionalForm]], "DisplayFormula",
 CellChangeTimes->{{3.79284404116891*^9, 3.792844147175596*^9}, {
  3.792844216197455*^9, 3.7928442307479258`*^9}, {3.792844312932617*^9, 
  3.792844360629485*^9}, {3.792844633423099*^9, 3.7928446375949097`*^9}, {
  3.792846047253924*^9, 3.792846090059926*^9}, {3.792848797700519*^9, 
  3.7928488190045977`*^9}},ExpressionUUID->"3ab8624f-f852-43a2-aeeb-\
519de6057653"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DifferentialCrossSection", "=", 
  RowBox[{
   FractionBox["1", 
    RowBox[{"8", "\[Pi]"}]], "AmpSquaredElectronRF", 
   SqrtBox[
    RowBox[{
     SuperscriptBox["Ef", "2"], "-", 
     SuperscriptBox["ml", "2"]}]], "intDiracDelta"}]}]], "Input",
 CellChangeTimes->{{3.792845430730433*^9, 3.792845487436289*^9}, {
   3.792845896985528*^9, 3.792845926856917*^9}, {3.792846102627368*^9, 
   3.792846132872076*^9}, 3.792848739579649*^9, {3.792848898103372*^9, 
   3.792848908333345*^9}},
 CellLabel->
  "In[123]:=",ExpressionUUID->"0830570a-40e8-4c66-932e-262078c1aa15"],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       TemplateBox[{RowBox[{
           RowBox[{"Ef", "-", "Ei", "-", "ml", "+", 
             SqrtBox[
              RowBox[{
                SuperscriptBox["Ef", "2"], "+", 
                SuperscriptBox["Ei", "2"], "-", 
                SuperscriptBox["ml", "2"], "+", 
                RowBox[{"2", " ", 
                  SqrtBox[
                   RowBox[{
                    SuperscriptBox["Ef", "2"], "-", 
                    SuperscriptBox["ml", "2"]}]], " ", 
                  SqrtBox[
                   RowBox[{
                    SuperscriptBox["Ei", "2"], "-", 
                    SuperscriptBox["mx", "2"]}]]}]}]]}]}]},
        "HeavisideThetaSeq"], "-", 
       TemplateBox[{RowBox[{
           RowBox[{"Ef", "-", "Ei", "-", "ml", "+", 
             SqrtBox[
              RowBox[{
                SuperscriptBox["Ef", "2"], "+", 
                SuperscriptBox["Ei", "2"], "-", 
                SuperscriptBox["ml", "2"], "-", 
                RowBox[{"2", " ", 
                  SqrtBox[
                   RowBox[{
                    SuperscriptBox["Ef", "2"], "-", 
                    SuperscriptBox["ml", "2"]}]], " ", 
                  SqrtBox[
                   RowBox[{
                    SuperscriptBox["Ei", "2"], "-", 
                    SuperscriptBox["mx", "2"]}]]}]}]]}]}]},
        "HeavisideThetaSeq"]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"8", " ", 
        SuperscriptBox["Ef", "2"], " ", 
        SuperscriptBox["gvll", "2"], " ", 
        SuperscriptBox["gvxx", "2"], " ", 
        SuperscriptBox["ml", "2"]}], "-", 
       RowBox[{"8", " ", "Ef", " ", 
        SuperscriptBox["gvll", "2"], " ", 
        SuperscriptBox["gvxx", "2"], " ", "ml", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "Ei", " ", "ml"}], "+", 
          RowBox[{"3", " ", 
           SuperscriptBox["ml", "2"]}], "+", 
          SuperscriptBox["mx", "2"]}], ")"}]}], "+", 
       RowBox[{"8", " ", 
        SuperscriptBox["gvll", "2"], " ", 
        SuperscriptBox["gvxx", "2"], " ", 
        SuperscriptBox["ml", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", 
           SuperscriptBox["Ei", "2"]}], "+", 
          RowBox[{"2", " ", "Ei", " ", "ml"}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["ml", "2"]}], "+", 
          SuperscriptBox["mx", "2"]}], ")"}]}]}], ")"}]}], ")"}], "/", 
   RowBox[{"(", 
    RowBox[{"8", " ", "\[Pi]", " ", 
     SqrtBox[
      RowBox[{
       SuperscriptBox["Ei", "2"], "-", 
       SuperscriptBox["mx", "2"]}]], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"4", " ", 
        SuperscriptBox["Ef", "2"], " ", 
        SuperscriptBox["ml", "2"]}], "+", 
       RowBox[{"Ef", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"4", " ", "ml", " ", 
           SuperscriptBox["mv", "2"]}], "-", 
          RowBox[{"8", " ", 
           SuperscriptBox["ml", "3"]}]}], ")"}]}], "+", 
       RowBox[{"4", " ", 
        SuperscriptBox["ml", "4"]}], "-", 
       RowBox[{"4", " ", 
        SuperscriptBox["ml", "2"], " ", 
        SuperscriptBox["mv", "2"]}], "+", 
       SuperscriptBox["mv", "4"], "+", 
       RowBox[{
        SuperscriptBox["mv", "2"], " ", 
        SuperscriptBox["widthv", "2"]}]}], ")"}]}], ")"}]}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{{3.792846119192843*^9, 3.792846133259737*^9}, {
   3.7928489088656273`*^9, 3.792848913595717*^9}, 3.792849045243511*^9},
 CellLabel->
  "Out[123]=",ExpressionUUID->"0ebb06eb-55ac-49cc-a27a-06e6c52ac62d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"DifferentialCrossSection", "=", 
  RowBox[{
   RowBox[{"Collect", "[", 
    RowBox[{
     RowBox[{"Numerator", "[", "DifferentialCrossSection", "]"}], ",", "Ef", 
     ",", "Simplify"}], "]"}], "/", 
   RowBox[{"Collect", "[", 
    RowBox[{
     RowBox[{"Denominator", "[", "DifferentialCrossSection", "]"}], ",", "Ef",
      ",", "Simplify"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.792845928913513*^9, 3.7928459725078087`*^9}, {
  3.7928461388271513`*^9, 3.792846142623711*^9}},
 CellLabel->
  "In[124]:=",ExpressionUUID->"6f6fbd75-287e-4711-bb36-84af3bad36a2"],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"8", " ", "Ef", " ", 
      SuperscriptBox["gvll", "2"], " ", 
      SuperscriptBox["gvxx", "2"], " ", "ml", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", "Ei", " ", "ml"}], "+", 
        RowBox[{"3", " ", 
         SuperscriptBox["ml", "2"]}], "+", 
        SuperscriptBox["mx", "2"]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        TemplateBox[{RowBox[{
            RowBox[{"Ef", "-", "Ei", "-", "ml", "+", 
              SqrtBox[
               RowBox[{
                 SuperscriptBox["Ef", "2"], "+", 
                 SuperscriptBox["Ei", "2"], "-", 
                 SuperscriptBox["ml", "2"], "-", 
                 RowBox[{"2", " ", 
                   SqrtBox[
                    RowBox[{
                    SuperscriptBox["Ef", "2"], "-", 
                    SuperscriptBox["ml", "2"]}]], " ", 
                   SqrtBox[
                    RowBox[{
                    SuperscriptBox["Ei", "2"], "-", 
                    SuperscriptBox["mx", "2"]}]]}]}]]}]}]},
         "HeavisideThetaSeq"], "-", 
        TemplateBox[{RowBox[{
            RowBox[{"Ef", "-", "Ei", "-", "ml", "+", 
              SqrtBox[
               RowBox[{
                 SuperscriptBox["Ef", "2"], "+", 
                 SuperscriptBox["Ei", "2"], "-", 
                 SuperscriptBox["ml", "2"], "+", 
                 RowBox[{"2", " ", 
                   SqrtBox[
                    RowBox[{
                    SuperscriptBox["Ef", "2"], "-", 
                    SuperscriptBox["ml", "2"]}]], " ", 
                   SqrtBox[
                    RowBox[{
                    SuperscriptBox["Ei", "2"], "-", 
                    SuperscriptBox["mx", "2"]}]]}]}]]}]}]},
         "HeavisideThetaSeq"]}], ")"}]}], "+", 
     RowBox[{"8", " ", 
      SuperscriptBox["Ef", "2"], " ", 
      SuperscriptBox["gvll", "2"], " ", 
      SuperscriptBox["gvxx", "2"], " ", 
      SuperscriptBox["ml", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        TemplateBox[{RowBox[{
            RowBox[{"Ef", "-", "Ei", "-", "ml", "+", 
              SqrtBox[
               RowBox[{
                 SuperscriptBox["Ef", "2"], "+", 
                 SuperscriptBox["Ei", "2"], "-", 
                 SuperscriptBox["ml", "2"], "+", 
                 RowBox[{"2", " ", 
                   SqrtBox[
                    RowBox[{
                    SuperscriptBox["Ef", "2"], "-", 
                    SuperscriptBox["ml", "2"]}]], " ", 
                   SqrtBox[
                    RowBox[{
                    SuperscriptBox["Ei", "2"], "-", 
                    SuperscriptBox["mx", "2"]}]]}]}]]}]}]},
         "HeavisideThetaSeq"], "-", 
        TemplateBox[{RowBox[{
            RowBox[{"Ef", "-", "Ei", "-", "ml", "+", 
              SqrtBox[
               RowBox[{
                 SuperscriptBox["Ef", "2"], "+", 
                 SuperscriptBox["Ei", "2"], "-", 
                 SuperscriptBox["ml", "2"], "-", 
                 RowBox[{"2", " ", 
                   SqrtBox[
                    RowBox[{
                    SuperscriptBox["Ef", "2"], "-", 
                    SuperscriptBox["ml", "2"]}]], " ", 
                   SqrtBox[
                    RowBox[{
                    SuperscriptBox["Ei", "2"], "-", 
                    SuperscriptBox["mx", "2"]}]]}]}]]}]}]},
         "HeavisideThetaSeq"]}], ")"}]}], "+", 
     RowBox[{"8", " ", 
      SuperscriptBox["gvll", "2"], " ", 
      SuperscriptBox["gvxx", "2"], " ", 
      SuperscriptBox["ml", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", 
         SuperscriptBox["Ei", "2"]}], "+", 
        RowBox[{"2", " ", "Ei", " ", "ml"}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["ml", "2"]}], "+", 
        SuperscriptBox["mx", "2"]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        TemplateBox[{RowBox[{
            RowBox[{"Ef", "-", "Ei", "-", "ml", "+", 
              SqrtBox[
               RowBox[{
                 SuperscriptBox["Ef", "2"], "+", 
                 SuperscriptBox["Ei", "2"], "-", 
                 SuperscriptBox["ml", "2"], "+", 
                 RowBox[{"2", " ", 
                   SqrtBox[
                    RowBox[{
                    SuperscriptBox["Ef", "2"], "-", 
                    SuperscriptBox["ml", "2"]}]], " ", 
                   SqrtBox[
                    RowBox[{
                    SuperscriptBox["Ei", "2"], "-", 
                    SuperscriptBox["mx", "2"]}]]}]}]]}]}]},
         "HeavisideThetaSeq"], "-", 
        TemplateBox[{RowBox[{
            RowBox[{"Ef", "-", "Ei", "-", "ml", "+", 
              SqrtBox[
               RowBox[{
                 SuperscriptBox["Ef", "2"], "+", 
                 SuperscriptBox["Ei", "2"], "-", 
                 SuperscriptBox["ml", "2"], "-", 
                 RowBox[{"2", " ", 
                   SqrtBox[
                    RowBox[{
                    SuperscriptBox["Ef", "2"], "-", 
                    SuperscriptBox["ml", "2"]}]], " ", 
                   SqrtBox[
                    RowBox[{
                    SuperscriptBox["Ei", "2"], "-", 
                    SuperscriptBox["mx", "2"]}]]}]}]]}]}]},
         "HeavisideThetaSeq"]}], ")"}]}]}], ")"}], "/", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"32", " ", "\[Pi]", " ", 
      SuperscriptBox["Ef", "2"], " ", 
      SuperscriptBox["ml", "2"], " ", 
      SqrtBox[
       RowBox[{
        SuperscriptBox["Ei", "2"], "-", 
        SuperscriptBox["mx", "2"]}]]}], "+", 
     RowBox[{"8", " ", "\[Pi]", " ", "Ef", " ", 
      SqrtBox[
       RowBox[{
        SuperscriptBox["Ei", "2"], "-", 
        SuperscriptBox["mx", "2"]}]], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"4", " ", "ml", " ", 
         SuperscriptBox["mv", "2"]}], "-", 
        RowBox[{"8", " ", 
         SuperscriptBox["ml", "3"]}]}], ")"}]}], "+", 
     RowBox[{"8", " ", "\[Pi]", " ", 
      SqrtBox[
       RowBox[{
        SuperscriptBox["Ei", "2"], "-", 
        SuperscriptBox["mx", "2"]}]], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"4", " ", 
         SuperscriptBox["ml", "4"]}], "-", 
        RowBox[{"4", " ", 
         SuperscriptBox["ml", "2"], " ", 
         SuperscriptBox["mv", "2"]}], "+", 
        SuperscriptBox["mv", "4"], "+", 
        RowBox[{
         SuperscriptBox["mv", "2"], " ", 
         SuperscriptBox["widthv", "2"]}]}], ")"}]}]}], ")"}]}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{{3.79284594434389*^9, 3.7928459730037937`*^9}, 
   3.792846143007914*^9, 3.7928489145950737`*^9, 3.792849048985035*^9},
 CellLabel->
  "Out[124]=",ExpressionUUID->"48eec027-6109-4138-bf22-f278154b23c6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Integrate", "[", 
  RowBox[{"DifferentialCrossSection", ",", 
   RowBox[{"{", 
    RowBox[{"Ef", ",", "ml", ",", "\[Infinity]"}], "}"}], ",", 
   RowBox[{"GenerateConditions", "\[Rule]", "False"}], ",", 
   RowBox[{"Assumptions", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Ei", ">", 
       RowBox[{"ml", "+", "mx"}], ">", "0"}], ",", 
      RowBox[{"ml", ">", "0"}], ",", 
      RowBox[{"mx", ">", "0"}]}], "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.792845978095084*^9, 3.792845980844145*^9}, {
  3.792846149848345*^9, 3.792846150243507*^9}, {3.792846325245491*^9, 
  3.792846335531666*^9}, {3.792848936174082*^9, 3.7928489748280563`*^9}},
 CellLabel->
  "In[125]:=",ExpressionUUID->"21b952b6-12c9-4711-9519-00e1954a64d0"],

Cell[BoxData[
 FormBox[
  RowBox[{"Integrate", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"8", " ", "Ef", " ", 
        SuperscriptBox["gvll", "2"], " ", 
        SuperscriptBox["gvxx", "2"], " ", "ml", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "Ei", " ", "ml"}], "+", 
          RowBox[{"3", " ", 
           SuperscriptBox["ml", "2"]}], "+", 
          SuperscriptBox["mx", "2"]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          TemplateBox[{RowBox[{
              RowBox[{"Ef", "-", "Ei", "-", "ml", "+", 
                SqrtBox[
                 RowBox[{
                   SuperscriptBox["Ef", "2"], "+", 
                   SuperscriptBox["Ei", "2"], "-", 
                   SuperscriptBox["ml", "2"], "-", 
                   RowBox[{"2", " ", 
                    SqrtBox[
                    RowBox[{
                    SuperscriptBox["Ef", "2"], "-", 
                    SuperscriptBox["ml", "2"]}]], " ", 
                    SqrtBox[
                    RowBox[{
                    SuperscriptBox["Ei", "2"], "-", 
                    SuperscriptBox["mx", "2"]}]]}]}]]}]}]},
           "HeavisideThetaSeq"], "-", 
          TemplateBox[{RowBox[{
              RowBox[{"Ef", "-", "Ei", "-", "ml", "+", 
                SqrtBox[
                 RowBox[{
                   SuperscriptBox["Ef", "2"], "+", 
                   SuperscriptBox["Ei", "2"], "-", 
                   SuperscriptBox["ml", "2"], "+", 
                   RowBox[{"2", " ", 
                    SqrtBox[
                    RowBox[{
                    SuperscriptBox["Ef", "2"], "-", 
                    SuperscriptBox["ml", "2"]}]], " ", 
                    SqrtBox[
                    RowBox[{
                    SuperscriptBox["Ei", "2"], "-", 
                    SuperscriptBox["mx", "2"]}]]}]}]]}]}]},
           "HeavisideThetaSeq"]}], ")"}]}], "+", 
       RowBox[{"8", " ", 
        SuperscriptBox["Ef", "2"], " ", 
        SuperscriptBox["gvll", "2"], " ", 
        SuperscriptBox["gvxx", "2"], " ", 
        SuperscriptBox["ml", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          TemplateBox[{RowBox[{
              RowBox[{"Ef", "-", "Ei", "-", "ml", "+", 
                SqrtBox[
                 RowBox[{
                   SuperscriptBox["Ef", "2"], "+", 
                   SuperscriptBox["Ei", "2"], "-", 
                   SuperscriptBox["ml", "2"], "+", 
                   RowBox[{"2", " ", 
                    SqrtBox[
                    RowBox[{
                    SuperscriptBox["Ef", "2"], "-", 
                    SuperscriptBox["ml", "2"]}]], " ", 
                    SqrtBox[
                    RowBox[{
                    SuperscriptBox["Ei", "2"], "-", 
                    SuperscriptBox["mx", "2"]}]]}]}]]}]}]},
           "HeavisideThetaSeq"], "-", 
          TemplateBox[{RowBox[{
              RowBox[{"Ef", "-", "Ei", "-", "ml", "+", 
                SqrtBox[
                 RowBox[{
                   SuperscriptBox["Ef", "2"], "+", 
                   SuperscriptBox["Ei", "2"], "-", 
                   SuperscriptBox["ml", "2"], "-", 
                   RowBox[{"2", " ", 
                    SqrtBox[
                    RowBox[{
                    SuperscriptBox["Ef", "2"], "-", 
                    SuperscriptBox["ml", "2"]}]], " ", 
                    SqrtBox[
                    RowBox[{
                    SuperscriptBox["Ei", "2"], "-", 
                    SuperscriptBox["mx", "2"]}]]}]}]]}]}]},
           "HeavisideThetaSeq"]}], ")"}]}], "+", 
       RowBox[{"8", " ", 
        SuperscriptBox["gvll", "2"], " ", 
        SuperscriptBox["gvxx", "2"], " ", 
        SuperscriptBox["ml", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", 
           SuperscriptBox["Ei", "2"]}], "+", 
          RowBox[{"2", " ", "Ei", " ", "ml"}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["ml", "2"]}], "+", 
          SuperscriptBox["mx", "2"]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          TemplateBox[{RowBox[{
              RowBox[{"Ef", "-", "Ei", "-", "ml", "+", 
                SqrtBox[
                 RowBox[{
                   SuperscriptBox["Ef", "2"], "+", 
                   SuperscriptBox["Ei", "2"], "-", 
                   SuperscriptBox["ml", "2"], "+", 
                   RowBox[{"2", " ", 
                    SqrtBox[
                    RowBox[{
                    SuperscriptBox["Ef", "2"], "-", 
                    SuperscriptBox["ml", "2"]}]], " ", 
                    SqrtBox[
                    RowBox[{
                    SuperscriptBox["Ei", "2"], "-", 
                    SuperscriptBox["mx", "2"]}]]}]}]]}]}]},
           "HeavisideThetaSeq"], "-", 
          TemplateBox[{RowBox[{
              RowBox[{"Ef", "-", "Ei", "-", "ml", "+", 
                SqrtBox[
                 RowBox[{
                   SuperscriptBox["Ef", "2"], "+", 
                   SuperscriptBox["Ei", "2"], "-", 
                   SuperscriptBox["ml", "2"], "-", 
                   RowBox[{"2", " ", 
                    SqrtBox[
                    RowBox[{
                    SuperscriptBox["Ef", "2"], "-", 
                    SuperscriptBox["ml", "2"]}]], " ", 
                    SqrtBox[
                    RowBox[{
                    SuperscriptBox["Ei", "2"], "-", 
                    SuperscriptBox["mx", "2"]}]]}]}]]}]}]},
           "HeavisideThetaSeq"]}], ")"}]}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"32", " ", "\[Pi]", " ", 
        SuperscriptBox["Ef", "2"], " ", 
        SuperscriptBox["ml", "2"], " ", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["Ei", "2"], "-", 
          SuperscriptBox["mx", "2"]}]]}], "+", 
       RowBox[{"8", " ", "\[Pi]", " ", "Ef", " ", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["Ei", "2"], "-", 
          SuperscriptBox["mx", "2"]}]], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"4", " ", "ml", " ", 
           SuperscriptBox["mv", "2"]}], "-", 
          RowBox[{"8", " ", 
           SuperscriptBox["ml", "3"]}]}], ")"}]}], "+", 
       RowBox[{"8", " ", "\[Pi]", " ", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["Ei", "2"], "-", 
          SuperscriptBox["mx", "2"]}]], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"4", " ", 
           SuperscriptBox["ml", "4"]}], "-", 
          RowBox[{"4", " ", 
           SuperscriptBox["ml", "2"], " ", 
           SuperscriptBox["mv", "2"]}], "+", 
          SuperscriptBox["mv", "4"], "+", 
          RowBox[{
           SuperscriptBox["mv", "2"], " ", 
           SuperscriptBox["widthv", "2"]}]}], ")"}]}]}], ")"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"Ef", ",", "ml", ",", "\[Infinity]"}], "}"}], ",", 
    RowBox[{"GenerateConditions", "\[Rule]", "False"}], ",", 
    RowBox[{"Assumptions", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Ei", ">", 
        RowBox[{"ml", "+", "mx"}], ">", "0"}], ",", 
       RowBox[{"ml", ">", "0"}], ",", 
       RowBox[{"mx", ">", "0"}]}], "}"}]}]}], "]"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{3.792846000918076*^9, 3.7928461509246607`*^9, 
  3.792846331372217*^9, 3.792846433979947*^9, 3.7928489374204817`*^9, 
  3.792848989860523*^9, 3.7928493739574127`*^9},
 CellLabel->
  "Out[125]=",ExpressionUUID->"ae3d83a6-ee37-42e3-ae2b-738484af6742"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Simplifying expressions", "Section",
 CellChangeTimes->{{3.792610093530795*^9, 
  3.7926100999852953`*^9}},ExpressionUUID->"c7372da2-6df8-46e6-8f2a-\
c305ce088abd"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ConstructEfficientCExpression", "[", 
    RowBox[{"expr_", ",", "tempPrefix_Symbol"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "iVariables", ",", "iFunction", ",", "iCoreExpr", ",", "iReps", ",", 
       "iStr", ",", "ii", ",", "iVar", ",", "iPrefixString"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"iPrefixString", "=", 
       RowBox[{"ToString", "[", "tempPrefix", "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Extract", " ", "all", " ", "of", " ", "the", " ", "symbols"}],
        " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"iVariables", "=", 
       RowBox[{
        RowBox[{"Cases", "[", 
         RowBox[{"expr", ",", "_Symbol", ",", "Infinity"}], "]"}], "//", 
        "Union"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Use", " ", 
        RowBox[{"Mathematica", " ", "'"}], 
        RowBox[{"Compile", "'"}], " ", "to", " ", "generate", " ", "an", " ", 
        "efficient", " ", "expression"}], " ", "*)"}], "\[IndentingNewLine]", 
      
      RowBox[{"iFunction", "=", 
       RowBox[{
        RowBox[{"Cases", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"Compile", "[", "##", "]"}], "&"}], "[", 
           RowBox[{"iVariables", ",", "expr"}], "]"}], ",", 
          RowBox[{"x_Function", "\[RuleDelayed]", "x"}]}], "]"}], "//", 
        "First"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"Convert", " ", "temporary", " ", "variables", " ", "to", " ", 
         RowBox[{"tempPrefix", "[", "i", "]"}], " ", "instead", " ", "of", 
         " ", "Compile`"}], "..."}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"iFunction", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Cases", "[", 
           RowBox[{"iFunction", ",", 
            RowBox[{"s_Symbol", "/;", 
             RowBox[{"\"\<Compile`\>\"", "===", 
              RowBox[{"Context", "[", "s", "]"}]}]}], ",", "Infinity"}], 
           "]"}], "//", "DeleteDuplicates"}], "//", 
         RowBox[{
          RowBox[{"MapIndexed", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"#1", "\[Rule]", 
              RowBox[{"tempPrefix", "@@", "#2"}]}], "&"}], ",", "#"}], "]"}], 
          "&"}]}], "//", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"iFunction", "/.", "#"}], "/.", 
           RowBox[{
            RowBox[{"HoldPattern", "[", 
             RowBox[{"Function", "[", 
              RowBox[{"_", ",", 
               RowBox[{"Block", "[", 
                RowBox[{"_", ",", "b_"}], "]"}]}], "]"}], "]"}], 
            "\[RuleDelayed]", 
            RowBox[{"Hold", "@", 
             RowBox[{"\[FormalM]", "[", 
              RowBox[{
               RowBox[{"{", "tempPrefix", "}"}], ",", "b"}], "]"}]}]}]}], "/.", 
          RowBox[{"\[FormalM]", "\[Rule]", "Module"}]}], "&"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Extract", " ", "the", " ", "core", " ", "expression", " ", "and", " ",
         "the", " ", "temperator", " ", "variables"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"iCoreExpr", ",", "iReps"}], "}"}], "=", 
       RowBox[{"(", 
        RowBox[{"(", 
         RowBox[{"iFunction", "/.", 
          RowBox[{
           RowBox[{"Hold", "[", 
            RowBox[{"Module", "[", 
             RowBox[{"_", ",", 
              RowBox[{"CompoundExpression", "[", 
               RowBox[{"s___", ",", "f_"}], "]"}]}], "]"}], "]"}], 
           "\[RuleDelayed]", 
           RowBox[{"{", 
            RowBox[{"f", ",", 
             RowBox[{"{", 
              RowBox[{"ReleaseHold", "[", 
               RowBox[{
                RowBox[{"Hold", "[", "s", "]"}], "/.", 
                RowBox[{"Set", "\[Rule]", "Rule"}]}], "]"}], "}"}]}], 
            "}"}]}]}], ")"}], ")"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Construct", " ", "a", " ", 
        RowBox[{"c", "++"}], " ", "function"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"iReps", "=", 
       RowBox[{"iReps", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"tempPrefix", "[", "a_", "]"}], "\[RuleDelayed]", 
          RowBox[{"ToExpression", "[", 
           RowBox[{"iPrefixString", "<>", 
            RowBox[{"ToString", "[", "a", "]"}]}], "]"}]}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"iCoreExpr", "=", 
       RowBox[{"iCoreExpr", "/.", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"tempPrefix", "[", "a_", "]"}], "\[RuleDelayed]", 
          RowBox[{"ToExpression", "[", 
           RowBox[{"iPrefixString", "<>", 
            RowBox[{"ToString", "[", "a", "]"}]}], "]"}]}], "}"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"iStr", "=", "\"\<double my_function(){\\n\>\""}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"ii", "=", "1"}], ",", 
        RowBox[{"ii", "\[LessEqual]", 
         RowBox[{"Length", "[", "iReps", "]"}]}], ",", 
        RowBox[{"ii", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"iVar", "=", 
          RowBox[{"ToString", "[", 
           RowBox[{"iReps", "\[LeftDoubleBracket]", 
            RowBox[{"ii", ",", "1"}], "\[RightDoubleBracket]"}], "]"}]}], ";",
          "\[IndentingNewLine]", 
         RowBox[{"iStr", "=", 
          RowBox[{
          "iStr", "<>", "\"\<\\tdouble \>\"", "<>", "iVar", "<>", 
           "\"\< = \>\"", "<>", 
           RowBox[{"ToString", "[", 
            RowBox[{
             RowBox[{"iReps", "\[LeftDoubleBracket]", 
              RowBox[{"ii", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
             "CForm"}], "]"}], "<>", "\"\<;\\n\>\""}]}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"iStr", "=", 
       RowBox[{"iStr", "<>", "\"\<\\treturn \>\"", "<>", 
        RowBox[{"ToString", "[", 
         RowBox[{"iCoreExpr", ",", "CForm"}], "]"}], "<>", 
        "\"\<;\\n}\>\""}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"StringReplace", "[", 
       RowBox[{"iStr", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"\"\<Power\>\"", "\[Rule]", "\"\<pow\>\""}], ",", 
          RowBox[{"\"\<Sqrt\>\"", "\[Rule]", "\"\<sqrt\>\""}], ",", 
          RowBox[{"\"\<Log\>\"", "\[Rule]", "\"\<log\>\""}], ",", 
          RowBox[{"\"\<Pi\>\"", "\[Rule]", "\"\<M_PI\>\""}], ",", 
          RowBox[{"\"\<MSM\>\"", "\[Rule]", "\"\<ms\>\""}], ",", 
          RowBox[{"\"\<MDM\>\"", "\[Rule]", "\"\<mx\>\""}], ",", 
          RowBox[{"\"\<gSXX\>\"", "\[Rule]", "\"\<gsxx\>\""}], ",", 
          RowBox[{"\"\<Mu\>\"", "\[Rule]", "\"\<mf\>\""}], ",", 
          RowBox[{"\"\<vev\>\"", "\[Rule]", "\"\<VH\>\""}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"\"\<\[CapitalGamma]SM\>\"", "\[Rule]", "\"\<widthS\>\""}], 
          ",", 
          RowBox[{"\"\<\[CapitalGamma]H\>\"", "\[Rule]", "\"\<WIDTHH\>\""}], 
          ",", 
          RowBox[{"\"\<\[CapitalGamma]W\>\"", "\[Rule]", "\"\<WIDTHW\>\""}], 
          ",", 
          RowBox[{"\"\<\[CapitalGamma]Z\>\"", "\[Rule]", "\"\<WIDTHZ\>\""}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"\"\<sw\>\"", "\[Rule]", "\"\<SINW\>\""}], ",", 
          RowBox[{"\"\<cw\>\"", "\[Rule]", "\"\<COSW\>\""}], ",", 
          RowBox[{"\"\<alphaEM\>\"", "\[Rule]", "\"\<ALPHA_EM\>\""}]}], 
         "}"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.7926111472324743`*^9, 3.7926113892226562`*^9}, {
  3.792611755790598*^9, 3.792611960039735*^9}, {3.792612201691495*^9, 
  3.7926122020992002`*^9}, {3.792612263687594*^9, 3.79261226430529*^9}, {
  3.7926124270296993`*^9, 3.7926126324581347`*^9}, {3.792612666194497*^9, 
  3.7926127319888277`*^9}, {3.792612782612627*^9, 3.792612786840254*^9}, {
  3.792612820807144*^9, 3.7926128417015333`*^9}, {3.7926129622578993`*^9, 
  3.7926129648397007`*^9}, {3.792613000321197*^9, 3.792613192043497*^9}, {
  3.792613232670206*^9, 3.792613233502884*^9}, {3.792613274012803*^9, 
  3.792613327155643*^9}},
 CellLabel->
  "In[137]:=",ExpressionUUID->"327e9c26-f619-4893-bfcc-924a9f5831e2"],

Cell[BoxData[
 RowBox[{"ConstructEfficientCExpression", "[", 
  RowBox[{"CrossSectionXXtoHH", ",", "temp"}], "]"}]], "Input",
 CellChangeTimes->{{3.792612640406309*^9, 3.7926126431205072`*^9}},
 CellLabel->
  "In[138]:=",ExpressionUUID->"13416dbc-9fd0-4291-abd2-74771d814cdd"],

Cell[BoxData[
 RowBox[{"ConstructEfficientCExpression", "[", 
  RowBox[{"CrossSectionXXtoSS", ",", "temp"}], "]"}]], "Input",
 CellChangeTimes->{{3.7926139626449966`*^9, 3.792613971161419*^9}},
 CellLabel->
  "In[140]:=",ExpressionUUID->"fcd82726-1e23-41e7-9520-97a32e764406"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"CrossSectionXXtoHHTUChannelOnly", "//.", 
  RowBox[{"{", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"c1_.", 
       RowBox[{"Log", "[", "a_", "]"}]}], "+", 
      RowBox[{"c1_.", 
       RowBox[{"Log", "[", "b_", "]"}]}]}], ":>", 
     RowBox[{"c1", "*", 
      RowBox[{"Log", "[", 
       RowBox[{"a", "*", "b"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"c1_.", 
       RowBox[{"Log", "[", "a_", "]"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"-", "c1_."}], ")"}], 
       RowBox[{"Log", "[", "b_", "]"}]}]}], ":>", 
     RowBox[{"c1", "*", 
      RowBox[{"Log", "[", 
       RowBox[{"a", "/", "b"}], "]"}]}]}]}], "\[IndentingNewLine]", 
   "}"}]}]], "Input",
 CellChangeTimes->{{3.792689063542631*^9, 3.792689167868031*^9}, {
  3.792689204241434*^9, 3.792689253298011*^9}, {3.7926893317870903`*^9, 
  3.7926894755814877`*^9}, {3.792689513002922*^9, 3.7926896176496*^9}, {
  3.792689735859456*^9, 
  3.792689787663381*^9}},ExpressionUUID->"8bb6cac8-6aa2-4797-ae5f-\
55f6f2d97f7e"],

Cell[BoxData[
 FormBox[
  RowBox[{"-", 
   RowBox[{
    FractionBox["1", 
     RowBox[{"64", " ", "\[Pi]", " ", 
      SuperscriptBox["Q", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["Q", "2"], "-", 
        RowBox[{"4", " ", 
         SuperscriptBox["MDM", "2"]}]}], ")"}]}]], 
    RowBox[{
     SuperscriptBox["gSXX", "4"], " ", 
     SuperscriptBox["smix", "4"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SqrtBox[
            RowBox[{
             SuperscriptBox["Q", "2"], "-", 
             RowBox[{"4", " ", 
              SuperscriptBox["MDM", "2"]}]}]], " ", 
           SqrtBox[
            RowBox[{
             SuperscriptBox["Q", "2"], "-", 
             RowBox[{"4", " ", 
              SuperscriptBox["MH", "2"]}]}]]}], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["MH", "2"]}], "+", 
          SuperscriptBox["Q", "2"]}], ")"}]}], "+", 
       RowBox[{"2", " ", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["Q", "2"], "-", 
          RowBox[{"4", " ", 
           SuperscriptBox["MDM", "2"]}]}]], " ", 
        SqrtBox[
         RowBox[{
          SuperscriptBox["Q", "2"], "-", 
          RowBox[{"4", " ", 
           SuperscriptBox["MH", "2"]}]}]]}], "-", 
       FractionBox[
        RowBox[{"4", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["MH", "2"], "-", 
            RowBox[{"4", " ", 
             SuperscriptBox["MDM", "2"]}]}], ")"}], "2"]}], 
        RowBox[{
         RowBox[{
          SqrtBox[
           RowBox[{
            SuperscriptBox["Q", "2"], "-", 
            RowBox[{"4", " ", 
             SuperscriptBox["MDM", "2"]}]}]], " ", 
          SqrtBox[
           RowBox[{
            SuperscriptBox["Q", "2"], "-", 
            RowBox[{"4", " ", 
             SuperscriptBox["MH", "2"]}]}]]}], "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["MH", "2"]}], "-", 
         SuperscriptBox["Q", "2"]}]], "-", 
       FractionBox[
        RowBox[{"4", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["MH", "2"], "-", 
            RowBox[{"4", " ", 
             SuperscriptBox["MDM", "2"]}]}], ")"}], "2"]}], 
        RowBox[{
         RowBox[{
          SqrtBox[
           RowBox[{
            SuperscriptBox["Q", "2"], "-", 
            RowBox[{"4", " ", 
             SuperscriptBox["MDM", "2"]}]}]], " ", 
          SqrtBox[
           RowBox[{
            SuperscriptBox["Q", "2"], "-", 
            RowBox[{"4", " ", 
             SuperscriptBox["MH", "2"]}]}]]}], "-", 
         RowBox[{"2", " ", 
          SuperscriptBox["MH", "2"]}], "+", 
         SuperscriptBox["Q", "2"]}]], "+", 
       RowBox[{
        FractionBox["1", 
         RowBox[{
          RowBox[{"2", " ", 
           SuperscriptBox["MH", "2"]}], "-", 
          SuperscriptBox["Q", "2"]}]], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"32", " ", 
             SuperscriptBox["MDM", "4"]}]}], "-", 
           RowBox[{"16", " ", 
            SuperscriptBox["MDM", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["MH", "2"], "-", 
              SuperscriptBox["Q", "2"]}], ")"}]}], "+", 
           RowBox[{"6", " ", 
            SuperscriptBox["MH", "4"]}], "-", 
           RowBox[{"4", " ", 
            SuperscriptBox["MH", "2"], " ", 
            SuperscriptBox["Q", "2"]}], "+", 
           SuperscriptBox["Q", "4"]}], ")"}], " ", 
         RowBox[{"log", "(", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             SqrtBox[
              RowBox[{
               SuperscriptBox["Q", "2"], "-", 
               RowBox[{"4", " ", 
                SuperscriptBox["MDM", "2"]}]}]], " ", 
             SqrtBox[
              RowBox[{
               SuperscriptBox["Q", "2"], "-", 
               RowBox[{"4", " ", 
                SuperscriptBox["MH", "2"]}]}]]}]}], "+", 
           SuperscriptBox["MH", "2"], "-", 
           FractionBox[
            SuperscriptBox["Q", "2"], "2"]}], ")"}]}]}], "+", 
       RowBox[{
        FractionBox["1", 
         RowBox[{
          SuperscriptBox["Q", "2"], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["MH", "2"]}]}]], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"32", " ", 
             SuperscriptBox["MDM", "4"]}]}], "-", 
           RowBox[{"16", " ", 
            SuperscriptBox["MDM", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["MH", "2"], "-", 
              SuperscriptBox["Q", "2"]}], ")"}]}], "+", 
           RowBox[{"6", " ", 
            SuperscriptBox["MH", "4"]}], "-", 
           RowBox[{"4", " ", 
            SuperscriptBox["MH", "2"], " ", 
            SuperscriptBox["Q", "2"]}], "+", 
           SuperscriptBox["Q", "4"]}], ")"}], " ", 
         RowBox[{"log", "(", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", 
                RowBox[{
                 SqrtBox[
                  RowBox[{
                   SuperscriptBox["Q", "2"], "-", 
                   RowBox[{"4", " ", 
                    SuperscriptBox["MDM", "2"]}]}]], " ", 
                 SqrtBox[
                  RowBox[{
                   SuperscriptBox["Q", "2"], "-", 
                   RowBox[{"4", " ", 
                    SuperscriptBox["MH", "2"]}]}]]}]}], "-", 
               RowBox[{"2", " ", 
                SuperscriptBox["MH", "2"]}], "+", 
               SuperscriptBox["Q", "2"]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                FractionBox["1", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   SqrtBox[
                    RowBox[{
                    SuperscriptBox["Q", "2"], "-", 
                    RowBox[{"4", " ", 
                    SuperscriptBox["MDM", "2"]}]}]], " ", 
                   SqrtBox[
                    RowBox[{
                    SuperscriptBox["Q", "2"], "-", 
                    RowBox[{"4", " ", 
                    SuperscriptBox["MH", "2"]}]}]]}], "-", 
                  SuperscriptBox["Q", "2"]}], ")"}]}], "+", 
               SuperscriptBox["MH", "2"]}], ")"}]}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              SqrtBox[
               RowBox[{
                SuperscriptBox["Q", "2"], "-", 
                RowBox[{"4", " ", 
                 SuperscriptBox["MDM", "2"]}]}]], " ", 
              SqrtBox[
               RowBox[{
                SuperscriptBox["Q", "2"], "-", 
                RowBox[{"4", " ", 
                 SuperscriptBox["MH", "2"]}]}]]}], "-", 
             RowBox[{"2", " ", 
              SuperscriptBox["MH", "2"]}], "+", 
             SuperscriptBox["Q", "2"]}], ")"}]}], ")"}]}]}], "+", 
       RowBox[{"4", " ", 
        SuperscriptBox["MH", "2"]}], "-", 
       RowBox[{"2", " ", 
        SuperscriptBox["Q", "2"]}]}], ")"}]}]}]}], TraditionalForm]], "Output",\

 CellChangeTimes->{3.7926897629021482`*^9},
 CellLabel->
  "Out[236]=",ExpressionUUID->"562dcfc4-549f-4388-a476-f7f793bcbcc0"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"amps", "=", 
   RowBox[{"ComputeCrossSection22", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"DM", ",", 
        RowBox[{"-", "DM"}]}], "}"}], "->", 
      RowBox[{"{", 
       RowBox[{"ScalarMediator", ",", "ScalarMediator"}], "}"}]}], ",", "Q"}],
     "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.792693389823618*^9, 3.792693391903644*^9}, {
   3.792693725573276*^9, 3.792693737310862*^9}, 3.792694300640572*^9, {
   3.7926947675966377`*^9, 3.7926947715653353`*^9}, {3.792695254097722*^9, 
   3.7926952845943937`*^9}, {3.7926968257960653`*^9, 3.7926968307608967`*^9}},
 
 CellLabel->
  "In[388]:=",ExpressionUUID->"5d166935-8b18-4128-915a-a93d0ac70225"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"amps", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"ReplaceAll", "[", 
       RowBox[{"#", ",", 
        RowBox[{
         RowBox[{"FCGV", "[", "\"\<MH\>\"", "]"}], "\[Rule]", "MH"}]}], "]"}],
       "&"}], ",", "amps"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"amps", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Simplify", "[", 
       RowBox[{
        RowBox[{"SimplifyLogs", "[", "#", "]"}], ",", 
        RowBox[{"Assumptions", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Q", ">", 
            RowBox[{"2", "*", "MH"}], ">", "0"}], ",", 
           RowBox[{"Q", ">", 
            RowBox[{"2", "MDM"}], ">", "0"}]}], "}"}]}]}], "]"}], "&"}], ",", 
     "amps"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7926952886870604`*^9, 3.792695339358306*^9}, {
  3.792695823571076*^9, 3.792695840277885*^9}},
 CellLabel->
  "In[389]:=",ExpressionUUID->"0d1eca7f-f949-4f4d-b9ca-c3debfefe643"],

Cell[BoxData[
 RowBox[{
  RowBox[{"amps", "=", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"FullSimplify", "[", 
       RowBox[{"#", ",", 
        RowBox[{"Assumptions", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Q", ">", 
            RowBox[{"2", "*", "MH"}], ">", "0"}], ",", 
           RowBox[{"Q", ">", 
            RowBox[{"2", "*", "ms"}], ">", "0"}]}], "}"}]}]}], "]"}], "&"}], 
     ",", "amps"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{3.79269684970662*^9},
 CellLabel->
  "In[391]:=",ExpressionUUID->"a2050c04-273f-4cc9-866d-9a9f62e54db8"],

Cell[CellGroupData[{

Cell[BoxData["amps"], "Input",
 CellChangeTimes->{{3.792696931595146*^9, 3.792696932134459*^9}},
 CellLabel->
  "In[393]:=",ExpressionUUID->"c3c2781a-5f85-4781-a793-cdb399346eb4"],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{
       SuperscriptBox["gSXX", "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["MH", "2"], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["MSM", "2"]}]}], ")"}], "2"], " ", 
       SqrtBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["Q", "2"], "-", 
           RowBox[{"4", " ", 
            SuperscriptBox["MDM", "2"]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["Q", "2"], "-", 
           RowBox[{"4", " ", 
            SuperscriptBox["MSM", "2"]}]}], ")"}]}]], " ", 
       RowBox[{"(", 
        RowBox[{"smix", "-", "1"}], ")"}], " ", 
       SuperscriptBox["smix", "6"], " ", 
       RowBox[{"(", 
        RowBox[{"smix", "+", "1"}], ")"}]}], 
      RowBox[{"64", " ", "\[Pi]", " ", 
       SuperscriptBox["Q", "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["MH", "2"], "-", 
          SuperscriptBox["Q", "2"]}], ")"}], "2"], " ", 
       SuperscriptBox["vev", "2"]}]]}], ",", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{"9", " ", 
       SuperscriptBox["gSXX", "2"], " ", 
       SuperscriptBox["MSM", "4"], " ", 
       SqrtBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["Q", "2"], "-", 
           RowBox[{"4", " ", 
            SuperscriptBox["MDM", "2"]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["Q", "2"], "-", 
           RowBox[{"4", " ", 
            SuperscriptBox["MSM", "2"]}]}], ")"}]}]], " ", 
       RowBox[{"(", 
        RowBox[{"smix", "-", "1"}], ")"}], " ", 
       SuperscriptBox["smix", "6"], " ", 
       RowBox[{"(", 
        RowBox[{"smix", "+", "1"}], ")"}]}], 
      RowBox[{"64", " ", "\[Pi]", " ", 
       SuperscriptBox["Q", "2"], " ", 
       SuperscriptBox["vev", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["MSM", "2"], "-", 
            SuperscriptBox["Q", "2"]}], ")"}], "2"], "+", 
         RowBox[{
          SuperscriptBox["MSM", "2"], " ", 
          SuperscriptBox["\[CapitalGamma]SM", "2"]}]}], ")"}]}]]}], ",", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{
       SuperscriptBox["gSXX", "4"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["smix", "2"], "-", "1"}], ")"}], "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{
           SqrtBox[
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["Q", "2"], "-", 
               RowBox[{"4", " ", 
                SuperscriptBox["MDM", "2"]}]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["Q", "2"], "-", 
               RowBox[{"4", " ", 
                SuperscriptBox["MSM", "2"]}]}], ")"}]}]], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"16", " ", 
              SuperscriptBox["MDM", "4"]}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["Q", "2"], "-", 
                RowBox[{"12", " ", 
                 SuperscriptBox["MSM", "2"]}]}], ")"}], " ", 
              SuperscriptBox["MDM", "2"]}], "+", 
             RowBox[{"2", " ", 
              SuperscriptBox["MSM", "4"]}]}], ")"}]}], 
          RowBox[{
           SuperscriptBox["MSM", "4"], "+", 
           RowBox[{
            SuperscriptBox["MDM", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["Q", "2"], "-", 
              RowBox[{"4", " ", 
               SuperscriptBox["MSM", "2"]}]}], ")"}]}]}]], "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"8", " ", 
             SuperscriptBox["MDM", "2"]}], "-", 
            RowBox[{"2", " ", 
             SuperscriptBox["MSM", "2"]}], "+", 
            SuperscriptBox["Q", "2"]}], ")"}], " ", 
          RowBox[{"log", "(", 
           RowBox[{"-", 
            FractionBox[
             RowBox[{
              RowBox[{
               RowBox[{"-", "2"}], " ", 
               SuperscriptBox["MSM", "2"]}], "+", 
              SuperscriptBox["Q", "2"], "+", 
              SqrtBox[
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["Q", "2"], "-", 
                  RowBox[{"4", " ", 
                   SuperscriptBox["MDM", "2"]}]}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["Q", "2"], "-", 
                  RowBox[{"4", " ", 
                   SuperscriptBox["MSM", "2"]}]}], ")"}]}]]}], 
             RowBox[{
              RowBox[{"2", " ", 
               SuperscriptBox["MSM", "2"]}], "-", 
              SuperscriptBox["Q", "2"], "+", 
              SqrtBox[
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["Q", "2"], "-", 
                  RowBox[{"4", " ", 
                   SuperscriptBox["MDM", "2"]}]}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["Q", "2"], "-", 
                  RowBox[{"4", " ", 
                   SuperscriptBox["MSM", "2"]}]}], ")"}]}]]}]]}], ")"}]}]}], 
        ")"}]}], 
      RowBox[{"64", " ", "\[Pi]", " ", 
       SuperscriptBox["Q", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["Q", "2"], "-", 
         RowBox[{"4", " ", 
          SuperscriptBox["MDM", "2"]}]}], ")"}]}]]}], ",", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{
       SuperscriptBox["gSXX", "4"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["smix", "2"], "-", "1"}], ")"}], "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{
           SqrtBox[
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["Q", "2"], "-", 
               RowBox[{"4", " ", 
                SuperscriptBox["MDM", "2"]}]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["Q", "2"], "-", 
               RowBox[{"4", " ", 
                SuperscriptBox["MSM", "2"]}]}], ")"}]}]], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"16", " ", 
              SuperscriptBox["MDM", "4"]}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["Q", "2"], "-", 
                RowBox[{"12", " ", 
                 SuperscriptBox["MSM", "2"]}]}], ")"}], " ", 
              SuperscriptBox["MDM", "2"]}], "+", 
             RowBox[{"2", " ", 
              SuperscriptBox["MSM", "4"]}]}], ")"}]}], 
          RowBox[{
           SuperscriptBox["MSM", "4"], "+", 
           RowBox[{
            SuperscriptBox["MDM", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["Q", "2"], "-", 
              RowBox[{"4", " ", 
               SuperscriptBox["MSM", "2"]}]}], ")"}]}]}]], "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"8", " ", 
             SuperscriptBox["MDM", "2"]}], "-", 
            RowBox[{"2", " ", 
             SuperscriptBox["MSM", "2"]}], "+", 
            SuperscriptBox["Q", "2"]}], ")"}], " ", 
          RowBox[{"log", "(", 
           RowBox[{"-", 
            FractionBox[
             RowBox[{
              RowBox[{
               RowBox[{"-", "2"}], " ", 
               SuperscriptBox["MSM", "2"]}], "+", 
              SuperscriptBox["Q", "2"], "+", 
              SqrtBox[
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["Q", "2"], "-", 
                  RowBox[{"4", " ", 
                   SuperscriptBox["MDM", "2"]}]}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["Q", "2"], "-", 
                  RowBox[{"4", " ", 
                   SuperscriptBox["MSM", "2"]}]}], ")"}]}]]}], 
             RowBox[{
              RowBox[{"2", " ", 
               SuperscriptBox["MSM", "2"]}], "-", 
              SuperscriptBox["Q", "2"], "+", 
              SqrtBox[
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["Q", "2"], "-", 
                  RowBox[{"4", " ", 
                   SuperscriptBox["MDM", "2"]}]}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["Q", "2"], "-", 
                  RowBox[{"4", " ", 
                   SuperscriptBox["MSM", "2"]}]}], ")"}]}]]}]]}], ")"}]}]}], 
        ")"}]}], 
      RowBox[{"64", " ", "\[Pi]", " ", 
       SuperscriptBox["Q", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["Q", "2"], "-", 
         RowBox[{"4", " ", 
          SuperscriptBox["MDM", "2"]}]}], ")"}]}]]}], ",", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{"3", " ", 
       SuperscriptBox["gSXX", "2"], " ", 
       SuperscriptBox["MSM", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["MH", "2"], "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["MSM", "2"]}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"MSM", "-", "Q"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"MSM", "+", "Q"}], ")"}], " ", 
       SqrtBox[
        RowBox[{
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"4", " ", 
             SuperscriptBox["MDM", "2"]}], "-", 
            SuperscriptBox["Q", "2"]}], ")"}]}], " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["Q", "2"], "-", 
           RowBox[{"4", " ", 
            SuperscriptBox["MSM", "2"]}]}], ")"}]}]], " ", 
       SuperscriptBox["smix", "6"], " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["smix", "2"], "-", "1"}], ")"}]}], 
      RowBox[{"32", " ", "\[Pi]", " ", 
       SuperscriptBox["Q", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["Q", "2"], "-", 
         SuperscriptBox["MH", "2"]}], ")"}], " ", 
       SuperscriptBox["vev", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["MSM", "2"], "-", 
            SuperscriptBox["Q", "2"]}], ")"}], "2"], "+", 
         RowBox[{
          SuperscriptBox["MSM", "2"], " ", 
          SuperscriptBox["\[CapitalGamma]SM", "2"]}]}], ")"}]}]]}], ",", 
    FractionBox[
     RowBox[{
      SuperscriptBox["gSXX", "3"], " ", "MDM", " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["MH", "2"], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["MSM", "2"]}]}], ")"}], " ", 
      SuperscriptBox["smix", "3"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SuperscriptBox["smix", "2"]}], ")"}], 
       RowBox[{"3", "/", "2"}]], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"8", " ", 
            SuperscriptBox["MDM", "2"]}], "-", 
           RowBox[{"2", " ", 
            SuperscriptBox["MSM", "2"]}], "-", 
           SuperscriptBox["Q", "2"]}], ")"}], " ", 
         RowBox[{"log", "(", 
          RowBox[{"-", 
           FractionBox[
            RowBox[{
             RowBox[{
              RowBox[{"-", "2"}], " ", 
              SuperscriptBox["MSM", "2"]}], "+", 
             SuperscriptBox["Q", "2"], "+", 
             SqrtBox[
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["Q", "2"], "-", 
                 RowBox[{"4", " ", 
                  SuperscriptBox["MDM", "2"]}]}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["Q", "2"], "-", 
                 RowBox[{"4", " ", 
                  SuperscriptBox["MSM", "2"]}]}], ")"}]}]]}], 
            RowBox[{
             RowBox[{"2", " ", 
              SuperscriptBox["MSM", "2"]}], "-", 
             SuperscriptBox["Q", "2"], "+", 
             SqrtBox[
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["Q", "2"], "-", 
                 RowBox[{"4", " ", 
                  SuperscriptBox["MDM", "2"]}]}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["Q", "2"], "-", 
                 RowBox[{"4", " ", 
                  SuperscriptBox["MSM", "2"]}]}], ")"}]}]]}]]}], ")"}]}], "-", 
        RowBox[{"2", " ", 
         SqrtBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["Q", "2"], "-", 
             RowBox[{"4", " ", 
              SuperscriptBox["MDM", "2"]}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["Q", "2"], "-", 
             RowBox[{"4", " ", 
              SuperscriptBox["MSM", "2"]}]}], ")"}]}]]}]}], ")"}]}], 
     RowBox[{"32", " ", "\[Pi]", " ", 
      SuperscriptBox["Q", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["Q", "2"], "-", 
        RowBox[{"4", " ", 
         SuperscriptBox["MDM", "2"]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["Q", "2"], "-", 
        SuperscriptBox["MH", "2"]}], ")"}], " ", "vev"}]], ",", 
    FractionBox[
     RowBox[{
      SuperscriptBox["gSXX", "3"], " ", "MDM", " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["MH", "2"], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["MSM", "2"]}]}], ")"}], " ", 
      SuperscriptBox["smix", "3"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SuperscriptBox["smix", "2"]}], ")"}], 
       RowBox[{"3", "/", "2"}]], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"8", " ", 
            SuperscriptBox["MDM", "2"]}], "-", 
           RowBox[{"2", " ", 
            SuperscriptBox["MSM", "2"]}], "-", 
           SuperscriptBox["Q", "2"]}], ")"}], " ", 
         RowBox[{"log", "(", 
          FractionBox[
           RowBox[{
            RowBox[{
             RowBox[{"-", "2"}], " ", 
             SuperscriptBox["MSM", "2"]}], "+", 
            SuperscriptBox["Q", "2"], "-", 
            SqrtBox[
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["Q", "2"], "-", 
                RowBox[{"4", " ", 
                 SuperscriptBox["MDM", "2"]}]}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["Q", "2"], "-", 
                RowBox[{"4", " ", 
                 SuperscriptBox["MSM", "2"]}]}], ")"}]}]]}], 
           RowBox[{
            RowBox[{
             RowBox[{"-", "2"}], " ", 
             SuperscriptBox["MSM", "2"]}], "+", 
            SuperscriptBox["Q", "2"], "+", 
            SqrtBox[
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["Q", "2"], "-", 
                RowBox[{"4", " ", 
                 SuperscriptBox["MDM", "2"]}]}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["Q", "2"], "-", 
                RowBox[{"4", " ", 
                 SuperscriptBox["MSM", "2"]}]}], ")"}]}]]}]], ")"}]}], "+", 
        RowBox[{"2", " ", 
         SqrtBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["Q", "2"], "-", 
             RowBox[{"4", " ", 
              SuperscriptBox["MDM", "2"]}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["Q", "2"], "-", 
             RowBox[{"4", " ", 
              SuperscriptBox["MSM", "2"]}]}], ")"}]}]]}]}], ")"}]}], 
     RowBox[{"32", " ", "\[Pi]", " ", 
      SuperscriptBox["Q", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["MH", "2"], "-", 
        SuperscriptBox["Q", "2"]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["Q", "2"], "-", 
        RowBox[{"4", " ", 
         SuperscriptBox["MDM", "2"]}]}], ")"}], " ", "vev"}]], ",", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{"3", " ", 
       SuperscriptBox["gSXX", "3"], " ", "MDM", " ", 
       SuperscriptBox["MSM", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"MSM", "-", "Q"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"MSM", "+", "Q"}], ")"}], " ", 
       SuperscriptBox["smix", "3"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", 
          SuperscriptBox["smix", "2"]}], ")"}], 
        RowBox[{"3", "/", "2"}]], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "8"}], " ", 
             SuperscriptBox["MDM", "2"]}], "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["MSM", "2"]}], "+", 
            SuperscriptBox["Q", "2"]}], ")"}], " ", 
          RowBox[{"log", "(", 
           RowBox[{"-", 
            FractionBox[
             RowBox[{
              RowBox[{
               RowBox[{"-", "2"}], " ", 
               SuperscriptBox["MSM", "2"]}], "+", 
              SuperscriptBox["Q", "2"], "+", 
              SqrtBox[
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["Q", "2"], "-", 
                  RowBox[{"4", " ", 
                   SuperscriptBox["MDM", "2"]}]}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["Q", "2"], "-", 
                  RowBox[{"4", " ", 
                   SuperscriptBox["MSM", "2"]}]}], ")"}]}]]}], 
             RowBox[{
              RowBox[{"2", " ", 
               SuperscriptBox["MSM", "2"]}], "-", 
              SuperscriptBox["Q", "2"], "+", 
              SqrtBox[
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["Q", "2"], "-", 
                  RowBox[{"4", " ", 
                   SuperscriptBox["MDM", "2"]}]}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["Q", "2"], "-", 
                  RowBox[{"4", " ", 
                   SuperscriptBox["MSM", "2"]}]}], ")"}]}]]}]]}], ")"}]}], 
         "+", 
         RowBox[{"2", " ", 
          SqrtBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"4", " ", 
               SuperscriptBox["MDM", "2"]}], "-", 
              SuperscriptBox["Q", "2"]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"4", " ", 
               SuperscriptBox["MSM", "2"]}], "-", 
              SuperscriptBox["Q", "2"]}], ")"}]}]]}]}], ")"}]}], 
      RowBox[{"32", " ", "\[Pi]", " ", 
       SuperscriptBox["Q", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["Q", "2"], "-", 
         RowBox[{"4", " ", 
          SuperscriptBox["MDM", "2"]}]}], ")"}], " ", "vev", " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["MSM", "2"], "-", 
            SuperscriptBox["Q", "2"]}], ")"}], "2"], "+", 
         RowBox[{
          SuperscriptBox["MSM", "2"], " ", 
          SuperscriptBox["\[CapitalGamma]SM", "2"]}]}], ")"}]}]]}], ",", 
    FractionBox[
     RowBox[{"3", " ", 
      SuperscriptBox["gSXX", "3"], " ", "MDM", " ", 
      SuperscriptBox["MSM", "2"], " ", 
      RowBox[{"(", 
       RowBox[{"MSM", "-", "Q"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"MSM", "+", "Q"}], ")"}], " ", 
      SuperscriptBox["smix", "3"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SuperscriptBox["smix", "2"]}], ")"}], 
       RowBox[{"3", "/", "2"}]], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "8"}], " ", 
            SuperscriptBox["MDM", "2"]}], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["MSM", "2"]}], "+", 
           SuperscriptBox["Q", "2"]}], ")"}], " ", 
         RowBox[{"log", "(", 
          FractionBox[
           RowBox[{
            RowBox[{
             RowBox[{"-", "2"}], " ", 
             SuperscriptBox["MSM", "2"]}], "+", 
            SuperscriptBox["Q", "2"], "-", 
            SqrtBox[
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["Q", "2"], "-", 
                RowBox[{"4", " ", 
                 SuperscriptBox["MDM", "2"]}]}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["Q", "2"], "-", 
                RowBox[{"4", " ", 
                 SuperscriptBox["MSM", "2"]}]}], ")"}]}]]}], 
           RowBox[{
            RowBox[{
             RowBox[{"-", "2"}], " ", 
             SuperscriptBox["MSM", "2"]}], "+", 
            SuperscriptBox["Q", "2"], "+", 
            SqrtBox[
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["Q", "2"], "-", 
                RowBox[{"4", " ", 
                 SuperscriptBox["MDM", "2"]}]}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["Q", "2"], "-", 
                RowBox[{"4", " ", 
                 SuperscriptBox["MSM", "2"]}]}], ")"}]}]]}]], ")"}]}], "-", 
        RowBox[{"2", " ", 
         SqrtBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"4", " ", 
              SuperscriptBox["MDM", "2"]}], "-", 
             SuperscriptBox["Q", "2"]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"4", " ", 
              SuperscriptBox["MSM", "2"]}], "-", 
             SuperscriptBox["Q", "2"]}], ")"}]}]]}]}], ")"}]}], 
     RowBox[{"32", " ", "\[Pi]", " ", 
      SuperscriptBox["Q", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["Q", "2"], "-", 
        RowBox[{"4", " ", 
         SuperscriptBox["MDM", "2"]}]}], ")"}], " ", "vev", " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["MSM", "2"], "-", 
           SuperscriptBox["Q", "2"]}], ")"}], "2"], "+", 
        RowBox[{
         SuperscriptBox["MSM", "2"], " ", 
         SuperscriptBox["\[CapitalGamma]SM", "2"]}]}], ")"}]}]], ",", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{
       SuperscriptBox["gSXX", "4"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["smix", "2"], "-", "1"}], ")"}], "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SqrtBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["Q", "2"], "-", 
              RowBox[{"4", " ", 
               SuperscriptBox["MDM", "2"]}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["Q", "2"], "-", 
              RowBox[{"4", " ", 
               SuperscriptBox["MSM", "2"]}]}], ")"}]}]], " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["Q", "2"], "-", 
            RowBox[{"2", " ", 
             SuperscriptBox["MSM", "2"]}]}], ")"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "16"}], " ", 
             SuperscriptBox["MDM", "4"]}], "+", 
            RowBox[{"4", " ", 
             SuperscriptBox["Q", "2"], " ", 
             SuperscriptBox["MDM", "2"]}], "+", 
            SuperscriptBox["MSM", "4"]}], ")"}], " ", 
          RowBox[{"log", "(", 
           FractionBox[
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", 
                SuperscriptBox["MSM", "2"]}], "-", 
               SuperscriptBox["Q", "2"], "+", 
               SqrtBox[
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   SuperscriptBox["Q", "2"], "-", 
                   RowBox[{"4", " ", 
                    SuperscriptBox["MDM", "2"]}]}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   SuperscriptBox["Q", "2"], "-", 
                   RowBox[{"4", " ", 
                    SuperscriptBox["MSM", "2"]}]}], ")"}]}]]}], ")"}], "2"], 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "2"}], " ", 
                SuperscriptBox["MSM", "2"]}], "+", 
               SuperscriptBox["Q", "2"], "+", 
               SqrtBox[
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   SuperscriptBox["Q", "2"], "-", 
                   RowBox[{"4", " ", 
                    SuperscriptBox["MDM", "2"]}]}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   SuperscriptBox["Q", "2"], "-", 
                   RowBox[{"4", " ", 
                    SuperscriptBox["MSM", "2"]}]}], ")"}]}]]}], ")"}], "2"]], 
           ")"}]}]}], ")"}]}], 
      RowBox[{"32", " ", "\[Pi]", " ", 
       SuperscriptBox["Q", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["Q", "2"], "-", 
         RowBox[{"4", " ", 
          SuperscriptBox["MDM", "2"]}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["Q", "2"], "-", 
         RowBox[{"2", " ", 
          SuperscriptBox["MSM", "2"]}]}], ")"}]}]]}]}], "}"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{3.792696932528276*^9},
 CellLabel->
  "Out[393]=",ExpressionUUID->"dac14522-5624-4966-8164-fd31b5d04973"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ConstructEfficientCExpression", "[", 
  RowBox[{"amps", ",", "temp"}], "]"}]], "Input",
 CellLabel->
  "In[392]:=",ExpressionUUID->"bce71492-8663-4745-807d-22598ba3dab7"],

Cell[BoxData[
 FormBox["\<\"double my_function(){\\n\\tdouble temp1 = \
pow(MH,2);\\n\\tdouble temp2 = pow(Q,2);\\n\\tdouble temp3 = \
pow(ms,2);\\n\\tdouble temp4 = pow(gsxx,2);\\n\\tdouble temp5 = \
1/M_PI;\\n\\tdouble temp6 = pow(Q,-2);\\n\\tdouble temp7 = \
pow(mx,2);\\n\\tdouble temp8 = -4*temp7;\\n\\tdouble temp9 = temp2 + \
temp8;\\n\\tdouble temp10 = -4*temp3;\\n\\tdouble temp11 = temp10 + temp2;\\n\
\\tdouble temp12 = temp11*temp9;\\n\\tdouble temp13 = \
sqrt(temp12);\\n\\tdouble temp14 = -1 + smix;\\n\\tdouble temp15 = \
pow(smix,6);\\n\\tdouble temp16 = 1 + smix;\\n\\tdouble temp17 = \
pow(VH,-2);\\n\\tdouble temp18 = -temp2;\\n\\tdouble temp19 = \
pow(ms,4);\\n\\tdouble temp20 = 2*temp3;\\n\\tdouble temp21 = \
-2*temp3;\\n\\tdouble temp22 = pow(gsxx,4);\\n\\tdouble temp23 = \
1/temp9;\\n\\tdouble temp24 = pow(smix,2);\\n\\tdouble temp25 = -1 + \
temp24;\\n\\tdouble temp26 = pow(temp25,2);\\n\\tdouble temp27 = \
pow(mx,4);\\n\\tdouble temp28 = 16*temp27;\\n\\tdouble temp29 = \
2*temp19;\\n\\tdouble temp30 = -12*temp3;\\n\\tdouble temp31 = temp2 + \
temp30;\\n\\tdouble temp32 = temp31*temp7;\\n\\tdouble temp33 = temp28 + \
temp29 + temp32;\\n\\tdouble temp34 = temp11*temp7;\\n\\tdouble temp35 = \
temp19 + temp34;\\n\\tdouble temp36 = 1/temp35;\\n\\tdouble temp37 = \
temp13*temp33*temp36;\\n\\tdouble temp38 = 8*temp7;\\n\\tdouble temp39 = \
temp2 + temp21 + temp38;\\n\\tdouble temp40 = temp13 + temp18 + \
temp20;\\n\\tdouble temp41 = 1/temp40;\\n\\tdouble temp42 = temp13 + temp2 + \
temp21;\\n\\tdouble temp43 = -(temp41*temp42);\\n\\tdouble temp44 = \
log(temp43);\\n\\tdouble temp45 = -(temp39*temp44);\\n\\tdouble temp46 = \
temp37 + temp45;\\n\\tdouble temp47 = \
-(temp22*temp23*temp26*temp46*temp5*temp6)/64.;\\n\\tdouble temp48 = temp1 + \
temp20;\\n\\tdouble temp49 = temp18 + temp3;\\n\\tdouble temp50 = \
pow(temp49,2);\\n\\tdouble temp51 = pow(widthS,2);\\n\\tdouble temp52 = \
temp3*temp51;\\n\\tdouble temp53 = temp50 + temp52;\\n\\tdouble temp54 = \
1/temp53;\\n\\tdouble temp55 = -temp1;\\n\\tdouble temp56 = temp2 + \
temp55;\\n\\tdouble temp57 = 1/temp56;\\n\\tdouble temp58 = \
pow(gsxx,3);\\n\\tdouble temp59 = temp1 + temp18;\\n\\tdouble temp60 = \
pow(smix,3);\\n\\tdouble temp61 = -temp24;\\n\\tdouble temp62 = 1 + \
temp61;\\n\\tdouble temp63 = pow(temp62,1.5);\\n\\tdouble temp64 = \
1/VH;\\n\\tdouble temp65 = temp18 + temp21 + temp38;\\n\\tdouble temp66 = -Q;\
\\n\\tdouble temp67 = ms + temp66;\\n\\tdouble temp68 = ms + Q;\\n\\tdouble \
temp69 = 4*temp7;\\n\\tdouble temp70 = temp18 + temp69;\\n\\tdouble temp71 = \
4*temp3;\\n\\tdouble temp72 = temp18 + temp71;\\n\\tdouble temp73 = \
temp70*temp72;\\n\\tdouble temp74 = sqrt(temp73);\\n\\tdouble temp75 = \
-8*temp7;\\n\\tdouble temp76 = temp2 + temp20 + temp75;\\n\\tdouble temp77 = \
-temp13;\\n\\tdouble temp78 = temp2 + temp21 + temp77;\\n\\tdouble temp79 = \
1/temp42;\\n\\tdouble temp80 = temp78*temp79;\\n\\tdouble temp81 = \
log(temp80);\\n\\tdouble temp82 = temp2 + temp21;\\n\\treturn \
List(-(temp13*temp14*temp15*temp16*temp17*temp4*pow(temp48,2)*temp5*temp6)/(\
64.*pow(temp59,2)),(-9*temp13*temp14*temp15*temp16*temp17*temp19*temp4*temp5*\
temp54*temp6)/64.,temp47,temp47,(-3*temp15*temp17*temp25*temp3*temp4*temp48*\
temp5*temp54*temp57*temp6*temp67*temp68*sqrt(-(temp11*temp70)))/32.,(mx*\
temp23*temp48*temp5*temp57*temp58*temp6*temp60*temp63*temp64*(-2*temp13 + \
temp44*temp65))/32.,(mx*temp23*temp48*temp5*temp58*temp6*temp60*temp63*temp64*\
(2*temp13 + \
temp65*temp81))/(32.*temp59),(-3*mx*temp23*temp3*temp5*temp54*temp58*temp6*\
temp60*temp63*temp64*temp67*temp68*(2*temp74 + \
temp44*temp76))/32.,(3*mx*temp23*temp3*temp5*temp54*temp58*temp6*temp60*\
temp63*temp64*temp67*temp68*(-2*temp74 + \
temp76*temp81))/32.,-(temp22*temp23*temp26*temp5*temp6*(temp13*temp82 + \
(temp19 - 16*temp27 + \
4*temp2*temp7)*log(pow(temp40,2)/pow(temp42,2))))/(32.*temp82));\\n}\"\>", 
  TraditionalForm]], "Output",
 CellChangeTimes->{3.792696892780991*^9},
 CellLabel->
  "Out[392]=",ExpressionUUID->"9d02acee-35f5-4ab6-b828-187b410dfe4e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Length", "[", "amps", "]"}]], "Input",
 CellChangeTimes->{{3.792697062914526*^9, 3.79269706745564*^9}},
 CellLabel->
  "In[394]:=",ExpressionUUID->"456b5ed7-98fe-45eb-9bd8-814122e188ff"],

Cell[BoxData[
 FormBox["10", TraditionalForm]], "Output",
 CellChangeTimes->{3.7926970678482037`*^9},
 CellLabel->
  "Out[394]=",ExpressionUUID->"750eb887-22e0-46ed-b62f-1adfef1fc8d9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "1"}], ",", 
   RowBox[{"i", "\[LessEqual]", 
    RowBox[{"Length", "[", "amps", "]"}]}], ",", 
   RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"Not", "[", 
      RowBox[{"FreeQ", "[", 
       RowBox[{
        RowBox[{"amps", "[", 
         RowBox[{"[", "i", "]"}], "]"}], ",", 
        SuperscriptBox["gSXX", "2"]}], "]"}], "]"}], ",", 
     RowBox[{"Print", "[", 
      RowBox[{"i", "-", "1"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellChangeTimes->{{3.792696512723811*^9, 3.792696562430929*^9}, {
  3.7926966925551434`*^9, 3.792696700373394*^9}, {3.792697079047243*^9, 
  3.7926970791813173`*^9}},
 CellLabel->
  "In[396]:=",ExpressionUUID->"68ae9de9-d84f-45ee-a6f2-7ab6a292939a"],

Cell[CellGroupData[{

Cell[BoxData[
 FormBox["0", TraditionalForm]], "Print",
 CellChangeTimes->{
  3.792696563071661*^9, 3.792696696666027*^9, {3.792697071087324*^9, 
   3.7926970795231524`*^9}},
 CellLabel->
  "During evaluation of \
In[396]:=",ExpressionUUID->"e321e611-cd9d-47fb-a18f-0fce342fa1f0"],

Cell[BoxData[
 FormBox["1", TraditionalForm]], "Print",
 CellChangeTimes->{
  3.792696563071661*^9, 3.792696696666027*^9, {3.792697071087324*^9, 
   3.7926970795247583`*^9}},
 CellLabel->
  "During evaluation of \
In[396]:=",ExpressionUUID->"ad0ddceb-5f95-440f-a9a3-8d54c217f831"],

Cell[BoxData[
 FormBox["4", TraditionalForm]], "Print",
 CellChangeTimes->{
  3.792696563071661*^9, 3.792696696666027*^9, {3.792697071087324*^9, 
   3.7926970795285673`*^9}},
 CellLabel->
  "During evaluation of \
In[396]:=",ExpressionUUID->"520d73f6-c4d2-4323-bdf4-4fb3b84c3c50"]
}, Open  ]]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"arr", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "1"}], ",", 
   RowBox[{"i", "\[LessEqual]", 
    RowBox[{"Length", "[", "amps", "]"}]}], ",", 
   RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"FreeQ", "[", 
      RowBox[{
       RowBox[{"amps", "[", 
        RowBox[{"[", "i", "]"}], "]"}], ",", 
       RowBox[{
        SuperscriptBox["gSXX", "2"], "|", 
        SuperscriptBox["gSXX", "3"]}]}], "]"}], ",", 
     RowBox[{"AppendTo", "[", 
      RowBox[{"arr", ",", 
       RowBox[{"i", "-", "1"}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
  "]"}]}], "Input",
 CellChangeTimes->{{3.792696602784137*^9, 3.7926966563444633`*^9}, {
  3.792696702103253*^9, 3.792696705985498*^9}},
 CellLabel->
  "In[397]:=",ExpressionUUID->"815fa800-142a-4089-931a-6a671570502d"],

Cell[CellGroupData[{

Cell[BoxData["arr"], "Input",
 CellChangeTimes->{{3.7926966409387627`*^9, 3.792696641241529*^9}},
 CellLabel->
  "In[399]:=",ExpressionUUID->"93dc6621-270f-47d2-8b8f-acdf7e84efb3"],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{"2", ",", "3", ",", "9"}], "}"}], TraditionalForm]], "Output",
 CellChangeTimes->{{3.792696641558386*^9, 3.792696658430687*^9}, 
   3.792696707752982*^9, 3.792697090369402*^9},
 CellLabel->
  "Out[399]=",ExpressionUUID->"2d7ef630-93b5-429b-a5b0-d7858839eacf"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"amps", "=", 
  RowBox[{"Map", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"FullSimplify", "[", 
      RowBox[{"#", ",", 
       RowBox[{"Assumptions", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Q", ">", 
           RowBox[{"2", "*", "MH"}], ">", "0"}], ",", 
          RowBox[{"Q", ">", 
           RowBox[{"2", "*", "ms"}], ">", "0"}]}], "}"}]}]}], "]"}], "&"}], 
    ",", "amps"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.79269589668609*^9, 3.792695905166171*^9}, {
  3.7926959489257517`*^9, 3.792695956700169*^9}, {3.7926959923004837`*^9, 
  3.792696007531267*^9}},
 CellLabel->
  "In[374]:=",ExpressionUUID->"0db851ed-5111-402f-affe-4b34d3e37498"],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{"9", " ", 
       SuperscriptBox["gSXX", "2"], " ", 
       SuperscriptBox["MH", "4"], " ", 
       SqrtBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["Q", "2"], "-", 
           RowBox[{"4", " ", 
            SuperscriptBox["MDM", "2"]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["Q", "2"], "-", 
           RowBox[{"4", " ", 
            SuperscriptBox["MH", "2"]}]}], ")"}]}]], " ", 
       SuperscriptBox["smix", "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["smix", "2"], "-", "1"}], ")"}], "3"]}], 
      RowBox[{"64", " ", "\[Pi]", " ", 
       SuperscriptBox["Q", "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["MH", "2"], "-", 
          SuperscriptBox["Q", "2"]}], ")"}], "2"], " ", 
       SuperscriptBox["vev", "2"]}]]}], ",", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{
       SuperscriptBox["gSXX", "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", 
           SuperscriptBox["MH", "2"]}], "+", 
          SuperscriptBox["MSM", "2"]}], ")"}], "2"], " ", 
       SqrtBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["Q", "2"], "-", 
           RowBox[{"4", " ", 
            SuperscriptBox["MDM", "2"]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["Q", "2"], "-", 
           RowBox[{"4", " ", 
            SuperscriptBox["MH", "2"]}]}], ")"}]}]], " ", 
       SuperscriptBox["smix", "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["smix", "2"], "-", "1"}], ")"}], "3"]}], 
      RowBox[{"64", " ", "\[Pi]", " ", 
       SuperscriptBox["Q", "2"], " ", 
       SuperscriptBox["vev", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["MSM", "2"], "-", 
            SuperscriptBox["Q", "2"]}], ")"}], "2"], "+", 
         RowBox[{
          SuperscriptBox["MSM", "2"], " ", 
          SuperscriptBox["\[CapitalGamma]SM", "2"]}]}], ")"}]}]]}], ",", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{
       SuperscriptBox["gSXX", "4"], " ", 
       SuperscriptBox["smix", "4"], " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{
           SqrtBox[
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["Q", "2"], "-", 
               RowBox[{"4", " ", 
                SuperscriptBox["MDM", "2"]}]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["Q", "2"], "-", 
               RowBox[{"4", " ", 
                SuperscriptBox["MH", "2"]}]}], ")"}]}]], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"16", " ", 
              SuperscriptBox["MDM", "4"]}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["Q", "2"], "-", 
                RowBox[{"12", " ", 
                 SuperscriptBox["MH", "2"]}]}], ")"}], " ", 
              SuperscriptBox["MDM", "2"]}], "+", 
             RowBox[{"2", " ", 
              SuperscriptBox["MH", "4"]}]}], ")"}]}], 
          RowBox[{
           SuperscriptBox["MH", "4"], "+", 
           RowBox[{
            SuperscriptBox["MDM", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["Q", "2"], "-", 
              RowBox[{"4", " ", 
               SuperscriptBox["MH", "2"]}]}], ")"}]}]}]], "+", 
         RowBox[{"log", "(", 
          FractionBox[
           RowBox[{
            RowBox[{
             RowBox[{"-", "2"}], " ", 
             SuperscriptBox["MH", "2"]}], "+", 
            SuperscriptBox["Q", "2"], "-", 
            SqrtBox[
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["Q", "2"], "-", 
                RowBox[{"4", " ", 
                 SuperscriptBox["MDM", "2"]}]}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["Q", "2"], "-", 
                RowBox[{"4", " ", 
                 SuperscriptBox["MH", "2"]}]}], ")"}]}]]}], 
           RowBox[{
            RowBox[{
             RowBox[{"-", "2"}], " ", 
             SuperscriptBox["MH", "2"]}], "+", 
            SuperscriptBox["Q", "2"], "+", 
            SqrtBox[
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["Q", "2"], "-", 
                RowBox[{"4", " ", 
                 SuperscriptBox["MDM", "2"]}]}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["Q", "2"], "-", 
                RowBox[{"4", " ", 
                 SuperscriptBox["MH", "2"]}]}], ")"}]}]]}]], ")"}]}], ")"}]}], 
      RowBox[{"64", " ", "\[Pi]", " ", 
       SuperscriptBox["Q", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["Q", "2"], "-", 
         RowBox[{"4", " ", 
          SuperscriptBox["MDM", "2"]}]}], ")"}]}]]}], ",", 
    FractionBox[
     RowBox[{
      SuperscriptBox["gSXX", "4"], " ", 
      SuperscriptBox["smix", "4"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"log", "(", 
         RowBox[{"-", 
          FractionBox[
           RowBox[{
            RowBox[{
             RowBox[{"-", "2"}], " ", 
             SuperscriptBox["MH", "2"]}], "+", 
            SuperscriptBox["Q", "2"], "+", 
            SqrtBox[
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["Q", "2"], "-", 
                RowBox[{"4", " ", 
                 SuperscriptBox["MDM", "2"]}]}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["Q", "2"], "-", 
                RowBox[{"4", " ", 
                 SuperscriptBox["MH", "2"]}]}], ")"}]}]]}], 
           RowBox[{
            RowBox[{"2", " ", 
             SuperscriptBox["MH", "2"]}], "-", 
            SuperscriptBox["Q", "2"], "+", 
            SqrtBox[
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["Q", "2"], "-", 
                RowBox[{"4", " ", 
                 SuperscriptBox["MDM", "2"]}]}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["Q", "2"], "-", 
                RowBox[{"4", " ", 
                 SuperscriptBox["MH", "2"]}]}], ")"}]}]]}]]}], ")"}], "-", 
        FractionBox[
         RowBox[{
          SqrtBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["Q", "2"], "-", 
              RowBox[{"4", " ", 
               SuperscriptBox["MDM", "2"]}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["Q", "2"], "-", 
              RowBox[{"4", " ", 
               SuperscriptBox["MH", "2"]}]}], ")"}]}]], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"16", " ", 
             SuperscriptBox["MDM", "4"]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["Q", "2"], "-", 
               RowBox[{"12", " ", 
                SuperscriptBox["MH", "2"]}]}], ")"}], " ", 
             SuperscriptBox["MDM", "2"]}], "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["MH", "4"]}]}], ")"}]}], 
         RowBox[{
          SuperscriptBox["MH", "4"], "+", 
          RowBox[{
           SuperscriptBox["MDM", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["Q", "2"], "-", 
             RowBox[{"4", " ", 
              SuperscriptBox["MH", "2"]}]}], ")"}]}]}]]}], ")"}]}], 
     RowBox[{"64", " ", "\[Pi]", " ", 
      SuperscriptBox["Q", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["Q", "2"], "-", 
        RowBox[{"4", " ", 
         SuperscriptBox["MDM", "2"]}]}], ")"}]}]], ",", 
    FractionBox[
     RowBox[{"3", " ", 
      SuperscriptBox["gSXX", "2"], " ", 
      SuperscriptBox["MH", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", 
         SuperscriptBox["MH", "2"]}], "+", 
        SuperscriptBox["MSM", "2"]}], ")"}], " ", 
      SqrtBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["Q", "2"], "-", 
          RowBox[{"4", " ", 
           SuperscriptBox["MDM", "2"]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["Q", "2"], "-", 
          RowBox[{"4", " ", 
           SuperscriptBox["MH", "2"]}]}], ")"}]}]], " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["Q", "2"], "-", 
        SuperscriptBox["MSM", "2"]}], ")"}], " ", 
      SuperscriptBox["smix", "2"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["smix", "2"], "-", "1"}], ")"}], "3"]}], 
     RowBox[{"32", " ", "\[Pi]", " ", 
      SuperscriptBox["Q", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["Q", "2"], "-", 
        SuperscriptBox["MH", "2"]}], ")"}], " ", 
      SuperscriptBox["vev", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["MSM", "2"], "-", 
           SuperscriptBox["Q", "2"]}], ")"}], "2"], "+", 
        RowBox[{
         SuperscriptBox["MSM", "2"], " ", 
         SuperscriptBox["\[CapitalGamma]SM", "2"]}]}], ")"}]}]], ",", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{"3", " ", 
       SuperscriptBox["gSXX", "3"], " ", "MDM", " ", 
       SuperscriptBox["MH", "2"], " ", 
       SuperscriptBox["smix", "3"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", 
          SuperscriptBox["smix", "2"]}], ")"}], 
        RowBox[{"3", "/", "2"}]], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "8"}], " ", 
             SuperscriptBox["MDM", "2"]}], "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["MH", "2"]}], "+", 
            SuperscriptBox["Q", "2"]}], ")"}], " ", 
          RowBox[{"log", "(", 
           RowBox[{"-", 
            FractionBox[
             RowBox[{
              RowBox[{
               RowBox[{"-", "2"}], " ", 
               SuperscriptBox["MH", "2"]}], "+", 
              SuperscriptBox["Q", "2"], "+", 
              SqrtBox[
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["Q", "2"], "-", 
                  RowBox[{"4", " ", 
                   SuperscriptBox["MDM", "2"]}]}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["Q", "2"], "-", 
                  RowBox[{"4", " ", 
                   SuperscriptBox["MH", "2"]}]}], ")"}]}]]}], 
             RowBox[{
              RowBox[{"2", " ", 
               SuperscriptBox["MH", "2"]}], "-", 
              SuperscriptBox["Q", "2"], "+", 
              SqrtBox[
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["Q", "2"], "-", 
                  RowBox[{"4", " ", 
                   SuperscriptBox["MDM", "2"]}]}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["Q", "2"], "-", 
                  RowBox[{"4", " ", 
                   SuperscriptBox["MH", "2"]}]}], ")"}]}]]}]]}], ")"}]}], "+", 
         RowBox[{"2", " ", 
          SqrtBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["Q", "2"], "-", 
              RowBox[{"4", " ", 
               SuperscriptBox["MDM", "2"]}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["Q", "2"], "-", 
              RowBox[{"4", " ", 
               SuperscriptBox["MH", "2"]}]}], ")"}]}]]}]}], ")"}]}], 
      RowBox[{"32", " ", "\[Pi]", " ", 
       SuperscriptBox["Q", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["Q", "2"], "-", 
         RowBox[{"4", " ", 
          SuperscriptBox["MDM", "2"]}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["Q", "2"], "-", 
         SuperscriptBox["MH", "2"]}], ")"}], " ", "vev"}]]}], ",", 
    FractionBox[
     RowBox[{"3", " ", 
      SuperscriptBox["gSXX", "3"], " ", "MDM", " ", 
      SuperscriptBox["MH", "2"], " ", 
      SuperscriptBox["smix", "3"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SuperscriptBox["smix", "2"]}], ")"}], 
       RowBox[{"3", "/", "2"}]], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"8", " ", 
            SuperscriptBox["MDM", "2"]}], "-", 
           RowBox[{"2", " ", 
            SuperscriptBox["MH", "2"]}], "-", 
           SuperscriptBox["Q", "2"]}], ")"}], " ", 
         RowBox[{"log", "(", 
          FractionBox[
           RowBox[{
            RowBox[{
             RowBox[{"-", "2"}], " ", 
             SuperscriptBox["MH", "2"]}], "+", 
            SuperscriptBox["Q", "2"], "-", 
            SqrtBox[
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["Q", "2"], "-", 
                RowBox[{"4", " ", 
                 SuperscriptBox["MDM", "2"]}]}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["Q", "2"], "-", 
                RowBox[{"4", " ", 
                 SuperscriptBox["MH", "2"]}]}], ")"}]}]]}], 
           RowBox[{
            RowBox[{
             RowBox[{"-", "2"}], " ", 
             SuperscriptBox["MH", "2"]}], "+", 
            SuperscriptBox["Q", "2"], "+", 
            SqrtBox[
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["Q", "2"], "-", 
                RowBox[{"4", " ", 
                 SuperscriptBox["MDM", "2"]}]}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["Q", "2"], "-", 
                RowBox[{"4", " ", 
                 SuperscriptBox["MH", "2"]}]}], ")"}]}]]}]], ")"}]}], "+", 
        RowBox[{"2", " ", 
         SqrtBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["Q", "2"], "-", 
             RowBox[{"4", " ", 
              SuperscriptBox["MDM", "2"]}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["Q", "2"], "-", 
             RowBox[{"4", " ", 
              SuperscriptBox["MH", "2"]}]}], ")"}]}]]}]}], ")"}]}], 
     RowBox[{"32", " ", "\[Pi]", " ", 
      SuperscriptBox["Q", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["MH", "2"], "-", 
        SuperscriptBox["Q", "2"]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["Q", "2"], "-", 
        RowBox[{"4", " ", 
         SuperscriptBox["MDM", "2"]}]}], ")"}], " ", "vev"}]], ",", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{
       SuperscriptBox["gSXX", "3"], " ", "MDM", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", 
          SuperscriptBox["MH", "2"]}], "+", 
         SuperscriptBox["MSM", "2"]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"MSM", "-", "Q"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"MSM", "+", "Q"}], ")"}], " ", 
       SuperscriptBox["smix", "3"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", 
          SuperscriptBox["smix", "2"]}], ")"}], 
        RowBox[{"3", "/", "2"}]], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "8"}], " ", 
             SuperscriptBox["MDM", "2"]}], "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["MH", "2"]}], "+", 
            SuperscriptBox["Q", "2"]}], ")"}], " ", 
          RowBox[{"log", "(", 
           RowBox[{"-", 
            FractionBox[
             RowBox[{
              RowBox[{
               RowBox[{"-", "2"}], " ", 
               SuperscriptBox["MH", "2"]}], "+", 
              SuperscriptBox["Q", "2"], "+", 
              SqrtBox[
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["Q", "2"], "-", 
                  RowBox[{"4", " ", 
                   SuperscriptBox["MDM", "2"]}]}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["Q", "2"], "-", 
                  RowBox[{"4", " ", 
                   SuperscriptBox["MH", "2"]}]}], ")"}]}]]}], 
             RowBox[{
              RowBox[{"2", " ", 
               SuperscriptBox["MH", "2"]}], "-", 
              SuperscriptBox["Q", "2"], "+", 
              SqrtBox[
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["Q", "2"], "-", 
                  RowBox[{"4", " ", 
                   SuperscriptBox["MDM", "2"]}]}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["Q", "2"], "-", 
                  RowBox[{"4", " ", 
                   SuperscriptBox["MH", "2"]}]}], ")"}]}]]}]]}], ")"}]}], "+", 
         RowBox[{"2", " ", 
          SqrtBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["Q", "2"], "-", 
              RowBox[{"4", " ", 
               SuperscriptBox["MDM", "2"]}]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["Q", "2"], "-", 
              RowBox[{"4", " ", 
               SuperscriptBox["MH", "2"]}]}], ")"}]}]]}]}], ")"}]}], 
      RowBox[{"32", " ", "\[Pi]", " ", 
       SuperscriptBox["Q", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["Q", "2"], "-", 
         RowBox[{"4", " ", 
          SuperscriptBox["MDM", "2"]}]}], ")"}], " ", "vev", " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["MSM", "2"], "-", 
            SuperscriptBox["Q", "2"]}], ")"}], "2"], "+", 
         RowBox[{
          SuperscriptBox["MSM", "2"], " ", 
          SuperscriptBox["\[CapitalGamma]SM", "2"]}]}], ")"}]}]]}], ",", 
    FractionBox[
     RowBox[{
      SuperscriptBox["gSXX", "3"], " ", "MDM", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", 
         SuperscriptBox["MH", "2"]}], "+", 
        SuperscriptBox["MSM", "2"]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"MSM", "-", "Q"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"MSM", "+", "Q"}], ")"}], " ", 
      SuperscriptBox["smix", "3"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SuperscriptBox["smix", "2"]}], ")"}], 
       RowBox[{"3", "/", "2"}]], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "8"}], " ", 
            SuperscriptBox["MDM", "2"]}], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["MH", "2"]}], "+", 
           SuperscriptBox["Q", "2"]}], ")"}], " ", 
         RowBox[{"log", "(", 
          FractionBox[
           RowBox[{
            RowBox[{
             RowBox[{"-", "2"}], " ", 
             SuperscriptBox["MH", "2"]}], "+", 
            SuperscriptBox["Q", "2"], "-", 
            SqrtBox[
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["Q", "2"], "-", 
                RowBox[{"4", " ", 
                 SuperscriptBox["MDM", "2"]}]}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["Q", "2"], "-", 
                RowBox[{"4", " ", 
                 SuperscriptBox["MH", "2"]}]}], ")"}]}]]}], 
           RowBox[{
            RowBox[{
             RowBox[{"-", "2"}], " ", 
             SuperscriptBox["MH", "2"]}], "+", 
            SuperscriptBox["Q", "2"], "+", 
            SqrtBox[
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["Q", "2"], "-", 
                RowBox[{"4", " ", 
                 SuperscriptBox["MDM", "2"]}]}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["Q", "2"], "-", 
                RowBox[{"4", " ", 
                 SuperscriptBox["MH", "2"]}]}], ")"}]}]]}]], ")"}]}], "-", 
        RowBox[{"2", " ", 
         SqrtBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["Q", "2"], "-", 
             RowBox[{"4", " ", 
              SuperscriptBox["MDM", "2"]}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["Q", "2"], "-", 
             RowBox[{"4", " ", 
              SuperscriptBox["MH", "2"]}]}], ")"}]}]]}]}], ")"}]}], 
     RowBox[{"32", " ", "\[Pi]", " ", 
      SuperscriptBox["Q", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["Q", "2"], "-", 
        RowBox[{"4", " ", 
         SuperscriptBox["MDM", "2"]}]}], ")"}], " ", "vev", " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["MSM", "2"], "-", 
           SuperscriptBox["Q", "2"]}], ")"}], "2"], "+", 
        RowBox[{
         SuperscriptBox["MSM", "2"], " ", 
         SuperscriptBox["\[CapitalGamma]SM", "2"]}]}], ")"}]}]], ",", 
    FractionBox[
     RowBox[{
      SuperscriptBox["gSXX", "4"], " ", 
      SuperscriptBox["smix", "4"], " ", 
      RowBox[{"(", 
       RowBox[{
        FractionBox[
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "16"}], " ", 
             SuperscriptBox["MDM", "4"]}], "+", 
            RowBox[{"4", " ", 
             SuperscriptBox["Q", "2"], " ", 
             SuperscriptBox["MDM", "2"]}], "+", 
            SuperscriptBox["MH", "4"]}], ")"}], " ", 
          RowBox[{"log", "(", 
           RowBox[{"16", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["MH", "4"], "+", 
               RowBox[{
                SuperscriptBox["MDM", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["Q", "2"], "-", 
                  RowBox[{"4", " ", 
                   SuperscriptBox["MH", "2"]}]}], ")"}]}]}], ")"}], "2"]}], 
           ")"}]}], 
         RowBox[{
          SuperscriptBox["Q", "2"], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["MH", "2"]}]}]], "-", 
        SqrtBox[
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["Q", "2"], "-", 
            RowBox[{"4", " ", 
             SuperscriptBox["MDM", "2"]}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["Q", "2"], "-", 
            RowBox[{"4", " ", 
             SuperscriptBox["MH", "2"]}]}], ")"}]}]]}], ")"}]}], 
     RowBox[{"32", " ", "\[Pi]", " ", 
      SuperscriptBox["Q", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["Q", "2"], "-", 
        RowBox[{"4", " ", 
         SuperscriptBox["MDM", "2"]}]}], ")"}]}]]}], "}"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{3.792695916027964*^9, 3.792695967127449*^9, 
  3.792696028077128*^9},
 CellLabel->
  "Out[374]=",ExpressionUUID->"0a4fbfe9-2dfb-4d00-ba0a-918ece6a212d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ConstructEfficientCExpression", "[", 
  RowBox[{"amps", ",", "temp"}], "]"}]], "Input",
 CellChangeTimes->{{3.79269610939048*^9, 3.792696119489555*^9}},
 CellLabel->
  "In[375]:=",ExpressionUUID->"549f05dd-1a08-4421-ae46-8f467b015c13"],

Cell[BoxData[
 FormBox["\<\"double my_function(){\\n\\tdouble temp1 = pow(Q,2);\\n\\tdouble \
temp2 = pow(MH,2);\\n\\tdouble temp3 = pow(smix,2);\\n\\tdouble temp4 = \
pow(gsxx,2);\\n\\tdouble temp5 = 1/M_PI;\\n\\tdouble temp6 = \
pow(Q,-2);\\n\\tdouble temp7 = pow(mx,2);\\n\\tdouble temp8 = \
-4*temp7;\\n\\tdouble temp9 = temp1 + temp8;\\n\\tdouble temp10 = \
-4*temp2;\\n\\tdouble temp11 = temp1 + temp10;\\n\\tdouble temp12 = \
temp11*temp9;\\n\\tdouble temp13 = sqrt(temp12);\\n\\tdouble temp14 = -1 + \
temp3;\\n\\tdouble temp15 = pow(temp14,3);\\n\\tdouble temp16 = \
pow(VH,-2);\\n\\tdouble temp17 = pow(ms,2);\\n\\tdouble temp18 = \
-temp1;\\n\\tdouble temp19 = pow(MH,4);\\n\\tdouble temp20 = \
-2*temp2;\\n\\tdouble temp21 = pow(gsxx,4);\\n\\tdouble temp22 = \
1/temp9;\\n\\tdouble temp23 = pow(smix,4);\\n\\tdouble temp24 = pow(mx,4);\\n\
\\tdouble temp25 = 16*temp24;\\n\\tdouble temp26 = 2*temp19;\\n\\tdouble \
temp27 = -12*temp2;\\n\\tdouble temp28 = temp1 + temp27;\\n\\tdouble temp29 = \
temp28*temp7;\\n\\tdouble temp30 = temp25 + temp26 + temp29;\\n\\tdouble \
temp31 = temp11*temp7;\\n\\tdouble temp32 = temp19 + temp31;\\n\\tdouble \
temp33 = 1/temp32;\\n\\tdouble temp34 = 2*temp2;\\n\\tdouble temp35 = temp1 + \
temp13 + temp20;\\n\\tdouble temp36 = temp17 + temp34;\\n\\tdouble temp37 = \
temp17 + temp18;\\n\\tdouble temp38 = pow(temp37,2);\\n\\tdouble temp39 = \
pow(widthS,2);\\n\\tdouble temp40 = temp17*temp39;\\n\\tdouble temp41 = \
temp38 + temp40;\\n\\tdouble temp42 = 1/temp41;\\n\\tdouble temp43 = \
-temp2;\\n\\tdouble temp44 = temp1 + temp43;\\n\\tdouble temp45 = \
1/temp44;\\n\\tdouble temp46 = temp13 + temp18 + temp34;\\n\\tdouble temp47 = \
1/temp46;\\n\\tdouble temp48 = -(temp35*temp47);\\n\\tdouble temp49 = \
log(temp48);\\n\\tdouble temp50 = pow(gsxx,3);\\n\\tdouble temp51 = temp18 + \
temp2;\\n\\tdouble temp52 = pow(smix,3);\\n\\tdouble temp53 = \
-temp3;\\n\\tdouble temp54 = 1 + temp53;\\n\\tdouble temp55 = \
pow(temp54,1.5);\\n\\tdouble temp56 = 1/VH;\\n\\tdouble temp57 = 2*temp13;\\n\
\\tdouble temp58 = -temp13;\\n\\tdouble temp59 = temp1 + temp20 + \
temp58;\\n\\tdouble temp60 = 1/temp35;\\n\\tdouble temp61 = temp59*temp60;\\n\
\\tdouble temp62 = log(temp61);\\n\\tdouble temp63 = -8*temp7;\\n\\tdouble \
temp64 = temp1 + temp34 + temp63;\\n\\tdouble temp65 = \
temp49*temp64;\\n\\tdouble temp66 = temp57 + temp65;\\n\\tdouble temp67 = -Q;\
\\n\\tdouble temp68 = ms + temp67;\\n\\tdouble temp69 = ms + Q;\\n\\treturn \
List((-9*temp13*temp15*temp16*temp19*temp3*temp4*temp5*temp6)/(64.*pow(temp51,\
2)),-(temp13*temp15*temp16*temp3*pow(temp36,2)*temp4*temp42*temp5*temp6)/64.,-\
(temp21*temp22*temp23*temp5*temp6*(temp13*temp30*temp33 + \
temp62))/64.,(temp21*temp22*temp23*(-(temp13*temp30*temp33) + \
temp49)*temp5*temp6)/64.,(3*temp13*temp15*temp16*(temp1 - \
temp17)*temp2*temp3*temp36*temp4*temp42*temp45*temp5*temp6)/32.,(-3*mx*temp2*\
temp22*temp45*temp5*temp50*temp52*temp55*temp56*temp6*temp66)/32.,(3*mx*temp2*\
temp22*temp5*temp50*temp52*temp55*temp56*temp6*(temp57 + temp62*(temp18 + \
temp20 + 8*temp7)))/(32.*temp51),-(mx*temp22*temp36*temp42*temp5*temp50*\
temp52*temp55*temp56*temp6*temp66*temp68*temp69)/32.,(mx*temp22*temp36*temp42*\
temp5*temp50*temp52*temp55*temp56*temp6*(-2*temp13 + \
temp62*temp64)*temp68*temp69)/32.,(temp21*temp22*temp23*temp5*temp6*(temp58 + \
((temp19 - 16*temp24 + 4*temp1*temp7)*log(16*pow(temp32,2)))/(temp1 + \
temp20)))/32.);\\n}\"\>", TraditionalForm]], "Output",
 CellChangeTimes->{3.792696119951009*^9},
 CellLabel->
  "Out[375]=",ExpressionUUID->"b0bf59a9-8d09-4cc3-9f65-39c9ad098623"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Collect", "[", 
  RowBox[{
   RowBox[{"Total", "[", "amps", "]"}], ",", "gSXX", ",", 
   RowBox[{
    RowBox[{"Simplify", "[", 
     RowBox[{"SimplifyLogs", "[", 
      RowBox[{"FullSimplify", "[", 
       RowBox[{"SimplifyLogs", "[", 
        RowBox[{"Simplify", "[", "#", "]"}], "]"}], "]"}], "]"}], "]"}], 
    "&"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.792695346857546*^9, 3.7926954877979403`*^9}, {
  3.7926955911365547`*^9, 3.792695660038177*^9}},
 CellLabel->
  "In[371]:=",ExpressionUUID->"fe40ef58-1f26-4dd0-b516-8304b7fd0478"],

Cell[BoxData[
 FormBox[
  RowBox[{
   FractionBox[
    RowBox[{
     SuperscriptBox["gSXX", "4"], " ", 
     SuperscriptBox["smix", "4"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"log", "(", 
        FractionBox[
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            SqrtBox[
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["Q", "2"], "-", 
                RowBox[{"4", " ", 
                 SuperscriptBox["MDM", "2"]}]}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["Q", "2"], "-", 
                RowBox[{"4", " ", 
                 SuperscriptBox["MH", "2"]}]}], ")"}]}]], "-", 
            RowBox[{"2", " ", 
             SuperscriptBox["MH", "2"]}], "+", 
            SuperscriptBox["Q", "2"]}], ")"}], "2"], 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            SqrtBox[
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["Q", "2"], "-", 
                RowBox[{"4", " ", 
                 SuperscriptBox["MDM", "2"]}]}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["Q", "2"], "-", 
                RowBox[{"4", " ", 
                 SuperscriptBox["MH", "2"]}]}], ")"}]}]], "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["MH", "2"]}], "-", 
            SuperscriptBox["Q", "2"]}], ")"}], "2"]], ")"}], "-", 
       FractionBox[
        RowBox[{"2", " ", 
         SqrtBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"4", " ", 
              SuperscriptBox["MDM", "2"]}], "-", 
             SuperscriptBox["Q", "2"]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"4", " ", 
              SuperscriptBox["MH", "2"]}], "-", 
             SuperscriptBox["Q", "2"]}], ")"}]}]], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"16", " ", 
            SuperscriptBox["MDM", "4"]}], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["MDM", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["Q", "2"], "-", 
              RowBox[{"8", " ", 
               SuperscriptBox["MH", "2"]}]}], ")"}]}], "+", 
           RowBox[{"3", " ", 
            SuperscriptBox["MH", "4"]}]}], ")"}]}], 
        RowBox[{
         RowBox[{
          SuperscriptBox["MDM", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["Q", "2"], "-", 
            RowBox[{"4", " ", 
             SuperscriptBox["MH", "2"]}]}], ")"}]}], "+", 
         SuperscriptBox["MH", "4"]}]], "-", 
       FractionBox[
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"16", " ", 
             SuperscriptBox["MDM", "4"]}]}], "+", 
           RowBox[{"4", " ", 
            SuperscriptBox["MDM", "2"], " ", 
            SuperscriptBox["Q", "2"]}], "+", 
           SuperscriptBox["MH", "4"]}], ")"}], " ", 
         RowBox[{"log", "(", 
          RowBox[{"16", " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SuperscriptBox["MDM", "2"], " ", 
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["Q", "2"], "-", 
                 RowBox[{"4", " ", 
                  SuperscriptBox["MH", "2"]}]}], ")"}]}], "+", 
              SuperscriptBox["MH", "4"]}], ")"}], "2"]}], ")"}]}], 
        RowBox[{
         RowBox[{"2", " ", 
          SuperscriptBox["MH", "2"]}], "-", 
         SuperscriptBox["Q", "2"]}]]}], ")"}]}], 
    RowBox[{"64", " ", "\[Pi]", " ", 
     SuperscriptBox["Q", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["Q", "2"], "-", 
       RowBox[{"4", " ", 
        SuperscriptBox["MDM", "2"]}]}], ")"}]}]], "-", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["gSXX", "3"], " ", "MDM", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SuperscriptBox["smix", "2"]}], ")"}], 
       RowBox[{"3", "/", "2"}]], " ", 
      SuperscriptBox["smix", "3"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"4", " ", 
         SqrtBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"4", " ", 
              SuperscriptBox["MDM", "2"]}], "-", 
             SuperscriptBox["Q", "2"]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"4", " ", 
              SuperscriptBox["MH", "2"]}], "-", 
             SuperscriptBox["Q", "2"]}], ")"}]}]]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"8", " ", 
            SuperscriptBox["MDM", "2"]}], "-", 
           RowBox[{"2", " ", 
            SuperscriptBox["MH", "2"]}], "-", 
           SuperscriptBox["Q", "2"]}], ")"}], " ", 
         RowBox[{"log", "(", 
          FractionBox[
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SqrtBox[
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["Q", "2"], "-", 
                  RowBox[{"4", " ", 
                   SuperscriptBox["MDM", "2"]}]}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["Q", "2"], "-", 
                  RowBox[{"4", " ", 
                   SuperscriptBox["MH", "2"]}]}], ")"}]}]], "+", 
              RowBox[{"2", " ", 
               SuperscriptBox["MH", "2"]}], "-", 
              SuperscriptBox["Q", "2"]}], ")"}], "2"], 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              SqrtBox[
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["Q", "2"], "-", 
                  RowBox[{"4", " ", 
                   SuperscriptBox["MDM", "2"]}]}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["Q", "2"], "-", 
                  RowBox[{"4", " ", 
                   SuperscriptBox["MH", "2"]}]}], ")"}]}]], "-", 
              RowBox[{"2", " ", 
               SuperscriptBox["MH", "2"]}], "+", 
              SuperscriptBox["Q", "2"]}], ")"}], "2"]], ")"}]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"2", " ", 
          SuperscriptBox["MH", "4"], " ", 
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["MSM", "2"], "-", 
            SuperscriptBox["Q", "2"]}], ")"}]}]}], "+", 
        RowBox[{
         SuperscriptBox["MH", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            SuperscriptBox["MSM", "4"]}], "-", 
           RowBox[{"3", " ", 
            SuperscriptBox["MSM", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              SuperscriptBox["Q", "2"], "-", 
              SuperscriptBox["\[CapitalGamma]SM", "2"]}], ")"}]}], "+", 
           SuperscriptBox["Q", "4"]}], ")"}]}], "+", 
        RowBox[{
         SuperscriptBox["MSM", "2"], " ", 
         SuperscriptBox["Q", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["MSM", "2"], "-", 
           SuperscriptBox["Q", "2"]}], ")"}]}]}], ")"}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{"32", " ", "\[Pi]", " ", 
      SuperscriptBox["Q", "2"], " ", "vev", " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["Q", "2"], "-", 
        RowBox[{"4", " ", 
         SuperscriptBox["MDM", "2"]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["Q", "2"], "-", 
        SuperscriptBox["MH", "2"]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["MSM", "4"], "+", 
        RowBox[{
         SuperscriptBox["MSM", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["\[CapitalGamma]SM", "2"], "-", 
           RowBox[{"2", " ", 
            SuperscriptBox["Q", "2"]}]}], ")"}]}], "+", 
        SuperscriptBox["Q", "4"]}], ")"}]}], ")"}]}], "-", 
   FractionBox[
    RowBox[{
     SuperscriptBox["gSXX", "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["smix", "2"], "-", "1"}], ")"}], "3"], " ", 
     SuperscriptBox["smix", "2"], " ", 
     SqrtBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["Q", "2"], "-", 
         RowBox[{"4", " ", 
          SuperscriptBox["MDM", "2"]}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["Q", "2"], "-", 
         RowBox[{"4", " ", 
          SuperscriptBox["MH", "2"]}]}], ")"}]}]], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"9", " ", 
        SuperscriptBox["\[CapitalGamma]SM", "2"], " ", 
        SuperscriptBox["MH", "4"], " ", 
        SuperscriptBox["MSM", "2"]}], "+", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["MH", "2"], "-", 
           SuperscriptBox["MSM", "2"]}], ")"}], "2"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            SuperscriptBox["MH", "2"]}], "+", 
           SuperscriptBox["Q", "2"]}], ")"}], "2"]}]}], ")"}]}], 
    RowBox[{"64", " ", "\[Pi]", " ", 
     SuperscriptBox["Q", "2"], " ", 
     SuperscriptBox["vev", "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"MH", "-", "Q"}], ")"}], "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"MH", "+", "Q"}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["\[CapitalGamma]SM", "2"], " ", 
        SuperscriptBox["MSM", "2"]}], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["MSM", "2"], "-", 
          SuperscriptBox["Q", "2"]}], ")"}], "2"]}], ")"}]}]]}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{
  3.792695348959817*^9, 3.792695382113183*^9, {3.7926954354134407`*^9, 
   3.792695498246829*^9}, {3.7926956168067102`*^9, 3.792695670638341*^9}, 
   3.79269586438387*^9},
 CellLabel->
  "Out[371]=",ExpressionUUID->"31d3b649-a414-4e36-9afb-4af34ad6b657"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{"Total", "[", 
   RowBox[{"Map", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Simplify", "[", 
       RowBox[{
        RowBox[{"ReplaceRepeated", "[", 
         RowBox[{"#", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"FCGV", "[", "\"\<MH\>\"", "]"}], "\[Rule]", "MH"}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"c_.", 
               RowBox[{"Log", "[", "a_", "]"}]}], "+", 
              RowBox[{"c_.", 
               RowBox[{"Log", "[", "b_", "]"}]}]}], "\[RuleDelayed]", 
             RowBox[{"Log", "[", 
              RowBox[{"Simplify", "[", 
               RowBox[{"Expand", "[", 
                RowBox[{"a", "*", "b"}], "]"}], "]"}], "]"}]}], ",", 
            RowBox[{
             RowBox[{
              RowBox[{"c_.", 
               RowBox[{"Log", "[", "a_", "]"}]}], "-", 
              RowBox[{"c_.", 
               RowBox[{"Log", "[", "b_", "]"}]}]}], "\[RuleDelayed]", 
             RowBox[{"Log", "[", 
              RowBox[{"Simplify", "[", 
               RowBox[{"Expand", "[", 
                RowBox[{"a", "/", "b"}], "]"}], "]"}], "]"}]}]}], "}"}]}], 
         "]"}], ",", 
        RowBox[{"Assumptions", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Q", ">", 
            RowBox[{"2", "*", "MH"}], ">", "0"}], ",", 
           RowBox[{"Q", ">", 
            RowBox[{"2", "MDM"}], ">", "0"}]}], "}"}]}]}], "]"}], "&"}], ",", 
     "amps"}], "]"}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.7926948007377253`*^9, 3.792694894639422*^9}, {
  3.7926949293133183`*^9, 3.792694942168388*^9}, {3.792694986598085*^9, 
  3.792695028454143*^9}, {3.792695126124251*^9, 3.792695167258317*^9}, {
  3.792695200191463*^9, 3.792695209516624*^9}},
 CellLabel->
  "In[344]:=",ExpressionUUID->"5eed94ec-366e-4925-89ef-a9b230804dae"],

Cell[BoxData[
 FormBox[
  RowBox[{
   FractionBox["1", 
    RowBox[{"64", " ", "\[Pi]", " ", 
     SuperscriptBox["Q", "2"]}]], 
   RowBox[{
    SuperscriptBox["gSXX", "2"], " ", 
    SuperscriptBox["smix", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{"9", " ", 
         SqrtBox[
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"4", " ", 
              SuperscriptBox["MDM", "2"]}], "-", 
             SuperscriptBox["Q", "2"]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"4", " ", 
              SuperscriptBox["MH", "2"]}], "-", 
             SuperscriptBox["Q", "2"]}], ")"}]}]], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["smix", "2"], "-", "1"}], ")"}], "3"], " ", 
         SuperscriptBox["MH", "4"]}], 
        RowBox[{
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox["MH", "2"], "-", 
            SuperscriptBox["Q", "2"]}], ")"}], "2"], " ", 
         SuperscriptBox["vev", "2"]}]]}], "+", 
      FractionBox[
       RowBox[{"3", " ", "gSXX", " ", "MDM", " ", "smix", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "-", 
           SuperscriptBox["smix", "2"]}], ")"}], 
         RowBox[{"3", "/", "2"}]], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"8", " ", 
              SuperscriptBox["MDM", "2"]}], "-", 
             RowBox[{"2", " ", 
              SuperscriptBox["MH", "2"]}], "-", 
             SuperscriptBox["Q", "2"]}], ")"}], " ", 
           RowBox[{"log", "(", 
            FractionBox[
             RowBox[{
              RowBox[{
               RowBox[{"-", "2"}], " ", 
               SuperscriptBox["MH", "2"]}], "+", 
              SuperscriptBox["Q", "2"], "-", 
              SqrtBox[
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["Q", "2"], "-", 
                  RowBox[{"4", " ", 
                   SuperscriptBox["MDM", "2"]}]}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["Q", "2"], "-", 
                  RowBox[{"4", " ", 
                   SuperscriptBox["MH", "2"]}]}], ")"}]}]]}], 
             RowBox[{
              RowBox[{
               RowBox[{"-", "2"}], " ", 
               SuperscriptBox["MH", "2"]}], "+", 
              SuperscriptBox["Q", "2"], "+", 
              SqrtBox[
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["Q", "2"], "-", 
                  RowBox[{"4", " ", 
                   SuperscriptBox["MDM", "2"]}]}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["Q", "2"], "-", 
                  RowBox[{"4", " ", 
                   SuperscriptBox["MH", "2"]}]}], ")"}]}]]}]], ")"}]}], "+", 
          RowBox[{"2", " ", 
           SqrtBox[
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"4", " ", 
                SuperscriptBox["MDM", "2"]}], "-", 
               SuperscriptBox["Q", "2"]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"4", " ", 
                SuperscriptBox["MH", "2"]}], "-", 
               SuperscriptBox["Q", "2"]}], ")"}]}]]}]}], ")"}], " ", 
        SuperscriptBox["MH", "2"]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["MH", "2"], "-", 
          SuperscriptBox["Q", "2"]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["Q", "2"], "-", 
          RowBox[{"4", " ", 
           SuperscriptBox["MDM", "2"]}]}], ")"}], " ", "vev"}]], "+", 
      FractionBox[
       RowBox[{"3", " ", "gSXX", " ", "MDM", " ", "smix", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "-", 
           SuperscriptBox["smix", "2"]}], ")"}], 
         RowBox[{"3", "/", "2"}]], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"8", " ", 
              SuperscriptBox["MDM", "2"]}], "-", 
             RowBox[{"2", " ", 
              SuperscriptBox["MH", "2"]}], "-", 
             SuperscriptBox["Q", "2"]}], ")"}], " ", 
           RowBox[{"log", "(", 
            RowBox[{"-", 
             FractionBox[
              RowBox[{
               RowBox[{
                RowBox[{"-", "2"}], " ", 
                SuperscriptBox["MH", "2"]}], "+", 
               SuperscriptBox["Q", "2"], "+", 
               SqrtBox[
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   SuperscriptBox["Q", "2"], "-", 
                   RowBox[{"4", " ", 
                    SuperscriptBox["MDM", "2"]}]}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   SuperscriptBox["Q", "2"], "-", 
                   RowBox[{"4", " ", 
                    SuperscriptBox["MH", "2"]}]}], ")"}]}]]}], 
              RowBox[{
               RowBox[{"2", " ", 
                SuperscriptBox["MH", "2"]}], "-", 
               SuperscriptBox["Q", "2"], "+", 
               SqrtBox[
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   SuperscriptBox["Q", "2"], "-", 
                   RowBox[{"4", " ", 
                    SuperscriptBox["MDM", "2"]}]}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   SuperscriptBox["Q", "2"], "-", 
                   RowBox[{"4", " ", 
                    SuperscriptBox["MH", "2"]}]}], ")"}]}]]}]]}], ")"}]}], 
          "-", 
          RowBox[{"2", " ", 
           SqrtBox[
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"4", " ", 
                SuperscriptBox["MDM", "2"]}], "-", 
               SuperscriptBox["Q", "2"]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"4", " ", 
                SuperscriptBox["MH", "2"]}], "-", 
               SuperscriptBox["Q", "2"]}], ")"}]}]]}]}], ")"}], " ", 
        SuperscriptBox["MH", "2"]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["Q", "2"], "-", 
          RowBox[{"4", " ", 
           SuperscriptBox["MDM", "2"]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["Q", "2"], "-", 
          SuperscriptBox["MH", "2"]}], ")"}], " ", "vev"}]], "+", 
      FractionBox[
       RowBox[{"3", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", 
           SuperscriptBox["MH", "2"]}], "+", 
          SuperscriptBox["MSM", "2"]}], ")"}], " ", 
        SqrtBox[
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"4", " ", 
             SuperscriptBox["MDM", "2"]}], "-", 
            SuperscriptBox["Q", "2"]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"4", " ", 
             SuperscriptBox["MH", "2"]}], "-", 
            SuperscriptBox["Q", "2"]}], ")"}]}]], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["smix", "2"], "-", "1"}], ")"}], "3"], " ", 
        SuperscriptBox["MH", "2"]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["Q", "2"], "-", 
          SuperscriptBox["MH", "2"]}], ")"}], " ", 
        SuperscriptBox["vev", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox["MSM", "2"]}], "-", 
          RowBox[{"\[ImaginaryI]", " ", "\[CapitalGamma]SM", " ", "MSM"}], 
          "+", 
          SuperscriptBox["Q", "2"]}], ")"}]}]], "+", 
      FractionBox[
       RowBox[{
        SuperscriptBox["gSXX", "2"], " ", 
        SuperscriptBox["smix", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           FractionBox[
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "16"}], " ", 
                SuperscriptBox["MDM", "4"]}], "+", 
               RowBox[{"4", " ", 
                SuperscriptBox["Q", "2"], " ", 
                SuperscriptBox["MDM", "2"]}], "+", 
               SuperscriptBox["MH", "4"]}], ")"}], " ", 
             RowBox[{"log", "(", 
              RowBox[{"16", " ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["MH", "4"], "+", 
                  RowBox[{
                   SuperscriptBox["MDM", "2"], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    SuperscriptBox["Q", "2"], "-", 
                    RowBox[{"4", " ", 
                    SuperscriptBox["MH", "2"]}]}], ")"}]}]}], ")"}], "2"]}], 
              ")"}]}], 
            RowBox[{
             RowBox[{"2", " ", 
              SuperscriptBox["MH", "2"]}], "-", 
             SuperscriptBox["Q", "2"]}]]}], "-", 
          SqrtBox[
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"4", " ", 
               SuperscriptBox["MDM", "2"]}], "-", 
              SuperscriptBox["Q", "2"]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"4", " ", 
               SuperscriptBox["MH", "2"]}], "-", 
              SuperscriptBox["Q", "2"]}], ")"}]}]]}], ")"}]}], 
       RowBox[{
        SuperscriptBox["Q", "2"], "-", 
        RowBox[{"4", " ", 
         SuperscriptBox["MDM", "2"]}]}]], "-", 
      FractionBox[
       RowBox[{
        SuperscriptBox["gSXX", "2"], " ", 
        SuperscriptBox["smix", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          FractionBox[
           RowBox[{
            SqrtBox[
             RowBox[{
              RowBox[{"-", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"4", " ", 
                  SuperscriptBox["MDM", "2"]}], "-", 
                 SuperscriptBox["Q", "2"]}], ")"}]}], " ", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["Q", "2"], "-", 
                RowBox[{"4", " ", 
                 SuperscriptBox["MH", "2"]}]}], ")"}]}]], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"16", " ", 
               SuperscriptBox["MDM", "4"]}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["Q", "2"], "-", 
                 RowBox[{"12", " ", 
                  SuperscriptBox["MH", "2"]}]}], ")"}], " ", 
               SuperscriptBox["MDM", "2"]}], "+", 
              RowBox[{"2", " ", 
               SuperscriptBox["MH", "4"]}]}], ")"}]}], 
           RowBox[{
            SuperscriptBox["MH", "4"], "+", 
            RowBox[{
             SuperscriptBox["MDM", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["Q", "2"], "-", 
               RowBox[{"4", " ", 
                SuperscriptBox["MH", "2"]}]}], ")"}]}]}]], "+", 
          RowBox[{"log", "(", 
           FractionBox[
            RowBox[{
             RowBox[{
              RowBox[{"-", "2"}], " ", 
              SuperscriptBox["MH", "2"]}], "+", 
             SuperscriptBox["Q", "2"], "-", 
             SqrtBox[
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["Q", "2"], "-", 
                 RowBox[{"4", " ", 
                  SuperscriptBox["MDM", "2"]}]}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["Q", "2"], "-", 
                 RowBox[{"4", " ", 
                  SuperscriptBox["MH", "2"]}]}], ")"}]}]]}], 
            RowBox[{
             RowBox[{
              RowBox[{"-", "2"}], " ", 
              SuperscriptBox["MH", "2"]}], "+", 
             SuperscriptBox["Q", "2"], "+", 
             SqrtBox[
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["Q", "2"], "-", 
                 RowBox[{"4", " ", 
                  SuperscriptBox["MDM", "2"]}]}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["Q", "2"], "-", 
                 RowBox[{"4", " ", 
                  SuperscriptBox["MH", "2"]}]}], ")"}]}]]}]], ")"}]}], 
         ")"}]}], 
       RowBox[{
        SuperscriptBox["Q", "2"], "-", 
        RowBox[{"4", " ", 
         SuperscriptBox["MDM", "2"]}]}]], "+", 
      FractionBox[
       RowBox[{"gSXX", " ", "MDM", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", 
           SuperscriptBox["MH", "2"]}], "+", 
          SuperscriptBox["MSM", "2"]}], ")"}], " ", "smix", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "-", 
           SuperscriptBox["smix", "2"]}], ")"}], 
         RowBox[{"3", "/", "2"}]], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"8", " ", 
              SuperscriptBox["MDM", "2"]}], "-", 
             RowBox[{"2", " ", 
              SuperscriptBox["MH", "2"]}], "-", 
             SuperscriptBox["Q", "2"]}], ")"}], " ", 
           RowBox[{"log", "(", 
            FractionBox[
             RowBox[{
              RowBox[{
               RowBox[{"-", "2"}], " ", 
               SuperscriptBox["MH", "2"]}], "+", 
              SuperscriptBox["Q", "2"], "-", 
              SqrtBox[
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["Q", "2"], "-", 
                  RowBox[{"4", " ", 
                   SuperscriptBox["MDM", "2"]}]}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["Q", "2"], "-", 
                  RowBox[{"4", " ", 
                   SuperscriptBox["MH", "2"]}]}], ")"}]}]]}], 
             RowBox[{
              RowBox[{
               RowBox[{"-", "2"}], " ", 
               SuperscriptBox["MH", "2"]}], "+", 
              SuperscriptBox["Q", "2"], "+", 
              SqrtBox[
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["Q", "2"], "-", 
                  RowBox[{"4", " ", 
                   SuperscriptBox["MDM", "2"]}]}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["Q", "2"], "-", 
                  RowBox[{"4", " ", 
                   SuperscriptBox["MH", "2"]}]}], ")"}]}]]}]], ")"}]}], "+", 
          RowBox[{"2", " ", 
           SqrtBox[
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"4", " ", 
                SuperscriptBox["MDM", "2"]}], "-", 
               SuperscriptBox["Q", "2"]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"4", " ", 
                SuperscriptBox["MH", "2"]}], "-", 
               SuperscriptBox["Q", "2"]}], ")"}]}]]}]}], ")"}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["Q", "2"], "-", 
          RowBox[{"4", " ", 
           SuperscriptBox["MDM", "2"]}]}], ")"}], " ", "vev", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox["MSM", "2"]}], "+", 
          RowBox[{"\[ImaginaryI]", " ", "\[CapitalGamma]SM", " ", "MSM"}], 
          "+", 
          SuperscriptBox["Q", "2"]}], ")"}]}]], "+", 
      FractionBox[
       RowBox[{
        SuperscriptBox["gSXX", "2"], " ", 
        SuperscriptBox["smix", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"log", "(", 
           RowBox[{"-", 
            FractionBox[
             RowBox[{
              RowBox[{
               RowBox[{"-", "2"}], " ", 
               SuperscriptBox["MH", "2"]}], "+", 
              SuperscriptBox["Q", "2"], "+", 
              SqrtBox[
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["Q", "2"], "-", 
                  RowBox[{"4", " ", 
                   SuperscriptBox["MDM", "2"]}]}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["Q", "2"], "-", 
                  RowBox[{"4", " ", 
                   SuperscriptBox["MH", "2"]}]}], ")"}]}]]}], 
             RowBox[{
              RowBox[{"2", " ", 
               SuperscriptBox["MH", "2"]}], "-", 
              SuperscriptBox["Q", "2"], "+", 
              SqrtBox[
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["Q", "2"], "-", 
                  RowBox[{"4", " ", 
                   SuperscriptBox["MDM", "2"]}]}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  SuperscriptBox["Q", "2"], "-", 
                  RowBox[{"4", " ", 
                   SuperscriptBox["MH", "2"]}]}], ")"}]}]]}]]}], ")"}], "-", 
          FractionBox[
           RowBox[{
            SqrtBox[
             RowBox[{
              RowBox[{"-", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"4", " ", 
                  SuperscriptBox["MDM", "2"]}], "-", 
                 SuperscriptBox["Q", "2"]}], ")"}]}], " ", 
              RowBox[{"(", 
               RowBox[{
                SuperscriptBox["Q", "2"], "-", 
                RowBox[{"4", " ", 
                 SuperscriptBox["MH", "2"]}]}], ")"}]}]], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"16", " ", 
               SuperscriptBox["MDM", "4"]}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 SuperscriptBox["Q", "2"], "-", 
                 RowBox[{"12", " ", 
                  SuperscriptBox["MH", "2"]}]}], ")"}], " ", 
               SuperscriptBox["MDM", "2"]}], "+", 
              RowBox[{"2", " ", 
               SuperscriptBox["MH", "4"]}]}], ")"}]}], 
           RowBox[{
            SuperscriptBox["MH", "4"], "+", 
            RowBox[{
             SuperscriptBox["MDM", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               SuperscriptBox["Q", "2"], "-", 
               RowBox[{"4", " ", 
                SuperscriptBox["MH", "2"]}]}], ")"}]}]}]]}], ")"}]}], 
       RowBox[{
        SuperscriptBox["Q", "2"], "-", 
        RowBox[{"4", " ", 
         SuperscriptBox["MDM", "2"]}]}]], "-", 
      FractionBox[
       RowBox[{"gSXX", " ", "MDM", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", 
           SuperscriptBox["MH", "2"]}], "+", 
          SuperscriptBox["MSM", "2"]}], ")"}], " ", "smix", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "-", 
           SuperscriptBox["smix", "2"]}], ")"}], 
         RowBox[{"3", "/", "2"}]], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"8", " ", 
              SuperscriptBox["MDM", "2"]}], "-", 
             RowBox[{"2", " ", 
              SuperscriptBox["MH", "2"]}], "-", 
             SuperscriptBox["Q", "2"]}], ")"}], " ", 
           RowBox[{"log", "(", 
            RowBox[{"-", 
             FractionBox[
              RowBox[{
               RowBox[{
                RowBox[{"-", "2"}], " ", 
                SuperscriptBox["MH", "2"]}], "+", 
               SuperscriptBox["Q", "2"], "+", 
               SqrtBox[
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   SuperscriptBox["Q", "2"], "-", 
                   RowBox[{"4", " ", 
                    SuperscriptBox["MDM", "2"]}]}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   SuperscriptBox["Q", "2"], "-", 
                   RowBox[{"4", " ", 
                    SuperscriptBox["MH", "2"]}]}], ")"}]}]]}], 
              RowBox[{
               RowBox[{"2", " ", 
                SuperscriptBox["MH", "2"]}], "-", 
               SuperscriptBox["Q", "2"], "+", 
               SqrtBox[
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   SuperscriptBox["Q", "2"], "-", 
                   RowBox[{"4", " ", 
                    SuperscriptBox["MDM", "2"]}]}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   SuperscriptBox["Q", "2"], "-", 
                   RowBox[{"4", " ", 
                    SuperscriptBox["MH", "2"]}]}], ")"}]}]]}]]}], ")"}]}], 
          "-", 
          RowBox[{"2", " ", 
           SqrtBox[
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"4", " ", 
                SuperscriptBox["MDM", "2"]}], "-", 
               SuperscriptBox["Q", "2"]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"4", " ", 
                SuperscriptBox["MH", "2"]}], "-", 
               SuperscriptBox["Q", "2"]}], ")"}]}]]}]}], ")"}]}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["Q", "2"], "-", 
          RowBox[{"4", " ", 
           SuperscriptBox["MDM", "2"]}]}], ")"}], " ", "vev", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox["MSM", "2"]}], "+", 
          RowBox[{"\[ImaginaryI]", " ", "\[CapitalGamma]SM", " ", "MSM"}], 
          "+", 
          SuperscriptBox["Q", "2"]}], ")"}]}]], "-", 
      FractionBox[
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            SuperscriptBox["MH", "2"]}], "+", 
           SuperscriptBox["MSM", "2"]}], ")"}], "2"], " ", 
        SqrtBox[
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"4", " ", 
             SuperscriptBox["MDM", "2"]}], "-", 
            SuperscriptBox["Q", "2"]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"4", " ", 
             SuperscriptBox["MH", "2"]}], "-", 
            SuperscriptBox["Q", "2"]}], ")"}]}]], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox["smix", "2"], "-", "1"}], ")"}], "3"]}], 
       RowBox[{
        SuperscriptBox["vev", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["MSM", "4"], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox["\[CapitalGamma]SM", "2"], "-", 
             RowBox[{"2", " ", 
              SuperscriptBox["Q", "2"]}]}], ")"}], " ", 
           SuperscriptBox["MSM", "2"]}], "+", 
          SuperscriptBox["Q", "4"]}], ")"}]}]]}], ")"}]}]}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{{3.792694851440138*^9, 3.79269489519075*^9}, 
   3.792694944477744*^9, 3.79269499313348*^9, 3.792695029060997*^9, {
   3.7926951368791523`*^9, 3.792695170269897*^9}, 3.79269522069944*^9},
 CellLabel->
  "Out[344]=",ExpressionUUID->"dc725fd5-e4c7-4f7b-a163-50680a450ee0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ComputeAmplitudeSquared", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"DM", ",", 
      RowBox[{"-", "DM"}]}], "}"}], "->", 
    RowBox[{"{", 
     RowBox[{"Higgs", ",", "Higgs"}], "}"}]}], ",", 
   RowBox[{"IncomingMomenta", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"p1", ",", "p2"}], "}"}]}], ",", 
   RowBox[{"OutgoingMomenta", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"p3", ",", "p4"}], "}"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7926923332418537`*^9, 3.792692347744329*^9}, {
  3.792692766605928*^9, 3.792692785443221*^9}, {3.792692980255477*^9, 
  3.792692998500536*^9}},
 CellLabel->
  "In[310]:=",ExpressionUUID->"d00aef90-fa0e-4c13-bbbd-cbf20d72a2c8"],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{
    FractionBox[
     RowBox[{"9", " ", 
      SuperscriptBox["gSXX", "2"], " ", 
      SuperscriptBox["MH", "4"], " ", 
      SuperscriptBox["smix", "2"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["smix", "2"], "-", "1"}], ")"}], "3"], " ", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox["MDM", "2"], "-", 
        RowBox[{
         FormBox[
          OverscriptBox[
           FormBox["p1",
            TraditionalForm], "_"],
          TraditionalForm], 
         FormBox["\<\"\[CenterDot]\"\>",
          TraditionalForm], 
         FormBox[
          OverscriptBox[
           FormBox["p2",
            TraditionalForm], "_"],
          TraditionalForm]}]}], ")"}], " ", 
      SuperscriptBox[
       FormBox[
        FractionBox["1", 
         InterpretationBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{
             FormBox["\<\"(\"\>",
              TraditionalForm], 
             FormBox[
              FormBox[
               RowBox[{
                OverscriptBox[
                 FormBox["p3",
                  TraditionalForm], "_"], "+", 
                OverscriptBox[
                 FormBox["p4",
                  TraditionalForm], "_"]}],
               TraditionalForm],
              TraditionalForm], 
             FormBox["\<\")\"\>",
              TraditionalForm]}], "2"], "\[InvisibleSpace]", "\<\"-\"\>", 
           "\[InvisibleSpace]", 
           SuperscriptBox["MH", "2"]}],
          SequenceForm[
           FeynCalc`Pair[
            FeynCalc`Momentum[$CellContext`p3 + $CellContext`p4], 
            FeynCalc`Momentum[$CellContext`p3 + $CellContext`p4]], 
           "-", $CellContext`MH^2],
          Editable->False]],
        TraditionalForm], "2"]}], 
     SuperscriptBox["vev", "2"]], ",", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["gSXX", "2"], " ", 
       SuperscriptBox["smix", "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["smix", "2"], "-", "1"}], ")"}], "3"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", 
           SuperscriptBox["MH", "2"]}], "+", 
          SuperscriptBox["MSM", "2"]}], ")"}], "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["MDM", "2"], "-", 
         RowBox[{
          FormBox[
           OverscriptBox[
            FormBox["p1",
             TraditionalForm], "_"],
           TraditionalForm], 
          FormBox["\<\"\[CenterDot]\"\>",
           TraditionalForm], 
          FormBox[
           OverscriptBox[
            FormBox["p2",
             TraditionalForm], "_"],
           TraditionalForm]}]}], ")"}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["vev", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             FormBox[
              OverscriptBox[
               FormBox["p3",
                TraditionalForm], "_"],
              TraditionalForm], 
             FormBox["\<\"\[CenterDot]\"\>",
              TraditionalForm], 
             FormBox[
              OverscriptBox[
               FormBox["p4",
                TraditionalForm], "_"],
              TraditionalForm]}], ")"}]}]}], "-", 
         RowBox[{"2", " ", 
          SuperscriptBox["MH", "2"]}], "+", 
         RowBox[{"MSM", " ", 
          RowBox[{"(", 
           RowBox[{"MSM", "-", 
            RowBox[{"\[ImaginaryI]", " ", "\[CapitalGamma]SM"}]}], ")"}]}]}], 
        ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             FormBox[
              OverscriptBox[
               FormBox["p3",
                TraditionalForm], "_"],
              TraditionalForm], 
             FormBox["\<\"\[CenterDot]\"\>",
              TraditionalForm], 
             FormBox[
              OverscriptBox[
               FormBox["p4",
                TraditionalForm], "_"],
              TraditionalForm]}], ")"}]}]}], "-", 
         RowBox[{"2", " ", 
          SuperscriptBox["MH", "2"]}], "+", 
         RowBox[{"MSM", " ", 
          RowBox[{"(", 
           RowBox[{"MSM", "+", 
            RowBox[{"\[ImaginaryI]", " ", "\[CapitalGamma]SM"}]}], ")"}]}]}], 
        ")"}]}], ")"}]}], ",", 
    RowBox[{
     RowBox[{"-", 
      SuperscriptBox["gSXX", "4"]}], " ", 
     SuperscriptBox["smix", "4"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["MH", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           FormBox[
            OverscriptBox[
             FormBox["p1",
              TraditionalForm], "_"],
            TraditionalForm], 
           FormBox["\<\"\[CenterDot]\"\>",
            TraditionalForm], 
           FormBox[
            OverscriptBox[
             FormBox["p2",
              TraditionalForm], "_"],
            TraditionalForm]}], "+", 
          SuperscriptBox["MDM", "2"]}], ")"}]}], "-", 
       RowBox[{"4", " ", 
        SuperscriptBox["MDM", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          FormBox[
           OverscriptBox[
            FormBox["p1",
             TraditionalForm], "_"],
           TraditionalForm], 
          FormBox["\<\"\[CenterDot]\"\>",
           TraditionalForm], 
          FormBox[
           OverscriptBox[
            FormBox["p2",
             TraditionalForm], "_"],
           TraditionalForm]}], ")"}]}], "+", 
       RowBox[{"4", " ", 
        SuperscriptBox["MDM", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          FormBox[
           OverscriptBox[
            FormBox["p1",
             TraditionalForm], "_"],
           TraditionalForm], 
          FormBox["\<\"\[CenterDot]\"\>",
           TraditionalForm], 
          FormBox[
           OverscriptBox[
            FormBox["p4",
             TraditionalForm], "_"],
           TraditionalForm]}], ")"}]}], "-", 
       RowBox[{"4", " ", 
        SuperscriptBox["MDM", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          FormBox[
           OverscriptBox[
            FormBox["p2",
             TraditionalForm], "_"],
           TraditionalForm], 
          FormBox["\<\"\[CenterDot]\"\>",
           TraditionalForm], 
          FormBox[
           OverscriptBox[
            FormBox["p4",
             TraditionalForm], "_"],
           TraditionalForm]}], ")"}]}], "-", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          FormBox[
           OverscriptBox[
            FormBox["p1",
             TraditionalForm], "_"],
           TraditionalForm], 
          FormBox["\<\"\[CenterDot]\"\>",
           TraditionalForm], 
          FormBox[
           OverscriptBox[
            FormBox["p4",
             TraditionalForm], "_"],
           TraditionalForm]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          FormBox[
           OverscriptBox[
            FormBox["p2",
             TraditionalForm], "_"],
           TraditionalForm], 
          FormBox["\<\"\[CenterDot]\"\>",
           TraditionalForm], 
          FormBox[
           OverscriptBox[
            FormBox["p4",
             TraditionalForm], "_"],
           TraditionalForm]}], ")"}]}], "+", 
       RowBox[{"4", " ", 
        SuperscriptBox["MDM", "4"]}]}], ")"}], " ", 
     SuperscriptBox[
      FormBox[
       FractionBox["1", 
        InterpretationBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{
            FormBox["\<\"(\"\>",
             TraditionalForm], 
            FormBox[
             FormBox[
              RowBox[{
               OverscriptBox[
                FormBox["p2",
                 TraditionalForm], "_"], "-", 
               OverscriptBox[
                FormBox["p4",
                 TraditionalForm], "_"]}],
              TraditionalForm],
             TraditionalForm], 
            FormBox["\<\")\"\>",
             TraditionalForm]}], "2"], "\[InvisibleSpace]", "\<\"-\"\>", 
          "\[InvisibleSpace]", 
          SuperscriptBox["MDM", "2"]}],
         SequenceForm[
          FeynCalc`Pair[
           FeynCalc`Momentum[$CellContext`p2 - $CellContext`p4], 
           FeynCalc`Momentum[$CellContext`p2 - $CellContext`p4]], 
          "-", $CellContext`MDM^2],
         Editable->False]],
       TraditionalForm], "2"]}], ",", 
    RowBox[{
     RowBox[{"-", 
      SuperscriptBox["gSXX", "4"]}], " ", 
     SuperscriptBox["smix", "4"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["MH", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           FormBox[
            OverscriptBox[
             FormBox["p1",
              TraditionalForm], "_"],
            TraditionalForm], 
           FormBox["\<\"\[CenterDot]\"\>",
            TraditionalForm], 
           FormBox[
            OverscriptBox[
             FormBox["p2",
              TraditionalForm], "_"],
            TraditionalForm]}], "+", 
          SuperscriptBox["MDM", "2"]}], ")"}]}], "-", 
       RowBox[{"4", " ", 
        SuperscriptBox["MDM", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          FormBox[
           OverscriptBox[
            FormBox["p1",
             TraditionalForm], "_"],
           TraditionalForm], 
          FormBox["\<\"\[CenterDot]\"\>",
           TraditionalForm], 
          FormBox[
           OverscriptBox[
            FormBox["p2",
             TraditionalForm], "_"],
           TraditionalForm]}], ")"}]}], "+", 
       RowBox[{"4", " ", 
        SuperscriptBox["MDM", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          FormBox[
           OverscriptBox[
            FormBox["p1",
             TraditionalForm], "_"],
           TraditionalForm], 
          FormBox["\<\"\[CenterDot]\"\>",
           TraditionalForm], 
          FormBox[
           OverscriptBox[
            FormBox["p3",
             TraditionalForm], "_"],
           TraditionalForm]}], ")"}]}], "-", 
       RowBox[{"4", " ", 
        SuperscriptBox["MDM", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          FormBox[
           OverscriptBox[
            FormBox["p2",
             TraditionalForm], "_"],
           TraditionalForm], 
          FormBox["\<\"\[CenterDot]\"\>",
           TraditionalForm], 
          FormBox[
           OverscriptBox[
            FormBox["p3",
             TraditionalForm], "_"],
           TraditionalForm]}], ")"}]}], "-", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          FormBox[
           OverscriptBox[
            FormBox["p1",
             TraditionalForm], "_"],
           TraditionalForm], 
          FormBox["\<\"\[CenterDot]\"\>",
           TraditionalForm], 
          FormBox[
           OverscriptBox[
            FormBox["p3",
             TraditionalForm], "_"],
           TraditionalForm]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          FormBox[
           OverscriptBox[
            FormBox["p2",
             TraditionalForm], "_"],
           TraditionalForm], 
          FormBox["\<\"\[CenterDot]\"\>",
           TraditionalForm], 
          FormBox[
           OverscriptBox[
            FormBox["p3",
             TraditionalForm], "_"],
           TraditionalForm]}], ")"}]}], "+", 
       RowBox[{"4", " ", 
        SuperscriptBox["MDM", "4"]}]}], ")"}], " ", 
     SuperscriptBox[
      FormBox[
       FractionBox["1", 
        InterpretationBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{
            FormBox["\<\"(\"\>",
             TraditionalForm], 
            FormBox[
             FormBox[
              RowBox[{
               OverscriptBox[
                FormBox["p2",
                 TraditionalForm], "_"], "-", 
               OverscriptBox[
                FormBox["p3",
                 TraditionalForm], "_"]}],
              TraditionalForm],
             TraditionalForm], 
            FormBox["\<\")\"\>",
             TraditionalForm]}], "2"], "\[InvisibleSpace]", "\<\"-\"\>", 
          "\[InvisibleSpace]", 
          SuperscriptBox["MDM", "2"]}],
         SequenceForm[
          FeynCalc`Pair[
           FeynCalc`Momentum[$CellContext`p2 - $CellContext`p3], 
           FeynCalc`Momentum[$CellContext`p2 - $CellContext`p3]], 
          "-", $CellContext`MDM^2],
         Editable->False]],
       TraditionalForm], "2"]}], ",", 
    FormBox[
     FractionBox[
      RowBox[{"3", " ", 
       SuperscriptBox["gSXX", "2"], " ", 
       SuperscriptBox["MH", "2"], " ", 
       SuperscriptBox["smix", "2"], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["smix", "2"], "-", "1"}], ")"}], "3"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", 
          SuperscriptBox["MH", "2"]}], "+", 
         SuperscriptBox["MSM", "2"]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["MDM", "2"], "-", 
         RowBox[{
          FormBox[
           OverscriptBox[
            FormBox["p1",
             TraditionalForm], "_"],
           TraditionalForm], 
          FormBox["\<\"\[CenterDot]\"\>",
           TraditionalForm], 
          FormBox[
           OverscriptBox[
            FormBox["p2",
             TraditionalForm], "_"],
           TraditionalForm]}]}], ")"}]}], 
      RowBox[{
       SuperscriptBox["vev", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             FormBox[
              OverscriptBox[
               FormBox["p3",
                TraditionalForm], "_"],
              TraditionalForm], 
             FormBox["\<\"\[CenterDot]\"\>",
              TraditionalForm], 
             FormBox[
              OverscriptBox[
               FormBox["p4",
                TraditionalForm], "_"],
              TraditionalForm]}], ")"}]}]}], "-", 
         RowBox[{"2", " ", 
          SuperscriptBox["MH", "2"]}], "+", 
         RowBox[{"MSM", " ", 
          RowBox[{"(", 
           RowBox[{"MSM", "+", 
            RowBox[{"\[ImaginaryI]", " ", "\[CapitalGamma]SM"}]}], ")"}]}]}], 
        ")"}], " ", 
       RowBox[{"(", 
        InterpretationBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{
            FormBox["\<\"(\"\>",
             TraditionalForm], 
            FormBox[
             FormBox[
              RowBox[{
               OverscriptBox[
                FormBox["p3",
                 TraditionalForm], "_"], "+", 
               OverscriptBox[
                FormBox["p4",
                 TraditionalForm], "_"]}],
              TraditionalForm],
             TraditionalForm], 
            FormBox["\<\")\"\>",
             TraditionalForm]}], "2"], "\[InvisibleSpace]", "\<\"-\"\>", 
          "\[InvisibleSpace]", 
          SuperscriptBox["MH", "2"]}],
         SequenceForm[
          FeynCalc`Pair[
           FeynCalc`Momentum[$CellContext`p3 + $CellContext`p4], 
           FeynCalc`Momentum[$CellContext`p3 + $CellContext`p4]], 
          "-", $CellContext`MH^2],
         Editable->False], ")"}]}]],
     TraditionalForm], ",", 
    FormBox[
     FormBox[
      RowBox[{"-", 
       FractionBox[
        RowBox[{"3", " ", 
         SuperscriptBox["gSXX", "3"], " ", "MDM", " ", 
         SuperscriptBox["MH", "2"], " ", 
         SuperscriptBox["smix", "3"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "-", 
            SuperscriptBox["smix", "2"]}], ")"}], 
          RowBox[{"3", "/", "2"}]], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{
               FormBox[
                OverscriptBox[
                 FormBox["p1",
                  TraditionalForm], "_"],
                TraditionalForm], 
               FormBox["\<\"\[CenterDot]\"\>",
                TraditionalForm], 
               FormBox[
                OverscriptBox[
                 FormBox["p2",
                  TraditionalForm], "_"],
                TraditionalForm]}], ")"}]}]}], "+", 
           RowBox[{
            FormBox[
             OverscriptBox[
              FormBox["p1",
               TraditionalForm], "_"],
             TraditionalForm], 
            FormBox["\<\"\[CenterDot]\"\>",
             TraditionalForm], 
            FormBox[
             OverscriptBox[
              FormBox["p4",
               TraditionalForm], "_"],
             TraditionalForm]}], "-", 
           RowBox[{
            FormBox[
             OverscriptBox[
              FormBox["p2",
               TraditionalForm], "_"],
             TraditionalForm], 
            FormBox["\<\"\[CenterDot]\"\>",
             TraditionalForm], 
            FormBox[
             OverscriptBox[
              FormBox["p4",
               TraditionalForm], "_"],
             TraditionalForm]}], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["MDM", "2"]}]}], ")"}]}], 
        RowBox[{"vev", " ", 
         RowBox[{"(", 
          InterpretationBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{
              FormBox["\<\"(\"\>",
               TraditionalForm], 
              FormBox[
               FormBox[
                RowBox[{
                 OverscriptBox[
                  FormBox["p2",
                   TraditionalForm], "_"], "-", 
                 OverscriptBox[
                  FormBox["p4",
                   TraditionalForm], "_"]}],
                TraditionalForm],
               TraditionalForm], 
              FormBox["\<\")\"\>",
               TraditionalForm]}], "2"], "\[InvisibleSpace]", "\<\"-\"\>", 
            "\[InvisibleSpace]", 
            SuperscriptBox["MDM", "2"]}],
           SequenceForm[
            FeynCalc`Pair[
             FeynCalc`Momentum[$CellContext`p2 - $CellContext`p4], 
             FeynCalc`Momentum[$CellContext`p2 - $CellContext`p4]], 
            "-", $CellContext`MDM^2],
           Editable->False], ")"}], " ", 
         RowBox[{"(", 
          InterpretationBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{
              FormBox["\<\"(\"\>",
               TraditionalForm], 
              FormBox[
               FormBox[
                RowBox[{
                 OverscriptBox[
                  FormBox["p3",
                   TraditionalForm], "_"], "+", 
                 OverscriptBox[
                  FormBox["p4",
                   TraditionalForm], "_"]}],
                TraditionalForm],
               TraditionalForm], 
              FormBox["\<\")\"\>",
               TraditionalForm]}], "2"], "\[InvisibleSpace]", "\<\"-\"\>", 
            "\[InvisibleSpace]", 
            SuperscriptBox["MH", "2"]}],
           SequenceForm[
            FeynCalc`Pair[
             FeynCalc`Momentum[$CellContext`p3 + $CellContext`p4], 
             FeynCalc`Momentum[$CellContext`p3 + $CellContext`p4]], 
            "-", $CellContext`MH^2],
           Editable->False], ")"}]}]]}],
      TraditionalForm],
     TraditionalForm], ",", 
    FormBox[
     FormBox[
      RowBox[{"-", 
       FractionBox[
        RowBox[{"3", " ", 
         SuperscriptBox["gSXX", "3"], " ", "MDM", " ", 
         SuperscriptBox["MH", "2"], " ", 
         SuperscriptBox["smix", "3"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "-", 
            SuperscriptBox["smix", "2"]}], ")"}], 
          RowBox[{"3", "/", "2"}]], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{
               FormBox[
                OverscriptBox[
                 FormBox["p1",
                  TraditionalForm], "_"],
                TraditionalForm], 
               FormBox["\<\"\[CenterDot]\"\>",
                TraditionalForm], 
               FormBox[
                OverscriptBox[
                 FormBox["p2",
                  TraditionalForm], "_"],
                TraditionalForm]}], ")"}]}]}], "+", 
           RowBox[{
            FormBox[
             OverscriptBox[
              FormBox["p1",
               TraditionalForm], "_"],
             TraditionalForm], 
            FormBox["\<\"\[CenterDot]\"\>",
             TraditionalForm], 
            FormBox[
             OverscriptBox[
              FormBox["p3",
               TraditionalForm], "_"],
             TraditionalForm]}], "-", 
           RowBox[{
            FormBox[
             OverscriptBox[
              FormBox["p2",
               TraditionalForm], "_"],
             TraditionalForm], 
            FormBox["\<\"\[CenterDot]\"\>",
             TraditionalForm], 
            FormBox[
             OverscriptBox[
              FormBox["p3",
               TraditionalForm], "_"],
             TraditionalForm]}], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["MDM", "2"]}]}], ")"}]}], 
        RowBox[{"vev", " ", 
         RowBox[{"(", 
          InterpretationBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{
              FormBox["\<\"(\"\>",
               TraditionalForm], 
              FormBox[
               FormBox[
                RowBox[{
                 OverscriptBox[
                  FormBox["p2",
                   TraditionalForm], "_"], "-", 
                 OverscriptBox[
                  FormBox["p3",
                   TraditionalForm], "_"]}],
                TraditionalForm],
               TraditionalForm], 
              FormBox["\<\")\"\>",
               TraditionalForm]}], "2"], "\[InvisibleSpace]", "\<\"-\"\>", 
            "\[InvisibleSpace]", 
            SuperscriptBox["MDM", "2"]}],
           SequenceForm[
            FeynCalc`Pair[
             FeynCalc`Momentum[$CellContext`p2 - $CellContext`p3], 
             FeynCalc`Momentum[$CellContext`p2 - $CellContext`p3]], 
            "-", $CellContext`MDM^2],
           Editable->False], ")"}], " ", 
         RowBox[{"(", 
          InterpretationBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{
              FormBox["\<\"(\"\>",
               TraditionalForm], 
              FormBox[
               FormBox[
                RowBox[{
                 OverscriptBox[
                  FormBox["p3",
                   TraditionalForm], "_"], "+", 
                 OverscriptBox[
                  FormBox["p4",
                   TraditionalForm], "_"]}],
                TraditionalForm],
               TraditionalForm], 
              FormBox["\<\")\"\>",
               TraditionalForm]}], "2"], "\[InvisibleSpace]", "\<\"-\"\>", 
            "\[InvisibleSpace]", 
            SuperscriptBox["MH", "2"]}],
           SequenceForm[
            FeynCalc`Pair[
             FeynCalc`Momentum[$CellContext`p3 + $CellContext`p4], 
             FeynCalc`Momentum[$CellContext`p3 + $CellContext`p4]], 
            "-", $CellContext`MH^2],
           Editable->False], ")"}]}]]}],
      TraditionalForm],
     TraditionalForm], ",", 
    FormBox[
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["gSXX", "3"], " ", "MDM", " ", 
          SuperscriptBox["smix", "3"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "-", 
             SuperscriptBox["smix", "2"]}], ")"}], 
           RowBox[{"3", "/", "2"}]], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", 
             SuperscriptBox["MH", "2"]}], "+", 
            SuperscriptBox["MSM", "2"]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"2", " ", 
              RowBox[{"(", 
               RowBox[{
                FormBox[
                 OverscriptBox[
                  FormBox["p1",
                   TraditionalForm], "_"],
                 TraditionalForm], 
                FormBox["\<\"\[CenterDot]\"\>",
                 TraditionalForm], 
                FormBox[
                 OverscriptBox[
                  FormBox["p2",
                   TraditionalForm], "_"],
                 TraditionalForm]}], ")"}]}]}], "+", 
            RowBox[{
             FormBox[
              OverscriptBox[
               FormBox["p1",
                TraditionalForm], "_"],
              TraditionalForm], 
             FormBox["\<\"\[CenterDot]\"\>",
              TraditionalForm], 
             FormBox[
              OverscriptBox[
               FormBox["p4",
                TraditionalForm], "_"],
              TraditionalForm]}], "-", 
            RowBox[{
             FormBox[
              OverscriptBox[
               FormBox["p2",
                TraditionalForm], "_"],
              TraditionalForm], 
             FormBox["\<\"\[CenterDot]\"\>",
              TraditionalForm], 
             FormBox[
              OverscriptBox[
               FormBox["p4",
                TraditionalForm], "_"],
              TraditionalForm]}], "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["MDM", "2"]}]}], ")"}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"vev", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"2", " ", 
              RowBox[{"(", 
               RowBox[{
                FormBox[
                 OverscriptBox[
                  FormBox["p3",
                   TraditionalForm], "_"],
                 TraditionalForm], 
                FormBox["\<\"\[CenterDot]\"\>",
                 TraditionalForm], 
                FormBox[
                 OverscriptBox[
                  FormBox["p4",
                   TraditionalForm], "_"],
                 TraditionalForm]}], ")"}]}]}], "-", 
            RowBox[{"2", " ", 
             SuperscriptBox["MH", "2"]}], "+", 
            RowBox[{"MSM", " ", 
             RowBox[{"(", 
              RowBox[{"MSM", "-", 
               RowBox[{"\[ImaginaryI]", " ", "\[CapitalGamma]SM"}]}], 
              ")"}]}]}], ")"}], " ", 
          RowBox[{"(", 
           InterpretationBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{
               FormBox["\<\"(\"\>",
                TraditionalForm], 
               FormBox[
                FormBox[
                 RowBox[{
                  OverscriptBox[
                   FormBox["p2",
                    TraditionalForm], "_"], "-", 
                  OverscriptBox[
                   FormBox["p4",
                    TraditionalForm], "_"]}],
                 TraditionalForm],
                TraditionalForm], 
               FormBox["\<\")\"\>",
                TraditionalForm]}], "2"], "\[InvisibleSpace]", "\<\"-\"\>", 
             "\[InvisibleSpace]", 
             SuperscriptBox["MDM", "2"]}],
            SequenceForm[
             FeynCalc`Pair[
              FeynCalc`Momentum[$CellContext`p2 - $CellContext`p4], 
              FeynCalc`Momentum[$CellContext`p2 - $CellContext`p4]], 
             "-", $CellContext`MDM^2],
            Editable->False], ")"}]}], ")"}]}], ")"}]}],
     TraditionalForm], ",", 
    FormBox[
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["gSXX", "3"], " ", "MDM", " ", 
          SuperscriptBox["smix", "3"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "-", 
             SuperscriptBox["smix", "2"]}], ")"}], 
           RowBox[{"3", "/", "2"}]], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", 
             SuperscriptBox["MH", "2"]}], "+", 
            SuperscriptBox["MSM", "2"]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"2", " ", 
              RowBox[{"(", 
               RowBox[{
                FormBox[
                 OverscriptBox[
                  FormBox["p1",
                   TraditionalForm], "_"],
                 TraditionalForm], 
                FormBox["\<\"\[CenterDot]\"\>",
                 TraditionalForm], 
                FormBox[
                 OverscriptBox[
                  FormBox["p2",
                   TraditionalForm], "_"],
                 TraditionalForm]}], ")"}]}]}], "+", 
            RowBox[{
             FormBox[
              OverscriptBox[
               FormBox["p1",
                TraditionalForm], "_"],
              TraditionalForm], 
             FormBox["\<\"\[CenterDot]\"\>",
              TraditionalForm], 
             FormBox[
              OverscriptBox[
               FormBox["p3",
                TraditionalForm], "_"],
              TraditionalForm]}], "-", 
            RowBox[{
             FormBox[
              OverscriptBox[
               FormBox["p2",
                TraditionalForm], "_"],
              TraditionalForm], 
             FormBox["\<\"\[CenterDot]\"\>",
              TraditionalForm], 
             FormBox[
              OverscriptBox[
               FormBox["p3",
                TraditionalForm], "_"],
              TraditionalForm]}], "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["MDM", "2"]}]}], ")"}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"vev", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             RowBox[{"2", " ", 
              RowBox[{"(", 
               RowBox[{
                FormBox[
                 OverscriptBox[
                  FormBox["p3",
                   TraditionalForm], "_"],
                 TraditionalForm], 
                FormBox["\<\"\[CenterDot]\"\>",
                 TraditionalForm], 
                FormBox[
                 OverscriptBox[
                  FormBox["p4",
                   TraditionalForm], "_"],
                 TraditionalForm]}], ")"}]}]}], "-", 
            RowBox[{"2", " ", 
             SuperscriptBox["MH", "2"]}], "+", 
            RowBox[{"MSM", " ", 
             RowBox[{"(", 
              RowBox[{"MSM", "-", 
               RowBox[{"\[ImaginaryI]", " ", "\[CapitalGamma]SM"}]}], 
              ")"}]}]}], ")"}], " ", 
          RowBox[{"(", 
           InterpretationBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{
               FormBox["\<\"(\"\>",
                TraditionalForm], 
               FormBox[
                FormBox[
                 RowBox[{
                  OverscriptBox[
                   FormBox["p2",
                    TraditionalForm], "_"], "-", 
                  OverscriptBox[
                   FormBox["p3",
                    TraditionalForm], "_"]}],
                 TraditionalForm],
                TraditionalForm], 
               FormBox["\<\")\"\>",
                TraditionalForm]}], "2"], "\[InvisibleSpace]", "\<\"-\"\>", 
             "\[InvisibleSpace]", 
             SuperscriptBox["MDM", "2"]}],
            SequenceForm[
             FeynCalc`Pair[
              FeynCalc`Momentum[$CellContext`p2 - $CellContext`p3], 
              FeynCalc`Momentum[$CellContext`p2 - $CellContext`p3]], 
             "-", $CellContext`MDM^2],
            Editable->False], ")"}]}], ")"}]}], ")"}]}],
     TraditionalForm], ",", 
    FormBox[
     FormBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         SuperscriptBox["gSXX", "4"], " ", 
         SuperscriptBox["smix", "4"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              FormBox[
               OverscriptBox[
                FormBox["p1",
                 TraditionalForm], "_"],
               TraditionalForm], 
              FormBox["\<\"\[CenterDot]\"\>",
               TraditionalForm], 
              FormBox[
               OverscriptBox[
                FormBox["p3",
                 TraditionalForm], "_"],
               TraditionalForm]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               FormBox[
                OverscriptBox[
                 FormBox["p2",
                  TraditionalForm], "_"],
                TraditionalForm], 
               FormBox["\<\"\[CenterDot]\"\>",
                TraditionalForm], 
               FormBox[
                OverscriptBox[
                 FormBox["p4",
                  TraditionalForm], "_"],
                TraditionalForm]}], "-", 
              RowBox[{"2", " ", 
               SuperscriptBox["MDM", "2"]}]}], ")"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              FormBox[
               OverscriptBox[
                FormBox["p1",
                 TraditionalForm], "_"],
               TraditionalForm], 
              FormBox["\<\"\[CenterDot]\"\>",
               TraditionalForm], 
              FormBox[
               OverscriptBox[
                FormBox["p2",
                 TraditionalForm], "_"],
               TraditionalForm]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"4", " ", 
               SuperscriptBox["MDM", "2"]}], "-", 
              RowBox[{
               FormBox[
                OverscriptBox[
                 FormBox["p3",
                  TraditionalForm], "_"],
                TraditionalForm], 
               FormBox["\<\"\[CenterDot]\"\>",
                TraditionalForm], 
               FormBox[
                OverscriptBox[
                 FormBox["p4",
                  TraditionalForm], "_"],
                TraditionalForm]}]}], ")"}]}], "-", 
           RowBox[{"2", " ", 
            SuperscriptBox["MDM", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              FormBox[
               OverscriptBox[
                FormBox["p1",
                 TraditionalForm], "_"],
               TraditionalForm], 
              FormBox["\<\"\[CenterDot]\"\>",
               TraditionalForm], 
              FormBox[
               OverscriptBox[
                FormBox["p4",
                 TraditionalForm], "_"],
               TraditionalForm]}], ")"}]}], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["MDM", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              FormBox[
               OverscriptBox[
                FormBox["p2",
                 TraditionalForm], "_"],
               TraditionalForm], 
              FormBox["\<\"\[CenterDot]\"\>",
               TraditionalForm], 
              FormBox[
               OverscriptBox[
                FormBox["p3",
                 TraditionalForm], "_"],
               TraditionalForm]}], ")"}]}], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["MDM", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              FormBox[
               OverscriptBox[
                FormBox["p2",
                 TraditionalForm], "_"],
               TraditionalForm], 
              FormBox["\<\"\[CenterDot]\"\>",
               TraditionalForm], 
              FormBox[
               OverscriptBox[
                FormBox["p4",
                 TraditionalForm], "_"],
               TraditionalForm]}], ")"}]}], "-", 
           RowBox[{
            SuperscriptBox["MDM", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              FormBox[
               OverscriptBox[
                FormBox["p3",
                 TraditionalForm], "_"],
               TraditionalForm], 
              FormBox["\<\"\[CenterDot]\"\>",
               TraditionalForm], 
              FormBox[
               OverscriptBox[
                FormBox["p4",
                 TraditionalForm], "_"],
               TraditionalForm]}], ")"}]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              FormBox[
               OverscriptBox[
                FormBox["p1",
                 TraditionalForm], "_"],
               TraditionalForm], 
              FormBox["\<\"\[CenterDot]\"\>",
               TraditionalForm], 
              FormBox[
               OverscriptBox[
                FormBox["p4",
                 TraditionalForm], "_"],
               TraditionalForm]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              FormBox[
               OverscriptBox[
                FormBox["p2",
                 TraditionalForm], "_"],
               TraditionalForm], 
              FormBox["\<\"\[CenterDot]\"\>",
               TraditionalForm], 
              FormBox[
               OverscriptBox[
                FormBox["p3",
                 TraditionalForm], "_"],
               TraditionalForm]}], ")"}]}], "-", 
           RowBox[{"4", " ", 
            SuperscriptBox["MDM", "4"]}]}], ")"}]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          InterpretationBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{
              FormBox["\<\"(\"\>",
               TraditionalForm], 
              FormBox[
               FormBox[
                RowBox[{
                 OverscriptBox[
                  FormBox["p2",
                   TraditionalForm], "_"], "-", 
                 OverscriptBox[
                  FormBox["p3",
                   TraditionalForm], "_"]}],
                TraditionalForm],
               TraditionalForm], 
              FormBox["\<\")\"\>",
               TraditionalForm]}], "2"], "\[InvisibleSpace]", "\<\"-\"\>", 
            "\[InvisibleSpace]", 
            SuperscriptBox["MDM", "2"]}],
           SequenceForm[
            FeynCalc`Pair[
             FeynCalc`Momentum[$CellContext`p2 - $CellContext`p3], 
             FeynCalc`Momentum[$CellContext`p2 - $CellContext`p3]], 
            "-", $CellContext`MDM^2],
           Editable->False], ")"}], " ", 
         RowBox[{"(", 
          InterpretationBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{
              FormBox["\<\"(\"\>",
               TraditionalForm], 
              FormBox[
               FormBox[
                RowBox[{
                 OverscriptBox[
                  FormBox["p2",
                   TraditionalForm], "_"], "-", 
                 OverscriptBox[
                  FormBox["p4",
                   TraditionalForm], "_"]}],
                TraditionalForm],
               TraditionalForm], 
              FormBox["\<\")\"\>",
               TraditionalForm]}], "2"], "\[InvisibleSpace]", "\<\"-\"\>", 
            "\[InvisibleSpace]", 
            SuperscriptBox["MDM", "2"]}],
           SequenceForm[
            FeynCalc`Pair[
             FeynCalc`Momentum[$CellContext`p2 - $CellContext`p4], 
             FeynCalc`Momentum[$CellContext`p2 - $CellContext`p4]], 
            "-", $CellContext`MDM^2],
           Editable->False], ")"}]}], ")"}]}],
      TraditionalForm],
     TraditionalForm]}], "}"}], TraditionalForm]], "Output",
 CellChangeTimes->{3.792693386154961*^9},
 CellLabel->
  "Out[310]=",ExpressionUUID->"f4e217f2-99d7-47de-aeed-a821dfd84d72"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ComputeAmplitude", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"DM", ",", 
     RowBox[{"-", "DM"}]}], "}"}], "\[Rule]", 
   RowBox[{"{", 
    RowBox[{"Higgs", ",", "Higgs"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.792692543572836*^9, 3.792692551369611*^9}},
 CellLabel->
  "In[288]:=",ExpressionUUID->"2c63d42f-7914-4c60-84d2-8ebe1f82b36f"],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{
    FormBox[
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"3", " ", "gSXX", " ", "smix", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "-", 
             SuperscriptBox["smix", "2"]}], ")"}], 
           RowBox[{"3", "/", "2"}]], " ", 
          SuperscriptBox[
           RowBox[{"FCGV", "(", "\<\"MH\"\>", ")"}], "2"], " ", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             FormBox["\<\"\[CurlyPhi]\"\>",
              TraditionalForm], 
             FormBox["\<\"(\"\>",
              TraditionalForm], 
             FormBox[
              RowBox[{"-", 
               OverscriptBox[
                FormBox["InMom2",
                 TraditionalForm], "_"]}],
              TraditionalForm], 
             FormBox["\<\",\"\>",
              TraditionalForm], 
             FormBox["MDM",
              TraditionalForm], 
             FormBox["\<\")\"\>",
              TraditionalForm]}], ")"}], ".", 
           RowBox[{"(", 
            RowBox[{
             FormBox["\<\"\[CurlyPhi]\"\>",
              TraditionalForm], 
             FormBox["\<\"(\"\>",
              TraditionalForm], 
             FormBox[
              OverscriptBox[
               FormBox["InMom1",
                TraditionalForm], "_"],
              TraditionalForm], 
             FormBox["\<\",\"\>",
              TraditionalForm], 
             FormBox["MDM",
              TraditionalForm], 
             FormBox["\<\")\"\>",
              TraditionalForm]}], ")"}]}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"vev", " ", 
          RowBox[{"(", 
           InterpretationBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{
               FormBox["\<\"(\"\>",
                TraditionalForm], 
               FormBox[
                FormBox[
                 RowBox[{
                  OverscriptBox[
                   FormBox["OutMom1",
                    TraditionalForm], "_"], "+", 
                  OverscriptBox[
                   FormBox["OutMom2",
                    TraditionalForm], "_"]}],
                 TraditionalForm],
                TraditionalForm], 
               FormBox["\<\")\"\>",
                TraditionalForm]}], "2"], "\[InvisibleSpace]", "\<\"-\"\>", 
             "\[InvisibleSpace]", 
             SuperscriptBox[
              RowBox[{"FCGV", "(", "\<\"MH\"\>", ")"}], "2"]}],
            SequenceForm[
             FeynCalc`Pair[
              FeynCalc`Momentum[$CellContext`OutMom1 + $CellContext`OutMom2], 
              
              FeynCalc`Momentum[$CellContext`OutMom1 + $CellContext`OutMom2]],
              "-", FeynCalc`FCGV["MH"]^2],
            Editable->False], ")"}]}], ")"}]}], ")"}]}],
     TraditionalForm], ",", 
    RowBox[{
     FractionBox["1", "vev"], 
     RowBox[{"gSXX", " ", "smix", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SuperscriptBox["smix", "2"]}], ")"}], 
       RowBox[{"3", "/", "2"}]], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", 
         SuperscriptBox[
          RowBox[{"FCGV", "(", "\<\"MH\"\>", ")"}], "2"]}], "+", 
        SuperscriptBox["MSM", "2"]}], ")"}], " ", 
      RowBox[{"Den", "(", 
       RowBox[{
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           FormBox[
            OverscriptBox[
             FormBox["OutMom1",
              TraditionalForm], "_"],
            TraditionalForm], 
           FormBox["\<\"\[CenterDot]\"\>",
            TraditionalForm], 
           FormBox[
            OverscriptBox[
             FormBox["OutMom2",
              TraditionalForm], "_"],
            TraditionalForm]}], ")"}]}], "+", 
        SuperscriptBox[
         FormBox[
          OverscriptBox[
           FormBox["OutMom1",
            TraditionalForm], "_"],
          TraditionalForm], "2"], "+", 
        SuperscriptBox[
         FormBox[
          OverscriptBox[
           FormBox["OutMom2",
            TraditionalForm], "_"],
          TraditionalForm], "2"], "-", 
        SuperscriptBox["MSM", "2"], "+", 
        RowBox[{"\[ImaginaryI]", " ", "\[CapitalGamma]SM", " ", "MSM"}]}], 
       ")"}], " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         FormBox["\<\"\[CurlyPhi]\"\>",
          TraditionalForm], 
         FormBox["\<\"(\"\>",
          TraditionalForm], 
         FormBox[
          RowBox[{"-", 
           OverscriptBox[
            FormBox["InMom2",
             TraditionalForm], "_"]}],
          TraditionalForm], 
         FormBox["\<\",\"\>",
          TraditionalForm], 
         FormBox["MDM",
          TraditionalForm], 
         FormBox["\<\")\"\>",
          TraditionalForm]}], ")"}], ".", 
       RowBox[{"(", 
        RowBox[{
         FormBox["\<\"\[CurlyPhi]\"\>",
          TraditionalForm], 
         FormBox["\<\"(\"\>",
          TraditionalForm], 
         FormBox[
          OverscriptBox[
           FormBox["InMom1",
            TraditionalForm], "_"],
          TraditionalForm], 
         FormBox["\<\",\"\>",
          TraditionalForm], 
         FormBox["MDM",
          TraditionalForm], 
         FormBox["\<\")\"\>",
          TraditionalForm]}], ")"}]}]}]}], ",", 
    FormBox[
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["gSXX", "2"], " ", 
          SuperscriptBox["smix", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               FormBox["\<\"\[CurlyPhi]\"\>",
                TraditionalForm], 
               FormBox["\<\"(\"\>",
                TraditionalForm], 
               FormBox[
                RowBox[{"-", 
                 OverscriptBox[
                  FormBox["InMom2",
                   TraditionalForm], "_"]}],
                TraditionalForm], 
               FormBox["\<\",\"\>",
                TraditionalForm], 
               FormBox["MDM",
                TraditionalForm], 
               FormBox["\<\")\"\>",
                TraditionalForm]}], ")"}], ".", 
             RowBox[{"(", 
              RowBox[{
               OverscriptBox["\[Gamma]", "_"], "\[CenterDot]", 
               FormBox[
                OverscriptBox[
                 FormBox["OutMom2",
                  TraditionalForm], "_"],
                TraditionalForm]}], ")"}], ".", 
             RowBox[{"(", 
              RowBox[{
               FormBox["\<\"\[CurlyPhi]\"\>",
                TraditionalForm], 
               FormBox["\<\"(\"\>",
                TraditionalForm], 
               FormBox[
                OverscriptBox[
                 FormBox["InMom1",
                  TraditionalForm], "_"],
                TraditionalForm], 
               FormBox["\<\",\"\>",
                TraditionalForm], 
               FormBox["MDM",
                TraditionalForm], 
               FormBox["\<\")\"\>",
                TraditionalForm]}], ")"}]}], "+", 
            RowBox[{"2", " ", "MDM", " ", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                FormBox["\<\"\[CurlyPhi]\"\>",
                 TraditionalForm], 
                FormBox["\<\"(\"\>",
                 TraditionalForm], 
                FormBox[
                 RowBox[{"-", 
                  OverscriptBox[
                   FormBox["InMom2",
                    TraditionalForm], "_"]}],
                 TraditionalForm], 
                FormBox["\<\",\"\>",
                 TraditionalForm], 
                FormBox["MDM",
                 TraditionalForm], 
                FormBox["\<\")\"\>",
                 TraditionalForm]}], ")"}], ".", 
              RowBox[{"(", 
               RowBox[{
                FormBox["\<\"\[CurlyPhi]\"\>",
                 TraditionalForm], 
                FormBox["\<\"(\"\>",
                 TraditionalForm], 
                FormBox[
                 OverscriptBox[
                  FormBox["InMom1",
                   TraditionalForm], "_"],
                 TraditionalForm], 
                FormBox["\<\",\"\>",
                 TraditionalForm], 
                FormBox["MDM",
                 TraditionalForm], 
                FormBox["\<\")\"\>",
                 TraditionalForm]}], ")"}]}]}]}], ")"}]}], ")"}], "/", 
        RowBox[{"(", 
         InterpretationBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{
             FormBox["\<\"(\"\>",
              TraditionalForm], 
             FormBox[
              FormBox[
               RowBox[{
                OverscriptBox[
                 FormBox["InMom2",
                  TraditionalForm], "_"], "-", 
                OverscriptBox[
                 FormBox["OutMom2",
                  TraditionalForm], "_"]}],
               TraditionalForm],
              TraditionalForm], 
             FormBox["\<\")\"\>",
              TraditionalForm]}], "2"], "\[InvisibleSpace]", "\<\"-\"\>", 
           "\[InvisibleSpace]", 
           SuperscriptBox["MDM", "2"]}],
          SequenceForm[
           FeynCalc`Pair[
            FeynCalc`Momentum[$CellContext`InMom2 - $CellContext`OutMom2], 
            FeynCalc`Momentum[$CellContext`InMom2 - $CellContext`OutMom2]], 
           "-", $CellContext`MDM^2],
          Editable->False], ")"}]}], ")"}]}],
     TraditionalForm], ",", 
    FormBox[
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox["gSXX", "2"], " ", 
          SuperscriptBox["smix", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               FormBox["\<\"\[CurlyPhi]\"\>",
                TraditionalForm], 
               FormBox["\<\"(\"\>",
                TraditionalForm], 
               FormBox[
                RowBox[{"-", 
                 OverscriptBox[
                  FormBox["InMom2",
                   TraditionalForm], "_"]}],
                TraditionalForm], 
               FormBox["\<\",\"\>",
                TraditionalForm], 
               FormBox["MDM",
                TraditionalForm], 
               FormBox["\<\")\"\>",
                TraditionalForm]}], ")"}], ".", 
             RowBox[{"(", 
              RowBox[{
               OverscriptBox["\[Gamma]", "_"], "\[CenterDot]", 
               FormBox[
                OverscriptBox[
                 FormBox["OutMom1",
                  TraditionalForm], "_"],
                TraditionalForm]}], ")"}], ".", 
             RowBox[{"(", 
              RowBox[{
               FormBox["\<\"\[CurlyPhi]\"\>",
                TraditionalForm], 
               FormBox["\<\"(\"\>",
                TraditionalForm], 
               FormBox[
                OverscriptBox[
                 FormBox["InMom1",
                  TraditionalForm], "_"],
                TraditionalForm], 
               FormBox["\<\",\"\>",
                TraditionalForm], 
               FormBox["MDM",
                TraditionalForm], 
               FormBox["\<\")\"\>",
                TraditionalForm]}], ")"}]}], "+", 
            RowBox[{"2", " ", "MDM", " ", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                FormBox["\<\"\[CurlyPhi]\"\>",
                 TraditionalForm], 
                FormBox["\<\"(\"\>",
                 TraditionalForm], 
                FormBox[
                 RowBox[{"-", 
                  OverscriptBox[
                   FormBox["InMom2",
                    TraditionalForm], "_"]}],
                 TraditionalForm], 
                FormBox["\<\",\"\>",
                 TraditionalForm], 
                FormBox["MDM",
                 TraditionalForm], 
                FormBox["\<\")\"\>",
                 TraditionalForm]}], ")"}], ".", 
              RowBox[{"(", 
               RowBox[{
                FormBox["\<\"\[CurlyPhi]\"\>",
                 TraditionalForm], 
                FormBox["\<\"(\"\>",
                 TraditionalForm], 
                FormBox[
                 OverscriptBox[
                  FormBox["InMom1",
                   TraditionalForm], "_"],
                 TraditionalForm], 
                FormBox["\<\",\"\>",
                 TraditionalForm], 
                FormBox["MDM",
                 TraditionalForm], 
                FormBox["\<\")\"\>",
                 TraditionalForm]}], ")"}]}]}]}], ")"}]}], ")"}], "/", 
        RowBox[{"(", 
         InterpretationBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{
             FormBox["\<\"(\"\>",
              TraditionalForm], 
             FormBox[
              FormBox[
               RowBox[{
                OverscriptBox[
                 FormBox["InMom2",
                  TraditionalForm], "_"], "-", 
                OverscriptBox[
                 FormBox["OutMom1",
                  TraditionalForm], "_"]}],
               TraditionalForm],
              TraditionalForm], 
             FormBox["\<\")\"\>",
              TraditionalForm]}], "2"], "\[InvisibleSpace]", "\<\"-\"\>", 
           "\[InvisibleSpace]", 
           SuperscriptBox["MDM", "2"]}],
          SequenceForm[
           FeynCalc`Pair[
            FeynCalc`Momentum[$CellContext`InMom2 - $CellContext`OutMom1], 
            FeynCalc`Momentum[$CellContext`InMom2 - $CellContext`OutMom1]], 
           "-", $CellContext`MDM^2],
          Editable->False], ")"}]}], ")"}]}],
     TraditionalForm]}], "}"}], TraditionalForm]], "Output",
 CellChangeTimes->{3.792692551885138*^9},
 CellLabel->
  "Out[288]=",ExpressionUUID->"7f37e799-3537-4e36-9bae-47bb9c58d11b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"BesselK", "[", 
      RowBox[{"0", ",", "x"}], "]"}], "+", 
     RowBox[{
      FractionBox["2", "x"], 
      RowBox[{"BesselK", "[", 
       RowBox[{"1", ",", "x"}], "]"}]}]}], ")"}], "-", 
   RowBox[{"BesselK", "[", 
    RowBox[{"2", ",", "x"}], "]"}]}], "//", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.792699872872974*^9, 3.792699897283485*^9}},
 CellLabel->
  "In[402]:=",ExpressionUUID->"618422da-4c4f-44d7-905d-542f9fdc1567"],

Cell[BoxData[
 FormBox["0", TraditionalForm]], "Output",
 CellChangeTimes->{{3.792699891860924*^9, 3.792699897704979*^9}},
 CellLabel->
  "Out[402]=",ExpressionUUID->"25ffbd4f-b8c7-48fe-942b-1644b9f9ec42"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"expr", "=", 
  RowBox[{
   FractionBox[
    RowBox[{"2", 
     SuperscriptBox["\[Pi]", "2"], "T"}], 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"4", "\[Pi]", " ", 
       SuperscriptBox["m", "2"], "T", " ", 
       RowBox[{"BesselK", "[", 
        RowBox[{"2", ",", 
         RowBox[{"m", "/", "T"}]}], "]"}]}], ")"}], "2"]], "ds", " ", 
   RowBox[{"\[Sigma]", "[", 
    SqrtBox["s"], "]"}], 
   RowBox[{"(", 
    RowBox[{"s", "-", 
     RowBox[{"4", 
      SuperscriptBox["m", "2"]}]}], ")"}], 
   SqrtBox["s"], 
   RowBox[{"BesselK", "[", 
    RowBox[{"1", ",", 
     RowBox[{
      SqrtBox["s"], "/", "T"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.792700030371361*^9, 3.792700083280931*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"c6e9636a-0e0c-4d66-b56b-0dd6938e85d8"],

Cell[BoxData[
 FormBox[
  FractionBox[
   RowBox[{"ds", " ", 
    SqrtBox["s"], " ", 
    RowBox[{"(", 
     RowBox[{"s", "-", 
      RowBox[{"4", " ", 
       SuperscriptBox["m", "2"]}]}], ")"}], " ", 
    RowBox[{"\[Sigma]", "(", 
     SqrtBox["s"], ")"}], " ", 
    TemplateBox[{"1",FractionBox[
       SqrtBox["s"], "T"]},
     "BesselK"]}], 
   RowBox[{"8", " ", 
    SuperscriptBox["m", "4"], " ", "T", " ", 
    SuperscriptBox[
     TemplateBox[{"2",FractionBox["m", "T"]},
      "BesselK"], "2"]}]], TraditionalForm]], "Output",
 CellChangeTimes->{3.7927000836947002`*^9, 3.792715009311117*^9},
 CellLabel->"Out[1]=",ExpressionUUID->"d9927c01-4b3b-4612-8205-d490625d4d1a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"expr", "/.", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"s", "\[Rule]", 
          RowBox[{
           SuperscriptBox["z", "2"], 
           SuperscriptBox["m", "2"]}]}], ",", 
         RowBox[{"ds", "\[Rule]", 
          RowBox[{"2", 
           SuperscriptBox["m", "2"], "z", " ", "dz"}]}]}], "}"}]}], ")"}], "/.", 
     RowBox[{"{", 
      RowBox[{"T", "\[Rule]", 
       RowBox[{"m", "/", "x"}]}], "}"}]}], ")"}], "/.", 
   RowBox[{
    RowBox[{"BesselK", "[", 
     RowBox[{"a_", ",", "b_"}], "]"}], "\[RuleDelayed]", 
    RowBox[{
     RowBox[{"Kbar", "[", 
      RowBox[{"a", ",", "b"}], "]"}], 
     RowBox[{"Exp", "[", 
      RowBox[{"-", "b"}], "]"}]}]}]}], "//", 
  RowBox[{
   RowBox[{"Simplify", "[", 
    RowBox[{"#", ",", 
     RowBox[{"Assumptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"m", ">", "0"}], ",", 
        RowBox[{"z", ">", "0"}], ",", 
        RowBox[{"x", ">", "0"}]}], "}"}]}]}], "]"}], "&"}]}]], "Input",
 CellChangeTimes->{{3.792700084334642*^9, 3.7927001428522263`*^9}, {
  3.792700179136952*^9, 3.792700209219181*^9}, {3.792700410801927*^9, 
  3.792700437189678*^9}},
 CellLabel->
  "In[413]:=",ExpressionUUID->"da9c221e-3cca-4e01-bda0-86674cbeabf7"],

Cell[BoxData[
 FormBox[
  FractionBox[
   RowBox[{"dz", " ", "x", " ", 
    SuperscriptBox["z", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["z", "2"], "-", "4"}], ")"}], " ", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{
      RowBox[{"-", "x"}], " ", 
      RowBox[{"(", 
       RowBox[{"z", "-", "2"}], ")"}]}]], " ", 
    RowBox[{"\[Sigma]", "(", 
     RowBox[{"m", " ", "z"}], ")"}], " ", 
    RowBox[{"Kbar", "(", 
     RowBox[{"1", ",", 
      RowBox[{"x", " ", "z"}]}], ")"}]}], 
   RowBox[{"4", " ", 
    SuperscriptBox[
     RowBox[{"Kbar", "(", 
      RowBox[{"2", ",", "x"}], ")"}], "2"]}]], TraditionalForm]], "Output",
 CellChangeTimes->{
  3.792700093983039*^9, {3.792700126173644*^9, 3.79270014334025*^9}, {
   3.79270018815158*^9, 3.792700210419468*^9}, 3.79270046356223*^9},
 CellLabel->
  "Out[413]=",ExpressionUUID->"c29f4d0e-e3ee-4745-8e8b-21cfa1348747"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Series", "[", 
  RowBox[{
   RowBox[{"BesselK", "[", 
    RowBox[{"z", ",", "x"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"x", ",", "Infinity", ",", "2"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.7927004407203007`*^9, 3.792700459442198*^9}},
 CellLabel->
  "In[412]:=",ExpressionUUID->"45c11ab2-1c20-4c6e-a4fb-34f446011ab7"],

Cell[BoxData[
 FormBox[
  RowBox[{
   SuperscriptBox["\[ExponentialE]", 
    InterpretationBox[
     RowBox[{
      RowBox[{"-", "x"}], "+", 
      InterpretationBox[
       RowBox[{"O", "(", 
        SuperscriptBox[
         RowBox[{"(", 
          FractionBox["1", "x"], ")"}], "3"], ")"}],
       SeriesData[$CellContext`x, 
        DirectedInfinity[1], {}, -1, 3, 1],
       Editable->False]}],
     SeriesData[$CellContext`x, 
      DirectedInfinity[1], {-1}, -1, 3, 1],
     Editable->False]], " ", 
   RowBox[{"(", 
    InterpretationBox[
     RowBox[{
      RowBox[{
       SqrtBox[
        FractionBox["\[Pi]", "2"]], " ", 
       SqrtBox[
        FractionBox["1", "x"]]}], "+", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       SqrtBox[
        FractionBox["\[Pi]", "2"]], " ", 
       RowBox[{"(", 
        RowBox[{"z", "-", 
         FractionBox["1", "2"]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"z", "+", 
         FractionBox["1", "2"]}], ")"}], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         FractionBox["1", "x"], ")"}], 
        RowBox[{"3", "/", "2"}]]}], "+", 
      InterpretationBox[
       RowBox[{"O", "(", 
        SuperscriptBox[
         RowBox[{"(", 
          FractionBox["1", "x"], ")"}], 
         RowBox[{"5", "/", "2"}]], ")"}],
       SeriesData[$CellContext`x, 
        DirectedInfinity[1], {}, 1, 5, 2],
       Editable->False]}],
     SeriesData[$CellContext`x, 
      DirectedInfinity[
      1], {(Rational[1, 2] Pi)^Rational[1, 2], 0, 
       Rational[1, 2] (Rational[1, 2] Pi)^Rational[1, 2] (
        Rational[-1, 2] + $CellContext`z) (Rational[1, 2] + $CellContext`z)}, 
      1, 5, 2],
     Editable->False], ")"}]}], TraditionalForm]], "Output",
 CellChangeTimes->{{3.792700451094543*^9, 3.79270045984627*^9}},
 CellLabel->
  "Out[412]=",ExpressionUUID->"ed88ad7f-c93d-4b1a-850f-0d34d23f2fc4"]
}, Open  ]]
}, Closed]]
}, Open  ]]
},
WindowSize->{1792, 998},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
Magnification:>1.5 Inherited,
FrontEndVersion->"12.0 for Mac OS X x86 (64-bit) (April 8, 2019)",
StyleDefinitions->FrontEnd`FileName[{"Report"}, "StandardReport.nb", 
  CharacterEncoding -> "UTF-8"]
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 224, 3, 63, "Input",ExpressionUUID->"42e4ba0b-1819-4c9c-83a8-dddd2a2955bf"],
Cell[CellGroupData[{
Cell[807, 27, 382, 10, 144, "Title",ExpressionUUID->"c92b7a39-599a-4a7c-acdb-d8b41fd2c845"],
Cell[CellGroupData[{
Cell[1214, 41, 207, 4, 104, "Section",ExpressionUUID->"73d91e81-e7e1-4fc6-a8cf-b673abb31180"],
Cell[CellGroupData[{
Cell[1446, 49, 213, 4, 51, "Subsection",ExpressionUUID->"2483c665-b412-4efa-8e46-eeaf53b2ba00"],
Cell[CellGroupData[{
Cell[1684, 57, 597, 14, 157, "Input",ExpressionUUID->"86657822-18c8-44a0-97a9-e0b6947a2385"],
Cell[CellGroupData[{
Cell[2306, 75, 2530, 68, 44, "Print",ExpressionUUID->"10ee9f5b-7d69-4eeb-864d-3d1607b43f9a"],
Cell[4839, 145, 1276, 31, 44, "Print",ExpressionUUID->"b7ce3597-11ff-4425-869d-42a2970f152c"],
Cell[6118, 178, 1282, 34, 44, "Print",ExpressionUUID->"a2d80220-6749-4f8c-968c-c832024ad6d8"],
Cell[7403, 214, 433, 9, 42, "Print",ExpressionUUID->"54457f41-e89b-49dc-a31f-9ce9741eb437"],
Cell[7839, 225, 437, 9, 42, "Print",ExpressionUUID->"2563ff40-4eeb-4079-bc10-0656a8561d57"],
Cell[8279, 236, 422, 9, 42, "Print",ExpressionUUID->"e46ae6be-e545-46ba-b6c9-85d62a74b52e"],
Cell[8704, 247, 1383, 38, 44, "Print",ExpressionUUID->"db0d56a3-2100-4d13-b38b-ad9ff55e456a"],
Cell[10090, 287, 1306, 34, 44, "Print",ExpressionUUID->"781667f2-cd2e-447d-8b82-f3d4cde31266"],
Cell[11399, 323, 474, 10, 42, "Print",ExpressionUUID->"3fa79829-acbf-4f97-8429-66cccc23f6ef"],
Cell[11876, 335, 427, 9, 42, "Print",ExpressionUUID->"a8d7c128-c15f-4415-b7ed-d0669dc7fd65"],
Cell[12306, 346, 1137, 31, 44, "Print",ExpressionUUID->"5ac60e9b-bb3d-47e5-b21b-37326e609ba8"],
Cell[13446, 379, 1154, 31, 44, "Print",ExpressionUUID->"7f00dffe-0c5f-4383-894c-43aad57d6ef8"],
Cell[14603, 412, 2081, 58, 44, "Print",ExpressionUUID->"95f5ea30-4f14-4ce0-bcfe-4975887ade62"],
Cell[16687, 472, 371, 8, 42, "Print",ExpressionUUID->"a92ad80b-c672-4121-9309-0b2abf0efccf"],
Cell[17061, 482, 409, 9, 42, "Print",ExpressionUUID->"dc70cc38-3d84-4cff-9d29-9a8424bb3aeb"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[17531, 498, 206, 4, 49, "Subsection",ExpressionUUID->"9ae17e2a-f31e-4460-9dad-79c0fd5114d5"],
Cell[17740, 504, 526, 13, 95, "Input",ExpressionUUID->"894109e0-4414-4e15-9056-7622402ca770"]
}, Closed]],
Cell[CellGroupData[{
Cell[18303, 522, 178, 3, 49, "Subsection",ExpressionUUID->"004e0aee-d23a-41e2-a732-14e653885b6d"],
Cell[18484, 527, 2234, 60, 388, "Input",ExpressionUUID->"7c3c8027-f6c3-43e8-96b5-c750e3b3675e"]
}, Closed]],
Cell[CellGroupData[{
Cell[20755, 592, 228, 4, 49, "Subsection",ExpressionUUID->"e57f47f7-3121-47e2-a891-13515311ea23"],
Cell[20986, 598, 2964, 77, 664, "Input",ExpressionUUID->"020a2eac-da1c-4e59-aefe-827774b36f30"],
Cell[23953, 677, 3071, 79, 932, "Input",ExpressionUUID->"14fb62e1-2176-4306-a9f5-39c89a782700"]
}, Closed]],
Cell[CellGroupData[{
Cell[27061, 761, 175, 3, 49, "Subsection",ExpressionUUID->"f815779a-59b6-4d03-bb00-c5753d023a7e"],
Cell[27239, 766, 2284, 60, 640, "Input",ExpressionUUID->"eb26c15a-ab2c-431c-9fac-5f6e8b8ea7c7"]
}, Closed]],
Cell[CellGroupData[{
Cell[29560, 831, 169, 3, 49, "Subsection",ExpressionUUID->"38c336f3-e6e7-4de4-aacc-a1956ea49427"],
Cell[29732, 836, 2288, 51, 622, "Input",ExpressionUUID->"02d465e2-3565-49ca-a215-c56367deea2b"],
Cell[32023, 889, 3471, 78, 870, "Input",ExpressionUUID->"bbc4b536-3da9-4a55-8583-e8bdb07b9eff"]
}, Closed]],
Cell[CellGroupData[{
Cell[35531, 972, 167, 3, 49, "Subsection",ExpressionUUID->"36d8ac8b-75c5-497d-b996-8fae3cc9f7c6"],
Cell[35701, 977, 8018, 165, 2265, "Input",ExpressionUUID->"783d3b96-1e10-4f3c-9f0b-b0e8f8635243"]
}, Closed]],
Cell[CellGroupData[{
Cell[43756, 1147, 177, 3, 49, "Subsection",ExpressionUUID->"aa2616d4-8cff-4b88-a2b6-5dc0f0a6ad00"],
Cell[43936, 1152, 421, 8, 63, "Input",ExpressionUUID->"c4f84656-5018-47c6-bb57-04371901c4d2"],
Cell[44360, 1162, 18109, 420, 3877, "Input",ExpressionUUID->"c1602ffd-0935-4fcd-917a-288958b812ef"]
}, Closed]],
Cell[CellGroupData[{
Cell[62506, 1587, 167, 3, 49, "Subsection",ExpressionUUID->"2cf03f8e-78ee-4b27-92aa-6e1fc8d87fa0"],
Cell[62676, 1592, 535, 12, 126, "Input",ExpressionUUID->"36824016-5c92-4a1f-81ce-a9e1ce4f580e"],
Cell[63214, 1606, 12236, 282, 2350, "Input",ExpressionUUID->"d9dfd925-4898-4923-afa5-82e44ecc3b81"],
Cell[75453, 1890, 1808, 43, 261, "Input",ExpressionUUID->"44fc091c-7853-4374-bc25-e114baebaa7b"]
}, Closed]],
Cell[CellGroupData[{
Cell[77298, 1938, 156, 3, 49, "Subsection",ExpressionUUID->"ea7a6196-a87e-4041-a207-761fa94a2c0c"],
Cell[77457, 1943, 526, 12, 126, "Input",ExpressionUUID->"832d8b8a-ff7e-4c6f-9358-066dfba5e31a"],
Cell[77986, 1957, 6188, 151, 1247, "Input",ExpressionUUID->"97e68c27-0d9a-4c6f-9bfd-91befc47936c"]
}, Closed]],
Cell[CellGroupData[{
Cell[84211, 2113, 167, 3, 49, "Subsection",ExpressionUUID->"1fc64e9b-314d-4af4-971d-cf636371d9c8"],
Cell[84381, 2118, 1722, 42, 467, "Input",ExpressionUUID->"e06a410e-2882-40c0-92e9-7d4b9501b69b"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[86152, 2166, 205, 4, 81, "Section",ExpressionUUID->"1258ea4a-ffa0-415d-b090-bb39ceb96fc1"],
Cell[86360, 2172, 1166, 35, 157, "Input",ExpressionUUID->"99e28112-5c23-4a4a-b711-cd5fccffbe9c"],
Cell[87529, 2209, 291, 6, 95, "Input",ExpressionUUID->"6f157b0e-436d-44d1-ad5a-1d7eefcfae0e"],
Cell[CellGroupData[{
Cell[87845, 2219, 1913, 53, 222, "Input",ExpressionUUID->"04e9bbf6-083c-4bdd-a1ef-1463ce51c0b7"],
Cell[89761, 2274, 1053, 31, 98, "Output",ExpressionUUID->"767f8798-027f-4e5d-943d-46ae16111b2f"]
}, Open  ]],
Cell[90829, 2308, 2424, 78, 384, "Input",ExpressionUUID->"5fd23a3b-c9fe-44e7-908f-783120e6d00d"],
Cell[CellGroupData[{
Cell[93278, 2390, 637, 16, 63, "Input",ExpressionUUID->"17d1be74-4aa7-45b6-abe4-ad83ba86239b"],
Cell[93918, 2408, 4058, 126, 99, "Output",ExpressionUUID->"b632b787-f451-45f8-8ac1-0dbe8630673d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[98013, 2539, 573, 13, 63, "Input",ExpressionUUID->"d939965d-a821-481c-b0df-059df1cd11f7"],
Cell[98589, 2554, 1941, 54, 96, "Output",ExpressionUUID->"a0623dba-5572-4aab-aff2-ac27d48f29c9"]
}, Open  ]],
Cell[100545, 2611, 977, 33, 74, "DisplayFormula",ExpressionUUID->"ec2410f0-cec7-4a26-bc98-3f1b714f51db"],
Cell[101525, 2646, 1083, 35, 74, "DisplayFormula",ExpressionUUID->"2f18903f-2d18-4153-af17-66cab83105a7"],
Cell[102611, 2683, 1132, 34, 69, "DisplayFormula",ExpressionUUID->"5080b822-7ef9-4e5f-990c-4263d4dbf111"],
Cell[CellGroupData[{
Cell[103768, 2721, 624, 15, 66, "Input",ExpressionUUID->"2328cd10-20c6-440f-9307-308a555f0465"],
Cell[104395, 2738, 686, 19, 92, "Output",ExpressionUUID->"53067eff-b160-49b2-b7b0-d0199d77909e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[105118, 2762, 652, 16, 86, "Input",ExpressionUUID->"297a87c3-273a-4861-bcc5-d805d05d8d5f"],
Cell[105773, 2780, 1781, 50, 162, "Output",ExpressionUUID->"d31c9b58-26ea-4147-a73b-de445148d3db"]
}, Open  ]],
Cell[CellGroupData[{
Cell[107591, 2835, 903, 24, 126, "Input",ExpressionUUID->"ca2aff85-02af-4a15-a972-613c38d516ea"],
Cell[108497, 2861, 916, 25, 97, "Output",ExpressionUUID->"75c14b84-d148-42f5-93cc-9393f4a010d2"],
Cell[109416, 2888, 1090, 31, 130, "Output",ExpressionUUID->"b9de3020-f832-4f78-8af9-f981180fec9b"]
}, Open  ]],
Cell[110521, 2922, 1212, 35, 67, "DisplayFormula",ExpressionUUID->"3ab8624f-f852-43a2-aeeb-519de6057653"],
Cell[CellGroupData[{
Cell[111758, 2961, 592, 14, 86, "Input",ExpressionUUID->"0830570a-40e8-4c66-932e-262078c1aa15"],
Cell[112353, 2977, 3656, 100, 259, "Output",ExpressionUUID->"0ebb06eb-55ac-49cc-a27a-06e6c52ac62d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[116046, 3082, 591, 14, 95, "Input",ExpressionUUID->"6f6fbd75-287e-4711-bb36-84af3bad36a2"],
Cell[116640, 3098, 6720, 179, 348, "Output",ExpressionUUID->"48eec027-6109-4138-bf22-f278154b23c6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[123397, 3282, 770, 17, 63, "Input",ExpressionUUID->"21b952b6-12c9-4711-9519-00e1954a64d0"],
Cell[124170, 3301, 7466, 192, 389, "Output",ExpressionUUID->"ae3d83a6-ee37-42e3-ae2b-738484af6742"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[131685, 3499, 170, 3, 104, "Section",ExpressionUUID->"c7372da2-6df8-46e6-8f2a-c305ce088abd"],
Cell[131858, 3504, 8425, 193, 881, "Input",ExpressionUUID->"327e9c26-f619-4893-bfcc-924a9f5831e2"],
Cell[140286, 3699, 276, 5, 63, "Input",ExpressionUUID->"13416dbc-9fd0-4291-abd2-74771d814cdd"],
Cell[140565, 3706, 276, 5, 63, "Input",ExpressionUUID->"fcd82726-1e23-41e7-9520-97a32e764406"],
Cell[CellGroupData[{
Cell[140866, 3715, 1100, 30, 157, "Input",ExpressionUUID->"8bb6cac8-6aa2-4797-ae5f-55f6f2d97f7e"],
Cell[141969, 3747, 7460, 220, 323, "Output",ExpressionUUID->"562dcfc4-549f-4388-a476-f7f793bcbcc0"]
}, Open  ]],
Cell[149444, 3970, 717, 18, 63, "Input",ExpressionUUID->"5d166935-8b18-4128-915a-a93d0ac70225"],
Cell[150164, 3990, 1034, 30, 95, "Input",ExpressionUUID->"0d1eca7f-f949-4f4d-b9ca-c3debfefe643"],
Cell[151201, 4022, 609, 18, 63, "Input",ExpressionUUID->"a2050c04-273f-4cc9-866d-9a9f62e54db8"],
Cell[CellGroupData[{
Cell[151835, 4044, 179, 3, 63, "Input",ExpressionUUID->"c3c2781a-5f85-4781-a793-cdb399346eb4"],
Cell[152017, 4049, 26214, 763, 1929, "Output",ExpressionUUID->"dac14522-5624-4966-8164-fd31b5d04973"]
}, Open  ]],
Cell[CellGroupData[{
Cell[178268, 4817, 194, 4, 63, "Input",ExpressionUUID->"bce71492-8663-4745-807d-22598ba3dab7"],
Cell[178465, 4823, 4062, 61, 2534, "Output",ExpressionUUID->"9d02acee-35f5-4ab6-b828-187b410dfe4e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[182564, 4889, 210, 4, 63, "Input",ExpressionUUID->"456b5ed7-98fe-45eb-9bd8-814122e188ff"],
Cell[182777, 4895, 184, 4, 58, "Output",ExpressionUUID->"750eb887-22e0-46ed-b62f-1adfef1fc8d9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[182998, 4904, 830, 22, 136, "Input",ExpressionUUID->"68ae9de9-d84f-45ee-a6f2-7ab6a292939a"],
Cell[CellGroupData[{
Cell[183853, 4930, 280, 7, 30, "Print",ExpressionUUID->"e321e611-cd9d-47fb-a18f-0fce342fa1f0"],
Cell[184136, 4939, 280, 7, 30, "Print",ExpressionUUID->"ad0ddceb-5f95-440f-a9a3-8d54c217f831"],
Cell[184419, 4948, 280, 7, 30, "Print",ExpressionUUID->"520d73f6-c4d2-4323-bdf4-4fb3b84c3c50"]
}, Open  ]]
}, Open  ]],
Cell[184726, 4959, 927, 26, 167, "Input",ExpressionUUID->"815fa800-142a-4089-931a-6a671570502d"],
Cell[CellGroupData[{
Cell[185678, 4989, 180, 3, 63, "Input",ExpressionUUID->"93dc6621-270f-47d2-8b8f-acdf7e84efb3"],
Cell[185861, 4994, 310, 7, 58, "Output",ExpressionUUID->"2d7ef630-93b5-429b-a5b0-d7858839eacf"]
}, Open  ]],
Cell[CellGroupData[{
Cell[186208, 5006, 704, 19, 157, "Input",ExpressionUUID->"0db851ed-5111-402f-affe-4b34d3e37498"],
Cell[186915, 5027, 23932, 703, 1561, "Output",ExpressionUUID->"0a4fbfe9-2dfb-4d00-ba0a-918ece6a212d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[210884, 5735, 259, 5, 63, "Input",ExpressionUUID->"549f05dd-1a08-4421-ae46-8f467b015c13"],
Cell[211146, 5742, 3599, 51, 2009, "Output",ExpressionUUID->"b0bf59a9-8d09-4cc3-9f65-39c9ad098623"]
}, Open  ]],
Cell[CellGroupData[{
Cell[214782, 5798, 565, 14, 63, "Input",ExpressionUUID->"fe40ef58-1f26-4dd0-b516-8304b7fd0478"],
Cell[215350, 5814, 10323, 304, 701, "Output",ExpressionUUID->"31d3b649-a414-4e36-9afb-4af34ad6b657"]
}, Open  ]],
Cell[CellGroupData[{
Cell[225710, 6123, 1904, 48, 188, "Input",ExpressionUUID->"5eed94ec-366e-4925-89ef-a9b230804dae"],
Cell[227617, 6173, 23330, 660, 1409, "Output",ExpressionUUID->"dc725fd5-e4c7-4f7b-a163-50680a450ee0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[250984, 6838, 711, 19, 63, "Input",ExpressionUUID->"d00aef90-fa0e-4c13-bbbd-cbf20d72a2c8"],
Cell[251698, 6859, 39181, 1206, 547, "Output",ExpressionUUID->"f4e217f2-99d7-47de-aeed-a821dfd84d72"]
}, Open  ]],
Cell[CellGroupData[{
Cell[290916, 8070, 376, 10, 63, "Input",ExpressionUUID->"2c63d42f-7914-4c60-84d2-8ebe1f82b36f"],
Cell[291295, 8082, 13789, 410, 192, "Output",ExpressionUUID->"7f37e799-3537-4e36-9bae-47bb9c58d11b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[305121, 8497, 518, 15, 85, "Input",ExpressionUUID->"618422da-4c4f-44d7-905d-542f9fdc1567"],
Cell[305642, 8514, 205, 4, 58, "Output",ExpressionUUID->"25ffbd4f-b8c7-48fe-942b-1644b9f9ec42"]
}, Open  ]],
Cell[CellGroupData[{
Cell[305884, 8523, 811, 25, 101, "Input",ExpressionUUID->"c6e9636a-0e0c-4d66-b56b-0dd6938e85d8"],
Cell[306698, 8550, 680, 20, 111, "Output",ExpressionUUID->"d9927c01-4b3b-4612-8205-d490625d4d1a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[307415, 8575, 1324, 40, 66, "Input",ExpressionUUID->"da9c221e-3cca-4e01-bda0-86674cbeabf7"],
Cell[308742, 8617, 903, 26, 93, "Output",ExpressionUUID->"c29f4d0e-e3ee-4745-8e8b-21cfa1348747"]
}, Open  ]],
Cell[CellGroupData[{
Cell[309682, 8648, 359, 9, 63, "Input",ExpressionUUID->"45c11ab2-1c20-4c6e-a4fb-34f446011ab7"],
Cell[310044, 8659, 1871, 58, 98, "Output",ExpressionUUID->"ed88ad7f-c93d-4b1a-850f-0d34d23f2fc4"]
}, Open  ]]
}, Closed]]
}, Open  ]]
}
]
*)

